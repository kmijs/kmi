"use strict";var T=(t,e,s)=>new Promise((p,a)=>{var l=i=>{try{n(s.next(i))}catch(c){a(c)}},u=i=>{try{n(s.throw(i))}catch(c){a(c)}},n=i=>i.done?p(i.value):Promise.resolve(i.value).then(l,u);n((s=s.apply(t,e)).next())});const r=require("../code-inspector-core"),x=["isJsx","isTsx","lang.jsx","lang.tsx"];function m(t){return T(this,null,function*(){var f,y;this.cacheable&&this.cacheable(!0);let e=r.normalizePath(this.resourcePath),s=new URLSearchParams(this.resource);const p=this.query,{escapeTags:a=[],mappings:l}=p||{};if(e=r.getMappingFilePath(e,l),r.isJsTypeFile(e)||e.endsWith(".vue")&&x.some(o=>s.get(o)!==null))return r.transformCode({content:t,filePath:e,fileType:"jsx",escapeTags:a,pathType:p.pathType});if(e.endsWith(".vue")&&(s.get("lang")==="tsx"||s.get("lang")==="jsx")){const{descriptor:o}=r.parseSFC(t,{sourceMap:!1}),g=[(f=o.script)==null?void 0:f.content,(y=o.scriptSetup)==null?void 0:y.content];for(const h of g){if(!h)continue;const d=r.transformCode({content:h,filePath:e,fileType:"jsx",escapeTags:a,pathType:p.pathType});t=t.replace(h,d)}return t}return e.endsWith(".vue")&&s.get("type")!=="style"&&s.get("type")!=="script"&&s.get("raw")===null?r.transformCode({content:t,filePath:e,fileType:"vue",escapeTags:a,pathType:p.pathType}):e.endsWith(".svelte")?r.transformCode({content:t,filePath:e,fileType:"svelte",escapeTags:a,pathType:p.pathType}):t})}module.exports=m;

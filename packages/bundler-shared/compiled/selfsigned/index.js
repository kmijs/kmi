(function(){var e={801:function(e,t,r){var a=r(809);r(690);r(180);r(362);e.exports=a.aes=a.aes||{};a.aes.startEncrypting=function(e,t,r,a){var i=_createCipher({key:e,output:r,decrypt:false,mode:a});i.start(t);return i};a.aes.createEncryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:false,mode:t})};a.aes.startDecrypting=function(e,t,r,a){var i=_createCipher({key:e,output:r,decrypt:true,mode:a});i.start(t);return i};a.aes.createDecryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:true,mode:t})};a.aes.Algorithm=function(e,t){if(!i){initialize()}var r=this;r.name=e;r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return _updateBlock(r._w,e,t,false)},decrypt:function(e,t){return _updateBlock(r._w,e,t,true)}}});r._init=false};a.aes.Algorithm.prototype.initialize=function(e){if(this._init){return}var t=e.key;var r;if(typeof t==="string"&&(t.length===16||t.length===24||t.length===32)){t=a.util.createBuffer(t)}else if(a.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t;t=a.util.createBuffer();for(var i=0;i<r.length;++i){t.putByte(r[i])}}if(!a.util.isArray(t)){r=t;t=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i){t.push(r.getInt32())}}}if(!a.util.isArray(t)||!(t.length===4||t.length===6||t.length===8)){throw new Error("Invalid key parameter.")}var s=this.mode.name;var o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=_expandKey(t,e.decrypt&&!o);this._init=true};a.aes._expandKey=function(e,t){if(!i){initialize()}return _expandKey(e,t)};a.aes._updateBlock=_updateBlock;registerAlgorithm("AES-ECB",a.cipher.modes.ecb);registerAlgorithm("AES-CBC",a.cipher.modes.cbc);registerAlgorithm("AES-CFB",a.cipher.modes.cfb);registerAlgorithm("AES-OFB",a.cipher.modes.ofb);registerAlgorithm("AES-CTR",a.cipher.modes.ctr);registerAlgorithm("AES-GCM",a.cipher.modes.gcm);function registerAlgorithm(e,t){var factory=function(){return new a.aes.Algorithm(e,t)};a.cipher.registerAlgorithm(e,factory)}var i=false;var n=4;var s;var o;var u;var l;var c;function initialize(){i=true;u=[0,1,2,4,8,16,32,64,128,27,54];var e=new Array(256);for(var t=0;t<128;++t){e[t]=t<<1;e[t+128]=t+128<<1^283}s=new Array(256);o=new Array(256);l=new Array(4);c=new Array(4);for(var t=0;t<4;++t){l[t]=new Array(256);c[t]=new Array(256)}var r=0,a=0,n,p,h,d,g,y,v;for(var t=0;t<256;++t){d=a^a<<1^a<<2^a<<3^a<<4;d=d>>8^d&255^99;s[r]=d;o[d]=r;g=e[d];n=e[r];p=e[n];h=e[p];y=g<<24^d<<16^d<<8^(d^g);v=(n^p^h)<<24^(r^h)<<16^(r^p^h)<<8^(r^n^h);for(var m=0;m<4;++m){l[m][r]=y;c[m][d]=v;y=y<<24|y>>>8;v=v<<24|v>>>8}if(r===0){r=a=1}else{r=n^e[e[e[n^h]]];a^=e[e[a]]}}}function _expandKey(e,t){var r=e.slice(0);var a,i=1;var o=r.length;var l=o+6+1;var p=n*l;for(var h=o;h<p;++h){a=r[h-1];if(h%o===0){a=s[a>>>16&255]<<24^s[a>>>8&255]<<16^s[a&255]<<8^s[a>>>24]^u[i]<<24;i++}else if(o>6&&h%o===4){a=s[a>>>24]<<24^s[a>>>16&255]<<16^s[a>>>8&255]<<8^s[a&255]}r[h]=r[h-o]^a}if(t){var d;var g=c[0];var y=c[1];var v=c[2];var m=c[3];var C=r.slice(0);p=r.length;for(var h=0,E=p-n;h<p;h+=n,E-=n){if(h===0||h===p-n){C[h]=r[E];C[h+1]=r[E+3];C[h+2]=r[E+2];C[h+3]=r[E+1]}else{for(var I=0;I<n;++I){d=r[E+I];C[h+(3&-I)]=g[s[d>>>24]]^y[s[d>>>16&255]]^v[s[d>>>8&255]]^m[s[d&255]]}}}r=C}return r}function _updateBlock(e,t,r,a){var i=e.length/4-1;var n,u,p,h,d;if(a){n=c[0];u=c[1];p=c[2];h=c[3];d=o}else{n=l[0];u=l[1];p=l[2];h=l[3];d=s}var g,y,v,m,C,E,I;g=t[0]^e[0];y=t[a?3:1]^e[1];v=t[2]^e[2];m=t[a?1:3]^e[3];var T=3;for(var b=1;b<i;++b){C=n[g>>>24]^u[y>>>16&255]^p[v>>>8&255]^h[m&255]^e[++T];E=n[y>>>24]^u[v>>>16&255]^p[m>>>8&255]^h[g&255]^e[++T];I=n[v>>>24]^u[m>>>16&255]^p[g>>>8&255]^h[y&255]^e[++T];m=n[m>>>24]^u[g>>>16&255]^p[y>>>8&255]^h[v&255]^e[++T];g=C;y=E;v=I}r[0]=d[g>>>24]<<24^d[y>>>16&255]<<16^d[v>>>8&255]<<8^d[m&255]^e[++T];r[a?3:1]=d[y>>>24]<<24^d[v>>>16&255]<<16^d[m>>>8&255]<<8^d[g&255]^e[++T];r[2]=d[v>>>24]<<24^d[m>>>16&255]<<16^d[g>>>8&255]<<8^d[y&255]^e[++T];r[a?1:3]=d[m>>>24]<<24^d[g>>>16&255]<<16^d[y>>>8&255]<<8^d[v&255]^e[++T]}function _createCipher(e){e=e||{};var t=(e.mode||"CBC").toUpperCase();var r="AES-"+t;var i;if(e.decrypt){i=a.cipher.createDecipher(r,e.key)}else{i=a.cipher.createCipher(r,e.key)}var n=i.start;i.start=function(e,t){var r=null;if(t instanceof a.util.ByteBuffer){r=t;t={}}t=t||{};t.output=r;t.iv=e;n.call(i,t)};return i}},901:function(e,t,r){var a=r(809);r(801);r(486);var i=e.exports=a.tls;i.CipherSuites["TLS_RSA_WITH_AES_128_CBC_SHA"]={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes;e.cipher_type=i.CipherType.block;e.enc_key_length=16;e.block_length=16;e.fixed_iv_length=16;e.record_iv_length=16;e.mac_algorithm=i.MACAlgorithm.hmac_sha1;e.mac_length=20;e.mac_key_length=20},initConnectionState:initConnectionState};i.CipherSuites["TLS_RSA_WITH_AES_256_CBC_SHA"]={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes;e.cipher_type=i.CipherType.block;e.enc_key_length=32;e.block_length=16;e.fixed_iv_length=16;e.record_iv_length=16;e.mac_algorithm=i.MACAlgorithm.hmac_sha1;e.mac_length=20;e.mac_key_length=20},initConnectionState:initConnectionState};function initConnectionState(e,t,r){var n=t.entity===a.tls.ConnectionEnd.client;e.read.cipherState={init:false,cipher:a.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV};e.write.cipherState={init:false,cipher:a.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV};e.read.cipherFunction=decrypt_aes_cbc_sha1;e.write.cipherFunction=encrypt_aes_cbc_sha1;e.read.macLength=e.write.macLength=r.mac_length;e.read.macFunction=e.write.macFunction=i.hmac_sha1}function encrypt_aes_cbc_sha1(e,t){var r=false;var n=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(n);t.updateSequenceNumber();var s;if(e.version.minor===i.Versions.TLS_1_0.minor){s=t.cipherState.init?null:t.cipherState.iv}else{s=a.random.getBytesSync(16)}t.cipherState.init=true;var o=t.cipherState.cipher;o.start({iv:s});if(e.version.minor>=i.Versions.TLS_1_1.minor){o.output.putBytes(s)}o.update(e.fragment);if(o.finish(encrypt_aes_cbc_sha1_padding)){e.fragment=o.output;e.length=e.fragment.length();r=true}return r}function encrypt_aes_cbc_sha1_padding(e,t,r){if(!r){var a=e-t.length()%e;t.fillWithByte(a-1,a)}return true}function decrypt_aes_cbc_sha1_padding(e,t,r){var a=true;if(r){var i=t.length();var n=t.last();for(var s=i-1-n;s<i-1;++s){a=a&&t.at(s)==n}if(a){t.truncate(n+1)}}return a}function decrypt_aes_cbc_sha1(e,t){var r=false;var n;if(e.version.minor===i.Versions.TLS_1_0.minor){n=t.cipherState.init?null:t.cipherState.iv}else{n=e.fragment.getBytes(16)}t.cipherState.init=true;var s=t.cipherState.cipher;s.start({iv:n});s.update(e.fragment);r=s.finish(decrypt_aes_cbc_sha1_padding);var o=t.macLength;var u=a.random.getBytesSync(o);var l=s.output.length();if(l>=o){e.fragment=s.output.getBytes(l-o);u=s.output.getBytes(o)}else{e.fragment=s.output.getBytes()}e.fragment=a.util.createBuffer(e.fragment);e.length=e.fragment.length();var c=t.macFunction(t.macKey,t.sequenceNumber,e);t.updateSequenceNumber();r=compareMacs(t.macKey,u,c)&&r;return r}function compareMacs(e,t,r){var i=a.hmac.create();i.start("SHA1",e);i.update(t);t=i.digest().getBytes();i.start(null,null);i.update(r);r=i.digest().getBytes();return t===r}},269:function(e,t,r){var a=r(809);r(446);var i=a.asn1;t.privateKeyValidator={name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};t.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"publicKeyOid"}]},{tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:false,composed:true,captureBitStringValue:"ed25519PublicKey"}]}},446:function(e,t,r){var a=r(809);r(362);r(957);var i=e.exports=a.asn1=a.asn1||{};i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};i.create=function(e,t,r,n,s){if(a.util.isArray(n)){var o=[];for(var u=0;u<n.length;++u){if(n[u]!==undefined){o.push(n[u])}}n=o}var l={tagClass:e,type:t,constructed:r,composed:r||a.util.isArray(n),value:n};if(s&&"bitStringContents"in s){l.bitStringContents=s.bitStringContents;l.original=i.copy(l)}return l};i.copy=function(e,t){var r;if(a.util.isArray(e)){r=[];for(var n=0;n<e.length;++n){r.push(i.copy(e[n],t))}return r}if(typeof e==="string"){return e}r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)};if(t&&!t.excludeBitStringContents){r.bitStringContents=e.bitStringContents}return r};i.equals=function(e,t,r){if(a.util.isArray(e)){if(!a.util.isArray(t)){return false}if(e.length!==t.length){return false}for(var n=0;n<e.length;++n){if(!i.equals(e[n],t[n])){return false}}return true}if(typeof e!==typeof t){return false}if(typeof e==="string"){return e===t}var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);if(r&&r.includeBitStringContents){s=s&&e.bitStringContents===t.bitStringContents}return s};i.getBerValueLength=function(e){var t=e.getByte();if(t===128){return undefined}var r;var a=t&128;if(!a){r=t}else{r=e.getInt((t&127)<<3)}return r};function _checkBufferLength(e,t,r){if(r>t){var a=new Error("Too few bytes to parse DER.");a.available=e.length();a.remaining=t;a.requested=r;throw a}}var _getValueLength=function(e,t){var r=e.getByte();t--;if(r===128){return undefined}var a;var i=r&128;if(!i){a=r}else{var n=r&127;_checkBufferLength(e,t,n);a=e.getInt(n<<3)}if(a<0){throw new Error("Negative length: "+a)}return a};i.fromDer=function(e,t){if(t===undefined){t={strict:true,parseAllBytes:true,decodeBitStrings:true}}if(typeof t==="boolean"){t={strict:t,parseAllBytes:true,decodeBitStrings:true}}if(!("strict"in t)){t.strict=true}if(!("parseAllBytes"in t)){t.parseAllBytes=true}if(!("decodeBitStrings"in t)){t.decodeBitStrings=true}if(typeof e==="string"){e=a.util.createBuffer(e)}var r=e.length();var i=_fromDer(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");n.byteCount=r;n.remaining=e.length();throw n}return i};function _fromDer(e,t,r,a){var n;_checkBufferLength(e,t,2);var s=e.getByte();t--;var o=s&192;var u=s&31;n=e.length();var l=_getValueLength(e,t);t-=n-e.length();if(l!==undefined&&l>t){if(a.strict){var c=new Error("Too few bytes to read ASN.1 value.");c.available=e.length();c.remaining=t;c.requested=l;throw c}l=t}var p;var h;var d=(s&32)===32;if(d){p=[];if(l===undefined){for(;;){_checkBufferLength(e,t,2);if(e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2);t-=2;break}n=e.length();p.push(_fromDer(e,t,r+1,a));t-=n-e.length()}}else{while(l>0){n=e.length();p.push(_fromDer(e,l,r+1,a));t-=n-e.length();l-=n-e.length()}}}if(p===undefined&&o===i.Class.UNIVERSAL&&u===i.Type.BITSTRING){h=e.bytes(l)}if(p===undefined&&a.decodeBitStrings&&o===i.Class.UNIVERSAL&&u===i.Type.BITSTRING&&l>1){var g=e.read;var y=t;var v=0;if(u===i.Type.BITSTRING){_checkBufferLength(e,t,1);v=e.getByte();t--}if(v===0){try{n=e.length();var m={strict:true,decodeBitStrings:true};var C=_fromDer(e,t,r+1,m);var E=n-e.length();t-=E;if(u==i.Type.BITSTRING){E++}var I=C.tagClass;if(E===l&&(I===i.Class.UNIVERSAL||I===i.Class.CONTEXT_SPECIFIC)){p=[C]}}catch(e){}}if(p===undefined){e.read=g;t=y}}if(p===undefined){if(l===undefined){if(a.strict){throw new Error("Non-constructed ASN.1 object of indefinite length.")}l=t}if(u===i.Type.BMPSTRING){p="";for(;l>0;l-=2){_checkBufferLength(e,t,2);p+=String.fromCharCode(e.getInt16());t-=2}}else{p=e.getBytes(l);t-=l}}var T=h===undefined?null:{bitStringContents:h};return i.create(o,u,d,p,T)}i.toDer=function(e){var t=a.util.createBuffer();var r=e.tagClass|e.type;var n=a.util.createBuffer();var s=false;if("bitStringContents"in e){s=true;if(e.original){s=i.equals(e,e.original)}}if(s){n.putBytes(e.bitStringContents)}else if(e.composed){if(e.constructed){r|=32}else{n.putByte(0)}for(var o=0;o<e.value.length;++o){if(e.value[o]!==undefined){n.putBuffer(i.toDer(e.value[o]))}}}else{if(e.type===i.Type.BMPSTRING){for(var o=0;o<e.value.length;++o){n.putInt16(e.value.charCodeAt(o))}}else{if(e.type===i.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)){n.putBytes(e.value.substr(1))}else{n.putBytes(e.value)}}}t.putByte(r);if(n.length()<=127){t.putByte(n.length()&127)}else{var u=n.length();var l="";do{l+=String.fromCharCode(u&255);u=u>>>8}while(u>0);t.putByte(l.length|128);for(var o=l.length-1;o>=0;--o){t.putByte(l.charCodeAt(o))}}t.putBuffer(n);return t};i.oidToDer=function(e){var t=e.split(".");var r=a.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));var i,n,s,o;for(var u=2;u<t.length;++u){i=true;n=[];s=parseInt(t[u],10);do{o=s&127;s=s>>>7;if(!i){o|=128}n.push(o);i=false}while(s>0);for(var l=n.length-1;l>=0;--l){r.putByte(n[l])}}return r};i.derToOid=function(e){var t;if(typeof e==="string"){e=a.util.createBuffer(e)}var r=e.getByte();t=Math.floor(r/40)+"."+r%40;var i=0;while(e.length()>0){r=e.getByte();i=i<<7;if(r&128){i+=r&127}else{t+="."+(i+r);i=0}}return t};i.utcTimeToDate=function(e){var t=new Date;var r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var a=parseInt(e.substr(2,2),10)-1;var i=parseInt(e.substr(4,2),10);var n=parseInt(e.substr(6,2),10);var s=parseInt(e.substr(8,2),10);var o=0;if(e.length>11){var u=e.charAt(10);var l=10;if(u!=="+"&&u!=="-"){o=parseInt(e.substr(10,2),10);l+=2}}t.setUTCFullYear(r,a,i);t.setUTCHours(n,s,o,0);if(l){u=e.charAt(l);if(u==="+"||u==="-"){var c=parseInt(e.substr(l+1,2),10);var p=parseInt(e.substr(l+4,2),10);var h=c*60+p;h*=6e4;if(u==="+"){t.setTime(+t-h)}else{t.setTime(+t+h)}}}return t};i.generalizedTimeToDate=function(e){var t=new Date;var r=parseInt(e.substr(0,4),10);var a=parseInt(e.substr(4,2),10)-1;var i=parseInt(e.substr(6,2),10);var n=parseInt(e.substr(8,2),10);var s=parseInt(e.substr(10,2),10);var o=parseInt(e.substr(12,2),10);var u=0;var l=0;var c=false;if(e.charAt(e.length-1)==="Z"){c=true}var p=e.length-5,h=e.charAt(p);if(h==="+"||h==="-"){var d=parseInt(e.substr(p+1,2),10);var g=parseInt(e.substr(p+4,2),10);l=d*60+g;l*=6e4;if(h==="+"){l*=-1}c=true}if(e.charAt(14)==="."){u=parseFloat(e.substr(14),10)*1e3}if(c){t.setUTCFullYear(r,a,i);t.setUTCHours(n,s,o,u);t.setTime(+t+l)}else{t.setFullYear(r,a,i);t.setHours(n,s,o,u)}return t};i.dateToUtcTime=function(e){if(typeof e==="string"){return e}var t="";var r=[];r.push((""+e.getUTCFullYear()).substr(2));r.push(""+(e.getUTCMonth()+1));r.push(""+e.getUTCDate());r.push(""+e.getUTCHours());r.push(""+e.getUTCMinutes());r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a){if(r[a].length<2){t+="0"}t+=r[a]}t+="Z";return t};i.dateToGeneralizedTime=function(e){if(typeof e==="string"){return e}var t="";var r=[];r.push(""+e.getUTCFullYear());r.push(""+(e.getUTCMonth()+1));r.push(""+e.getUTCDate());r.push(""+e.getUTCHours());r.push(""+e.getUTCMinutes());r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a){if(r[a].length<2){t+="0"}t+=r[a]}t+="Z";return t};i.integerToDer=function(e){var t=a.util.createBuffer();if(e>=-128&&e<128){return t.putSignedInt(e,8)}if(e>=-32768&&e<32768){return t.putSignedInt(e,16)}if(e>=-8388608&&e<8388608){return t.putSignedInt(e,24)}if(e>=-2147483648&&e<2147483648){return t.putSignedInt(e,32)}var r=new Error("Integer too large; max is 32-bits.");r.integer=e;throw r};i.derToInteger=function(e){if(typeof e==="string"){e=a.util.createBuffer(e)}var t=e.length()*8;if(t>32){throw new Error("Integer too large; max is 32-bits.")}return e.getSignedInt(t)};i.validate=function(e,t,r,n){var s=false;if((e.tagClass===t.tagClass||typeof t.tagClass==="undefined")&&(e.type===t.type||typeof t.type==="undefined")){if(e.constructed===t.constructed||typeof t.constructed==="undefined"){s=true;if(t.value&&a.util.isArray(t.value)){var o=0;for(var u=0;s&&u<t.value.length;++u){s=t.value[u].optional||false;if(e.value[o]){s=i.validate(e.value[o],t.value[u],r,n);if(s){++o}else if(t.value[u].optional){s=true}}if(!s&&n){n.push("["+t.name+"] "+'Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"')}}}if(s&&r){if(t.capture){r[t.capture]=e.value}if(t.captureAsn1){r[t.captureAsn1]=e}if(t.captureBitStringContents&&"bitStringContents"in e){r[t.captureBitStringContents]=e.bitStringContents}if(t.captureBitStringValue&&"bitStringContents"in e){var l;if(e.bitStringContents.length<2){r[t.captureBitStringValue]=""}else{var c=e.bitStringContents.charCodeAt(0);if(c!==0){throw new Error("captureBitStringValue only supported for zero unused bits")}r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}}else if(n){n.push("["+t.name+"] "+'Expected constructed "'+t.constructed+'", got "'+e.constructed+'"')}}else if(n){if(e.tagClass!==t.tagClass){n.push("["+t.name+"] "+'Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"')}if(e.type!==t.type){n.push("["+t.name+"] "+'Expected type "'+t.type+'", got "'+e.type+'"')}}return s};var n=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var s="";t=t||0;r=r||2;if(t>0){s+="\n"}var o="";for(var u=0;u<t*r;++u){o+=" "}s+=o+"Tag: ";switch(e.tagClass){case i.Class.UNIVERSAL:s+="Universal:";break;case i.Class.APPLICATION:s+="Application:";break;case i.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case i.Class.PRIVATE:s+="Private:";break}if(e.tagClass===i.Class.UNIVERSAL){s+=e.type;switch(e.type){case i.Type.NONE:s+=" (None)";break;case i.Type.BOOLEAN:s+=" (Boolean)";break;case i.Type.INTEGER:s+=" (Integer)";break;case i.Type.BITSTRING:s+=" (Bit string)";break;case i.Type.OCTETSTRING:s+=" (Octet string)";break;case i.Type.NULL:s+=" (Null)";break;case i.Type.OID:s+=" (Object Identifier)";break;case i.Type.ODESC:s+=" (Object Descriptor)";break;case i.Type.EXTERNAL:s+=" (External or Instance of)";break;case i.Type.REAL:s+=" (Real)";break;case i.Type.ENUMERATED:s+=" (Enumerated)";break;case i.Type.EMBEDDED:s+=" (Embedded PDV)";break;case i.Type.UTF8:s+=" (UTF8)";break;case i.Type.ROID:s+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:s+=" (Sequence)";break;case i.Type.SET:s+=" (Set)";break;case i.Type.PRINTABLESTRING:s+=" (Printable String)";break;case i.Type.IA5String:s+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:s+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case i.Type.BMPSTRING:s+=" (BMP String)";break}}else{s+=e.type}s+="\n";s+=o+"Constructed: "+e.constructed+"\n";if(e.composed){var l=0;var c="";for(var u=0;u<e.value.length;++u){if(e.value[u]!==undefined){l+=1;c+=i.prettyPrint(e.value[u],t+1,r);if(u+1<e.value.length){c+=","}}}s+=o+"Sub values: "+l+c}else{s+=o+"Value: ";if(e.type===i.Type.OID){var p=i.derToOid(e.value);s+=p;if(a.pki&&a.pki.oids){if(p in a.pki.oids){s+=" ("+a.pki.oids[p]+") "}}}if(e.type===i.Type.INTEGER){try{s+=i.derToInteger(e.value)}catch(t){s+="0x"+a.util.bytesToHex(e.value)}}else if(e.type===i.Type.BITSTRING){if(e.value.length>1){s+="0x"+a.util.bytesToHex(e.value.slice(1))}else{s+="(none)"}if(e.value.length>0){var h=e.value.charCodeAt(0);if(h==1){s+=" (1 unused bit shown)"}else if(h>1){s+=" ("+h+" unused bits shown)"}}}else if(e.type===i.Type.OCTETSTRING){if(!n.test(e.value)){s+="("+e.value+") "}s+="0x"+a.util.bytesToHex(e.value)}else if(e.type===i.Type.UTF8){try{s+=a.util.decodeUtf8(e.value)}catch(t){if(t.message==="URI malformed"){s+="0x"+a.util.bytesToHex(e.value)+" (malformed UTF8)"}else{throw t}}}else if(e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String){s+=e.value}else if(n.test(e.value)){s+="0x"+a.util.bytesToHex(e.value)}else if(e.value.length===0){s+="[null]"}else{s+=e.value}}return s}},592:function(e){var t={};e.exports=t;var r={};t.encode=function(e,t,r){if(typeof t!=="string"){throw new TypeError('"alphabet" must be a string.')}if(r!==undefined&&typeof r!=="number"){throw new TypeError('"maxline" must be a number.')}var a="";if(!(e instanceof Uint8Array)){a=_encodeWithByteBuffer(e,t)}else{var i=0;var n=t.length;var s=t.charAt(0);var o=[0];for(i=0;i<e.length;++i){for(var u=0,l=e[i];u<o.length;++u){l+=o[u]<<8;o[u]=l%n;l=l/n|0}while(l>0){o.push(l%n);l=l/n|0}}for(i=0;e[i]===0&&i<e.length-1;++i){a+=s}for(i=o.length-1;i>=0;--i){a+=t[o[i]]}}if(r){var c=new RegExp(".{1,"+r+"}","g");a=a.match(c).join("\r\n")}return a};t.decode=function(e,t){if(typeof e!=="string"){throw new TypeError('"input" must be a string.')}if(typeof t!=="string"){throw new TypeError('"alphabet" must be a string.')}var a=r[t];if(!a){a=r[t]=[];for(var i=0;i<t.length;++i){a[t.charCodeAt(i)]=i}}e=e.replace(/\s/g,"");var n=t.length;var s=t.charAt(0);var o=[0];for(var i=0;i<e.length;i++){var u=a[e.charCodeAt(i)];if(u===undefined){return}for(var l=0,c=u;l<o.length;++l){c+=o[l]*n;o[l]=c&255;c>>=8}while(c>0){o.push(c&255);c>>=8}}for(var p=0;e[p]===s&&p<e.length-1;++p){o.push(0)}if(typeof Buffer!=="undefined"){return Buffer.from(o.reverse())}return new Uint8Array(o.reverse())};function _encodeWithByteBuffer(e,t){var r=0;var a=t.length;var i=t.charAt(0);var n=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<n.length;++s){o+=n[s]<<8;n[s]=o%a;o=o/a|0}while(o>0){n.push(o%a);o=o/a|0}}var u="";for(r=0;e.at(r)===0&&r<e.length()-1;++r){u+=i}for(r=n.length-1;r>=0;--r){u+=t[n[r]]}return u}},690:function(e,t,r){var a=r(809);r(362);e.exports=a.cipher=a.cipher||{};a.cipher.algorithms=a.cipher.algorithms||{};a.cipher.createCipher=function(e,t){var r=e;if(typeof r==="string"){r=a.cipher.getAlgorithm(r);if(r){r=r()}}if(!r){throw new Error("Unsupported algorithm: "+e)}return new a.cipher.BlockCipher({algorithm:r,key:t,decrypt:false})};a.cipher.createDecipher=function(e,t){var r=e;if(typeof r==="string"){r=a.cipher.getAlgorithm(r);if(r){r=r()}}if(!r){throw new Error("Unsupported algorithm: "+e)}return new a.cipher.BlockCipher({algorithm:r,key:t,decrypt:true})};a.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase();a.cipher.algorithms[e]=t};a.cipher.getAlgorithm=function(e){e=e.toUpperCase();if(e in a.cipher.algorithms){return a.cipher.algorithms[e]}return null};var i=a.cipher.BlockCipher=function(e){this.algorithm=e.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=false;this._input=null;this.output=null;this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=e.decrypt;this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e){t[r]=e[r]}t.decrypt=this._decrypt;this._finish=false;this._input=a.util.createBuffer();this.output=e.output||a.util.createBuffer();this.mode.start(t)};i.prototype.update=function(e){if(e){this._input.putBuffer(e)}while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish){}this._input.compact()};i.prototype.finish=function(e){if(e&&(this.mode.name==="ECB"||this.mode.name==="CBC")){this.mode.pad=function(t){return e(this.blockSize,t,false)};this.mode.unpad=function(t){return e(this.blockSize,t,true)}}var t={};t.decrypt=this._decrypt;t.overflow=this._input.length()%this.blockSize;if(!this._decrypt&&this.mode.pad){if(!this.mode.pad(this._input,t)){return false}}this._finish=true;this.update();if(this._decrypt&&this.mode.unpad){if(!this.mode.unpad(this.output,t)){return false}}if(this.mode.afterFinish){if(!this.mode.afterFinish(this.output,t)){return false}}return true}},180:function(e,t,r){var a=r(809);r(362);a.cipher=a.cipher||{};var i=e.exports=a.cipher.modes=a.cipher.modes||{};i.ecb=function(e){e=e||{};this.name="ECB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};i.ecb.prototype.start=function(e){};i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var a=0;a<this._ints;++a){this._inBlock[a]=e.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a){t.putInt32(this._outBlock[a])}};i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var a=0;a<this._ints;++a){this._inBlock[a]=e.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a){t.putInt32(this._outBlock[a])}};i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();e.fillWithByte(r,r);return true};i.ecb.prototype.unpad=function(e,t){if(t.overflow>0){return false}var r=e.length();var a=e.at(r-1);if(a>this.blockSize<<2){return false}e.truncate(a);return true};i.cbc=function(e){e=e||{};this.name="CBC";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};i.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev){throw new Error("Invalid IV parameter.")}this._iv=this._prev.slice(0)}else if(!("iv"in e)){throw new Error("Invalid IV parameter.")}else{this._iv=transformIV(e.iv,this.blockSize);this._prev=this._iv.slice(0)}};i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var a=0;a<this._ints;++a){this._inBlock[a]=this._prev[a]^e.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a){t.putInt32(this._outBlock[a])}this._prev=this._outBlock};i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var a=0;a<this._ints;++a){this._inBlock[a]=e.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var a=0;a<this._ints;++a){t.putInt32(this._prev[a]^this._outBlock[a])}this._prev=this._inBlock.slice(0)};i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();e.fillWithByte(r,r);return true};i.cbc.prototype.unpad=function(e,t){if(t.overflow>0){return false}var r=e.length();var a=e.at(r-1);if(a>this.blockSize<<2){return false}e.truncate(a);return true};i.cfb=function(e){e=e||{};this.name="CFB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialBlock=new Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};i.cfb.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};i.cfb.prototype.encrypt=function(e,t,r){var a=e.length();if(a===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&a>=this.blockSize){for(var i=0;i<this._ints;++i){this._inBlock[i]=e.getInt32()^this._outBlock[i];t.putInt32(this._inBlock[i])}return}var n=(this.blockSize-a)%this.blockSize;if(n>0){n=this.blockSize-n}this._partialOutput.clear();for(var i=0;i<this._ints;++i){this._partialBlock[i]=e.getInt32()^this._outBlock[i];this._partialOutput.putInt32(this._partialBlock[i])}if(n>0){e.read-=this.blockSize}else{for(var i=0;i<this._ints;++i){this._inBlock[i]=this._partialBlock[i]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(n>0&&!r){t.putBytes(this._partialOutput.getBytes(n-this._partialBytes));this._partialBytes=n;return true}t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=0};i.cfb.prototype.decrypt=function(e,t,r){var a=e.length();if(a===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&a>=this.blockSize){for(var i=0;i<this._ints;++i){this._inBlock[i]=e.getInt32();t.putInt32(this._inBlock[i]^this._outBlock[i])}return}var n=(this.blockSize-a)%this.blockSize;if(n>0){n=this.blockSize-n}this._partialOutput.clear();for(var i=0;i<this._ints;++i){this._partialBlock[i]=e.getInt32();this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i])}if(n>0){e.read-=this.blockSize}else{for(var i=0;i<this._ints;++i){this._inBlock[i]=this._partialBlock[i]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(n>0&&!r){t.putBytes(this._partialOutput.getBytes(n-this._partialBytes));this._partialBytes=n;return true}t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=0};i.ofb=function(e){e=e||{};this.name="OFB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};i.ofb.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};i.ofb.prototype.encrypt=function(e,t,r){var a=e.length();if(e.length()===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&a>=this.blockSize){for(var i=0;i<this._ints;++i){t.putInt32(e.getInt32()^this._outBlock[i]);this._inBlock[i]=this._outBlock[i]}return}var n=(this.blockSize-a)%this.blockSize;if(n>0){n=this.blockSize-n}this._partialOutput.clear();for(var i=0;i<this._ints;++i){this._partialOutput.putInt32(e.getInt32()^this._outBlock[i])}if(n>0){e.read-=this.blockSize}else{for(var i=0;i<this._ints;++i){this._inBlock[i]=this._outBlock[i]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(n>0&&!r){t.putBytes(this._partialOutput.getBytes(n-this._partialBytes));this._partialBytes=n;return true}t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=0};i.ofb.prototype.decrypt=i.ofb.prototype.encrypt;i.ctr=function(e){e=e||{};this.name="CTR";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};i.ctr.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};i.ctr.prototype.encrypt=function(e,t,r){var a=e.length();if(a===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&a>=this.blockSize){for(var i=0;i<this._ints;++i){t.putInt32(e.getInt32()^this._outBlock[i])}}else{var n=(this.blockSize-a)%this.blockSize;if(n>0){n=this.blockSize-n}this._partialOutput.clear();for(var i=0;i<this._ints;++i){this._partialOutput.putInt32(e.getInt32()^this._outBlock[i])}if(n>0){e.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(n>0&&!r){t.putBytes(this._partialOutput.getBytes(n-this._partialBytes));this._partialBytes=n;return true}t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=0}inc32(this._inBlock)};i.ctr.prototype.decrypt=i.ctr.prototype.encrypt;i.gcm=function(e){e=e||{};this.name="GCM";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0;this._R=3774873600};i.gcm.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}var t=a.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e){r=a.util.createBuffer(e.additionalData)}else{r=a.util.createBuffer()}if("tagLength"in e){this._tagLength=e.tagLength}else{this._tagLength=128}this._tag=null;if(e.decrypt){this._tag=a.util.createBuffer(e.tag).getBytes();if(this._tag.length!==this._tagLength/8){throw new Error("Authentication tag does not match tag length.")}}this._hashBlock=new Array(this._ints);this.tag=null;this._hashSubkey=new Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=t.length();if(i===12){this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1]}else{this._j0=[0,0,0,0];while(t.length()>0){this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])}this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(i*8)))}this._inBlock=this._j0.slice(0);inc32(this._inBlock);this._partialBytes=0;r=a.util.createBuffer(r);this._aDataLength=from64To32(r.length()*8);var n=r.length()%this.blockSize;if(n){r.fillWithByte(0,this.blockSize-n)}this._s=[0,0,0,0];while(r.length()>0){this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])}};i.gcm.prototype.encrypt=function(e,t,r){var a=e.length();if(a===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&a>=this.blockSize){for(var i=0;i<this._ints;++i){t.putInt32(this._outBlock[i]^=e.getInt32())}this._cipherLength+=this.blockSize}else{var n=(this.blockSize-a)%this.blockSize;if(n>0){n=this.blockSize-n}this._partialOutput.clear();for(var i=0;i<this._ints;++i){this._partialOutput.putInt32(e.getInt32()^this._outBlock[i])}if(n<=0||r){if(r){var s=a%this.blockSize;this._cipherLength+=s;this._partialOutput.truncate(this.blockSize-s)}else{this._cipherLength+=this.blockSize}for(var i=0;i<this._ints;++i){this._outBlock[i]=this._partialOutput.getInt32()}this._partialOutput.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(n>0&&!r){e.read-=this.blockSize;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes));this._partialBytes=n;return true}t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);inc32(this._inBlock)};i.gcm.prototype.decrypt=function(e,t,r){var a=e.length();if(a<this.blockSize&&!(r&&a>0)){return true}this.cipher.encrypt(this._inBlock,this._outBlock);inc32(this._inBlock);this._hashBlock[0]=e.getInt32();this._hashBlock[1]=e.getInt32();this._hashBlock[2]=e.getInt32();this._hashBlock[3]=e.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i){t.putInt32(this._outBlock[i]^this._hashBlock[i])}if(a<this.blockSize){this._cipherLength+=a%this.blockSize}else{this._cipherLength+=this.blockSize}};i.gcm.prototype.afterFinish=function(e,t){var r=true;if(t.decrypt&&t.overflow){e.truncate(this.blockSize-t.overflow)}this.tag=a.util.createBuffer();var i=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s){this.tag.putInt32(this._s[s]^n[s])}this.tag.truncate(this.tag.length()%(this._tagLength/8));if(t.decrypt&&this.tag.bytes()!==this._tag){r=false}return r};i.gcm.prototype.multiply=function(e,t){var r=[0,0,0,0];var a=t.slice(0);for(var i=0;i<128;++i){var n=e[i/32|0]&1<<31-i%32;if(n){r[0]^=a[0];r[1]^=a[1];r[2]^=a[2];r[3]^=a[3]}this.pow(a,a)}return r};i.gcm.prototype.pow=function(e,t){var r=e[3]&1;for(var a=3;a>0;--a){t[a]=e[a]>>>1|(e[a-1]&1)<<31}t[0]=e[0]>>>1;if(r){t[0]^=this._R}};i.gcm.prototype.tableMultiply=function(e){var t=[0,0,0,0];for(var r=0;r<32;++r){var a=r/8|0;var i=e[a]>>>(7-r%8)*4&15;var n=this._m[r][i];t[0]^=n[0];t[1]^=n[1];t[2]^=n[2];t[3]^=n[3]}return t};i.gcm.prototype.ghash=function(e,t,r){t[0]^=r[0];t[1]^=r[1];t[2]^=r[2];t[3]^=r[3];return this.tableMultiply(t)};i.gcm.prototype.generateHashTable=function(e,t){var r=8/t;var a=4*r;var i=16*r;var n=new Array(i);for(var s=0;s<i;++s){var o=[0,0,0,0];var u=s/a|0;var l=(a-1-s%a)*t;o[u]=1<<t-1<<l;n[s]=this.generateSubHashTable(this.multiply(o,e),t)}return n};i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t;var a=r>>>1;var i=new Array(r);i[a]=e.slice(0);var n=a>>>1;while(n>0){this.pow(i[2*n],i[n]=[]);n>>=1}n=2;while(n<a){for(var s=1;s<n;++s){var o=i[n];var u=i[s];i[n+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}n*=2}i[0]=[0,0,0,0];for(n=a+1;n<r;++n){var l=i[n^a];i[n]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return i};function transformIV(e,t){if(typeof e==="string"){e=a.util.createBuffer(e)}if(a.util.isArray(e)&&e.length>4){var r=e;e=a.util.createBuffer();for(var i=0;i<r.length;++i){e.putByte(r[i])}}if(e.length()<t){throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.")}if(!a.util.isArray(e)){var n=[];var s=t/4;for(var i=0;i<s;++i){n.push(e.getInt32())}e=n}return e}function inc32(e){e[e.length-1]=e[e.length-1]+1&4294967295}function from64To32(e){return[e/4294967296|0,e&4294967295]}},599:function(e,t,r){var a=r(809);r(690);r(180);r(362);e.exports=a.des=a.des||{};a.des.startEncrypting=function(e,t,r,a){var i=_createCipher({key:e,output:r,decrypt:false,mode:a||(t===null?"ECB":"CBC")});i.start(t);return i};a.des.createEncryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:false,mode:t})};a.des.startDecrypting=function(e,t,r,a){var i=_createCipher({key:e,output:r,decrypt:true,mode:a||(t===null?"ECB":"CBC")});i.start(t);return i};a.des.createDecryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:true,mode:t})};a.des.Algorithm=function(e,t){var r=this;r.name=e;r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return _updateBlock(r._keys,e,t,false)},decrypt:function(e,t){return _updateBlock(r._keys,e,t,true)}}});r._init=false};a.des.Algorithm.prototype.initialize=function(e){if(this._init){return}var t=a.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0){if(t.length()!==24){throw new Error("Invalid Triple-DES key size: "+t.length()*8)}}this._keys=_createKeys(t);this._init=true};registerAlgorithm("DES-ECB",a.cipher.modes.ecb);registerAlgorithm("DES-CBC",a.cipher.modes.cbc);registerAlgorithm("DES-CFB",a.cipher.modes.cfb);registerAlgorithm("DES-OFB",a.cipher.modes.ofb);registerAlgorithm("DES-CTR",a.cipher.modes.ctr);registerAlgorithm("3DES-ECB",a.cipher.modes.ecb);registerAlgorithm("3DES-CBC",a.cipher.modes.cbc);registerAlgorithm("3DES-CFB",a.cipher.modes.cfb);registerAlgorithm("3DES-OFB",a.cipher.modes.ofb);registerAlgorithm("3DES-CTR",a.cipher.modes.ctr);function registerAlgorithm(e,t){var factory=function(){return new a.des.Algorithm(e,t)};a.cipher.registerAlgorithm(e,factory)}var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756];var n=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344];var s=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584];var o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928];var u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080];var l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312];var c=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154];var p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(e){var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],a=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];var y=e.length()>8?3:1;var v=[];var m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];var C=0,E;for(var I=0;I<y;I++){var T=e.getInt32();var b=e.getInt32();E=(T>>>4^b)&252645135;b^=E;T^=E<<4;E=(b>>>-16^T)&65535;T^=E;b^=E<<-16;E=(T>>>2^b)&858993459;b^=E;T^=E<<2;E=(b>>>-16^T)&65535;T^=E;b^=E<<-16;E=(T>>>1^b)&1431655765;b^=E;T^=E<<1;E=(b>>>8^T)&16711935;T^=E;b^=E<<8;E=(T>>>1^b)&1431655765;b^=E;T^=E<<1;E=T<<8|b>>>20&240;T=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240;b=E;for(var B=0;B<m.length;++B){if(m[B]){T=T<<2|T>>>26;b=b<<2|b>>>26}else{T=T<<1|T>>>27;b=b<<1|b>>>27}T&=-15;b&=-15;var _=t[T>>>28]|r[T>>>24&15]|a[T>>>20&15]|i[T>>>16&15]|n[T>>>12&15]|s[T>>>8&15]|o[T>>>4&15];var N=u[b>>>28]|l[b>>>24&15]|c[b>>>20&15]|p[b>>>16&15]|h[b>>>12&15]|d[b>>>8&15]|g[b>>>4&15];E=(N>>>16^_)&65535;v[C++]=_^E;v[C++]=N^E<<16}}return v}function _updateBlock(e,t,r,a){var h=e.length===32?3:9;var d;if(h===3){d=a?[30,-2,-2]:[0,32,2]}else{d=a?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2]}var g;var y=t[0];var v=t[1];g=(y>>>4^v)&252645135;v^=g;y^=g<<4;g=(y>>>16^v)&65535;v^=g;y^=g<<16;g=(v>>>2^y)&858993459;y^=g;v^=g<<2;g=(v>>>8^y)&16711935;y^=g;v^=g<<8;g=(y>>>1^v)&1431655765;v^=g;y^=g<<1;y=y<<1|y>>>31;v=v<<1|v>>>31;for(var m=0;m<h;m+=3){var C=d[m+1];var E=d[m+2];for(var I=d[m];I!=C;I+=E){var T=v^e[I];var b=(v>>>4|v<<28)^e[I+1];g=y;y=v;v=g^(n[T>>>24&63]|o[T>>>16&63]|l[T>>>8&63]|p[T&63]|i[b>>>24&63]|s[b>>>16&63]|u[b>>>8&63]|c[b&63])}g=y;y=v;v=g}y=y>>>1|y<<31;v=v>>>1|v<<31;g=(y>>>1^v)&1431655765;v^=g;y^=g<<1;g=(v>>>8^y)&16711935;y^=g;v^=g<<8;g=(v>>>2^y)&858993459;y^=g;v^=g<<2;g=(y>>>16^v)&65535;v^=g;y^=g<<16;g=(y>>>4^v)&252645135;v^=g;y^=g<<4;r[0]=y;r[1]=v}function _createCipher(e){e=e||{};var t=(e.mode||"CBC").toUpperCase();var r="DES-"+t;var i;if(e.decrypt){i=a.cipher.createDecipher(r,e.key)}else{i=a.cipher.createCipher(r,e.key)}var n=i.start;i.start=function(e,t){var r=null;if(t instanceof a.util.ByteBuffer){r=t;t={}}t=t||{};t.output=r;t.iv=e;n.call(i,t)};return i}},955:function(e,t,r){var a=r(809);r(319);r(394);r(189);r(362);var i=r(269);var n=i.publicKeyValidator;var s=i.privateKeyValidator;if(typeof o==="undefined"){var o=a.jsbn.BigInteger}var u=a.util.ByteBuffer;var l=typeof Buffer==="undefined"?Uint8Array:Buffer;a.pki=a.pki||{};e.exports=a.pki.ed25519=a.ed25519=a.ed25519||{};var c=a.ed25519;c.constants={};c.constants.PUBLIC_KEY_BYTE_LENGTH=32;c.constants.PRIVATE_KEY_BYTE_LENGTH=64;c.constants.SEED_BYTE_LENGTH=32;c.constants.SIGN_BYTE_LENGTH=64;c.constants.HASH_BYTE_LENGTH=64;c.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===undefined){t=a.random.getBytesSync(c.constants.SEED_BYTE_LENGTH)}else if(typeof t==="string"){if(t.length!==c.constants.SEED_BYTE_LENGTH){throw new TypeError('"seed" must be '+c.constants.SEED_BYTE_LENGTH+" bytes in length.")}}else if(!(t instanceof Uint8Array)){throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.')}t=messageToNativeBuffer({message:t,encoding:"binary"});var r=new l(c.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new l(c.constants.PRIVATE_KEY_BYTE_LENGTH);for(var n=0;n<32;++n){i[n]=t[n]}crypto_sign_keypair(r,i);return{publicKey:r,privateKey:i}};c.privateKeyFromAsn1=function(e){var t={};var r=[];var i=a.asn1.validate(e,s,t,r);if(!i){var n=new Error("Invalid Key.");n.errors=r;throw n}var o=a.asn1.derToOid(t.privateKeyOid);var u=a.oids.EdDSA25519;if(o!==u){throw new Error('Invalid OID "'+o+'"; OID must be "'+u+'".')}var l=t.privateKey;var c=messageToNativeBuffer({message:a.asn1.fromDer(l).value,encoding:"binary"});return{privateKeyBytes:c}};c.publicKeyFromAsn1=function(e){var t={};var r=[];var i=a.asn1.validate(e,n,t,r);if(!i){var s=new Error("Invalid Key.");s.errors=r;throw s}var o=a.asn1.derToOid(t.publicKeyOid);var u=a.oids.EdDSA25519;if(o!==u){throw new Error('Invalid OID "'+o+'"; OID must be "'+u+'".')}var l=t.ed25519PublicKey;if(l.length!==c.constants.PUBLIC_KEY_BYTE_LENGTH){throw new Error("Key length is invalid.")}return messageToNativeBuffer({message:l,encoding:"binary"})};c.publicKeyFromPrivateKey=function(e){e=e||{};var t=messageToNativeBuffer({message:e.privateKey,encoding:"binary"});if(t.length!==c.constants.PRIVATE_KEY_BYTE_LENGTH){throw new TypeError('"options.privateKey" must have a byte length of '+c.constants.PRIVATE_KEY_BYTE_LENGTH)}var r=new l(c.constants.PUBLIC_KEY_BYTE_LENGTH);for(var a=0;a<r.length;++a){r[a]=t[32+a]}return r};c.sign=function(e){e=e||{};var t=messageToNativeBuffer(e);var r=messageToNativeBuffer({message:e.privateKey,encoding:"binary"});if(r.length===c.constants.SEED_BYTE_LENGTH){var a=c.generateKeyPair({seed:r});r=a.privateKey}else if(r.length!==c.constants.PRIVATE_KEY_BYTE_LENGTH){throw new TypeError('"options.privateKey" must have a byte length of '+c.constants.SEED_BYTE_LENGTH+" or "+c.constants.PRIVATE_KEY_BYTE_LENGTH)}var i=new l(c.constants.SIGN_BYTE_LENGTH+t.length);crypto_sign(i,t,t.length,r);var n=new l(c.constants.SIGN_BYTE_LENGTH);for(var s=0;s<n.length;++s){n[s]=i[s]}return n};c.verify=function(e){e=e||{};var t=messageToNativeBuffer(e);if(e.signature===undefined){throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge '+"ByteBuffer, or a binary string.")}var r=messageToNativeBuffer({message:e.signature,encoding:"binary"});if(r.length!==c.constants.SIGN_BYTE_LENGTH){throw new TypeError('"options.signature" must have a byte length of '+c.constants.SIGN_BYTE_LENGTH)}var a=messageToNativeBuffer({message:e.publicKey,encoding:"binary"});if(a.length!==c.constants.PUBLIC_KEY_BYTE_LENGTH){throw new TypeError('"options.publicKey" must have a byte length of '+c.constants.PUBLIC_KEY_BYTE_LENGTH)}var i=new l(c.constants.SIGN_BYTE_LENGTH+t.length);var n=new l(c.constants.SIGN_BYTE_LENGTH+t.length);var s;for(s=0;s<c.constants.SIGN_BYTE_LENGTH;++s){i[s]=r[s]}for(s=0;s<t.length;++s){i[s+c.constants.SIGN_BYTE_LENGTH]=t[s]}return crypto_sign_open(n,i,i.length,a)>=0};function messageToNativeBuffer(e){var t=e.message;if(t instanceof Uint8Array||t instanceof l){return t}var r=e.encoding;if(t===undefined){if(e.md){t=e.md.digest().getBytes();r="binary"}else{throw new TypeError('"options.message" or "options.md" not specified.')}}if(typeof t==="string"&&!r){throw new TypeError('"options.encoding" must be "binary" or "utf8".')}if(typeof t==="string"){if(typeof Buffer!=="undefined"){return Buffer.from(t,r)}t=new u(t,r)}else if(!(t instanceof u)){throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge '+'ByteBuffer, or a string with "options.encoding" specifying its '+"encoding.")}var a=new l(t.length());for(var i=0;i<a.length;++i){a[i]=t.at(i)}return a}var p=gf();var h=gf([1]);var d=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]);var g=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]);var y=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]);var v=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);var m=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);var C=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function sha512(e,t){var r=a.md.sha512.create();var i=new u(e);r.update(i.getBytes(t),"binary");var n=r.digest().getBytes();if(typeof Buffer!=="undefined"){return Buffer.from(n,"binary")}var s=new l(c.constants.HASH_BYTE_LENGTH);for(var o=0;o<64;++o){s[o]=n.charCodeAt(o)}return s}function crypto_sign_keypair(e,t){var r=[gf(),gf(),gf(),gf()];var a;var i=sha512(t,32);i[0]&=248;i[31]&=127;i[31]|=64;scalarbase(r,i);pack(e,r);for(a=0;a<32;++a){t[a+32]=e[a]}return 0}function crypto_sign(e,t,r,a){var i,n,s=new Float64Array(64);var o=[gf(),gf(),gf(),gf()];var u=sha512(a,32);u[0]&=248;u[31]&=127;u[31]|=64;var l=r+64;for(i=0;i<r;++i){e[64+i]=t[i]}for(i=0;i<32;++i){e[32+i]=u[32+i]}var c=sha512(e.subarray(32),r+32);reduce(c);scalarbase(o,c);pack(e,o);for(i=32;i<64;++i){e[i]=a[i]}var p=sha512(e,r+64);reduce(p);for(i=32;i<64;++i){s[i]=0}for(i=0;i<32;++i){s[i]=c[i]}for(i=0;i<32;++i){for(n=0;n<32;n++){s[i+n]+=p[i]*u[n]}}modL(e.subarray(32),s);return l}function crypto_sign_open(e,t,r,a){var i,n;var s=new l(32);var o=[gf(),gf(),gf(),gf()],u=[gf(),gf(),gf(),gf()];n=-1;if(r<64){return-1}if(unpackneg(u,a)){return-1}for(i=0;i<r;++i){e[i]=t[i]}for(i=0;i<32;++i){e[i+32]=a[i]}var c=sha512(e,r);reduce(c);scalarmult(o,u,c);scalarbase(u,t.subarray(32));add(o,u);pack(s,o);r-=64;if(crypto_verify_32(t,0,s,0)){for(i=0;i<r;++i){e[i]=0}return-1}for(i=0;i<r;++i){e[i]=t[i+64]}n=r;return n}function modL(e,t){var r,a,i,n;for(a=63;a>=32;--a){r=0;for(i=a-32,n=a-12;i<n;++i){t[i]+=r-16*t[a]*m[i-(a-32)];r=t[i]+128>>8;t[i]-=r*256}t[i]+=r;t[a]=0}r=0;for(i=0;i<32;++i){t[i]+=r-(t[31]>>4)*m[i];r=t[i]>>8;t[i]&=255}for(i=0;i<32;++i){t[i]-=r*m[i]}for(a=0;a<32;++a){t[a+1]+=t[a]>>8;e[a]=t[a]&255}}function reduce(e){var t=new Float64Array(64);for(var r=0;r<64;++r){t[r]=e[r];e[r]=0}modL(e,t)}function add(e,t){var r=gf(),a=gf(),i=gf(),n=gf(),s=gf(),o=gf(),u=gf(),l=gf(),c=gf();Z(r,e[1],e[0]);Z(c,t[1],t[0]);M(r,r,c);A(a,e[0],e[1]);A(c,t[0],t[1]);M(a,a,c);M(i,e[3],t[3]);M(i,i,g);M(n,e[2],t[2]);A(n,n,n);Z(s,a,r);Z(o,n,i);A(u,n,i);A(l,a,r);M(e[0],s,o);M(e[1],l,u);M(e[2],u,o);M(e[3],s,l)}function cswap(e,t,r){for(var a=0;a<4;++a){sel25519(e[a],t[a],r)}}function pack(e,t){var r=gf(),a=gf(),i=gf();inv25519(i,t[2]);M(r,t[0],i);M(a,t[1],i);pack25519(e,a);e[31]^=par25519(r)<<7}function pack25519(e,t){var r,a,i;var n=gf(),s=gf();for(r=0;r<16;++r){s[r]=t[r]}car25519(s);car25519(s);car25519(s);for(a=0;a<2;++a){n[0]=s[0]-65517;for(r=1;r<15;++r){n[r]=s[r]-65535-(n[r-1]>>16&1);n[r-1]&=65535}n[15]=s[15]-32767-(n[14]>>16&1);i=n[15]>>16&1;n[14]&=65535;sel25519(s,n,1-i)}for(r=0;r<16;r++){e[2*r]=s[r]&255;e[2*r+1]=s[r]>>8}}function unpackneg(e,t){var r=gf(),a=gf(),i=gf(),n=gf(),s=gf(),o=gf(),u=gf();set25519(e[2],h);unpack25519(e[1],t);S(i,e[1]);M(n,i,d);Z(i,i,e[2]);A(n,e[2],n);S(s,n);S(o,s);M(u,o,s);M(r,u,i);M(r,r,n);pow2523(r,r);M(r,r,i);M(r,r,n);M(r,r,n);M(e[0],r,n);S(a,e[0]);M(a,a,n);if(neq25519(a,i)){M(e[0],e[0],C)}S(a,e[0]);M(a,a,n);if(neq25519(a,i)){return-1}if(par25519(e[0])===t[31]>>7){Z(e[0],p,e[0])}M(e[3],e[0],e[1]);return 0}function unpack25519(e,t){var r;for(r=0;r<16;++r){e[r]=t[2*r]+(t[2*r+1]<<8)}e[15]&=32767}function pow2523(e,t){var r=gf();var a;for(a=0;a<16;++a){r[a]=t[a]}for(a=250;a>=0;--a){S(r,r);if(a!==1){M(r,r,t)}}for(a=0;a<16;++a){e[a]=r[a]}}function neq25519(e,t){var r=new l(32);var a=new l(32);pack25519(r,e);pack25519(a,t);return crypto_verify_32(r,0,a,0)}function crypto_verify_32(e,t,r,a){return vn(e,t,r,a,32)}function vn(e,t,r,a,i){var n,s=0;for(n=0;n<i;++n){s|=e[t+n]^r[a+n]}return(1&s-1>>>8)-1}function par25519(e){var t=new l(32);pack25519(t,e);return t[0]&1}function scalarmult(e,t,r){var a,i;set25519(e[0],p);set25519(e[1],h);set25519(e[2],h);set25519(e[3],p);for(i=255;i>=0;--i){a=r[i/8|0]>>(i&7)&1;cswap(e,t,a);add(t,e);add(e,e);cswap(e,t,a)}}function scalarbase(e,t){var r=[gf(),gf(),gf(),gf()];set25519(r[0],y);set25519(r[1],v);set25519(r[2],h);M(r[3],y,v);scalarmult(e,r,t)}function set25519(e,t){var r;for(r=0;r<16;r++){e[r]=t[r]|0}}function inv25519(e,t){var r=gf();var a;for(a=0;a<16;++a){r[a]=t[a]}for(a=253;a>=0;--a){S(r,r);if(a!==2&&a!==4){M(r,r,t)}}for(a=0;a<16;++a){e[a]=r[a]}}function car25519(e){var t,r,a=1;for(t=0;t<16;++t){r=e[t]+a+65535;a=Math.floor(r/65536);e[t]=r-a*65536}e[0]+=a-1+37*(a-1)}function sel25519(e,t,r){var a,i=~(r-1);for(var n=0;n<16;++n){a=i&(e[n]^t[n]);e[n]^=a;t[n]^=a}}function gf(e){var t,r=new Float64Array(16);if(e){for(t=0;t<e.length;++t){r[t]=e[t]}}return r}function A(e,t,r){for(var a=0;a<16;++a){e[a]=t[a]+r[a]}}function Z(e,t,r){for(var a=0;a<16;++a){e[a]=t[a]-r[a]}}function S(e,t){M(e,t,t)}function M(e,t,r){var a,i,n=0,s=0,o=0,u=0,l=0,c=0,p=0,h=0,d=0,g=0,y=0,v=0,m=0,C=0,E=0,I=0,T=0,b=0,B=0,_=0,N=0,w=0,R=0,k=0,L=0,U=0,D=0,P=0,V=0,O=0,K=0,x=r[0],F=r[1],q=r[2],H=r[3],G=r[4],j=r[5],Q=r[6],z=r[7],Y=r[8],W=r[9],X=r[10],J=r[11],$=r[12],ee=r[13],te=r[14],re=r[15];a=t[0];n+=a*x;s+=a*F;o+=a*q;u+=a*H;l+=a*G;c+=a*j;p+=a*Q;h+=a*z;d+=a*Y;g+=a*W;y+=a*X;v+=a*J;m+=a*$;C+=a*ee;E+=a*te;I+=a*re;a=t[1];s+=a*x;o+=a*F;u+=a*q;l+=a*H;c+=a*G;p+=a*j;h+=a*Q;d+=a*z;g+=a*Y;y+=a*W;v+=a*X;m+=a*J;C+=a*$;E+=a*ee;I+=a*te;T+=a*re;a=t[2];o+=a*x;u+=a*F;l+=a*q;c+=a*H;p+=a*G;h+=a*j;d+=a*Q;g+=a*z;y+=a*Y;v+=a*W;m+=a*X;C+=a*J;E+=a*$;I+=a*ee;T+=a*te;b+=a*re;a=t[3];u+=a*x;l+=a*F;c+=a*q;p+=a*H;h+=a*G;d+=a*j;g+=a*Q;y+=a*z;v+=a*Y;m+=a*W;C+=a*X;E+=a*J;I+=a*$;T+=a*ee;b+=a*te;B+=a*re;a=t[4];l+=a*x;c+=a*F;p+=a*q;h+=a*H;d+=a*G;g+=a*j;y+=a*Q;v+=a*z;m+=a*Y;C+=a*W;E+=a*X;I+=a*J;T+=a*$;b+=a*ee;B+=a*te;_+=a*re;a=t[5];c+=a*x;p+=a*F;h+=a*q;d+=a*H;g+=a*G;y+=a*j;v+=a*Q;m+=a*z;C+=a*Y;E+=a*W;I+=a*X;T+=a*J;b+=a*$;B+=a*ee;_+=a*te;N+=a*re;a=t[6];p+=a*x;h+=a*F;d+=a*q;g+=a*H;y+=a*G;v+=a*j;m+=a*Q;C+=a*z;E+=a*Y;I+=a*W;T+=a*X;b+=a*J;B+=a*$;_+=a*ee;N+=a*te;w+=a*re;a=t[7];h+=a*x;d+=a*F;g+=a*q;y+=a*H;v+=a*G;m+=a*j;C+=a*Q;E+=a*z;I+=a*Y;T+=a*W;b+=a*X;B+=a*J;_+=a*$;N+=a*ee;w+=a*te;R+=a*re;a=t[8];d+=a*x;g+=a*F;y+=a*q;v+=a*H;m+=a*G;C+=a*j;E+=a*Q;I+=a*z;T+=a*Y;b+=a*W;B+=a*X;_+=a*J;N+=a*$;w+=a*ee;R+=a*te;k+=a*re;a=t[9];g+=a*x;y+=a*F;v+=a*q;m+=a*H;C+=a*G;E+=a*j;I+=a*Q;T+=a*z;b+=a*Y;B+=a*W;_+=a*X;N+=a*J;w+=a*$;R+=a*ee;k+=a*te;L+=a*re;a=t[10];y+=a*x;v+=a*F;m+=a*q;C+=a*H;E+=a*G;I+=a*j;T+=a*Q;b+=a*z;B+=a*Y;_+=a*W;N+=a*X;w+=a*J;R+=a*$;k+=a*ee;L+=a*te;U+=a*re;a=t[11];v+=a*x;m+=a*F;C+=a*q;E+=a*H;I+=a*G;T+=a*j;b+=a*Q;B+=a*z;_+=a*Y;N+=a*W;w+=a*X;R+=a*J;k+=a*$;L+=a*ee;U+=a*te;D+=a*re;a=t[12];m+=a*x;C+=a*F;E+=a*q;I+=a*H;T+=a*G;b+=a*j;B+=a*Q;_+=a*z;N+=a*Y;w+=a*W;R+=a*X;k+=a*J;L+=a*$;U+=a*ee;D+=a*te;P+=a*re;a=t[13];C+=a*x;E+=a*F;I+=a*q;T+=a*H;b+=a*G;B+=a*j;_+=a*Q;N+=a*z;w+=a*Y;R+=a*W;k+=a*X;L+=a*J;U+=a*$;D+=a*ee;P+=a*te;V+=a*re;a=t[14];E+=a*x;I+=a*F;T+=a*q;b+=a*H;B+=a*G;_+=a*j;N+=a*Q;w+=a*z;R+=a*Y;k+=a*W;L+=a*X;U+=a*J;D+=a*$;P+=a*ee;V+=a*te;O+=a*re;a=t[15];I+=a*x;T+=a*F;b+=a*q;B+=a*H;_+=a*G;N+=a*j;w+=a*Q;R+=a*z;k+=a*Y;L+=a*W;U+=a*X;D+=a*J;P+=a*$;V+=a*ee;O+=a*te;K+=a*re;n+=38*T;s+=38*b;o+=38*B;u+=38*_;l+=38*N;c+=38*w;p+=38*R;h+=38*k;d+=38*L;g+=38*U;y+=38*D;v+=38*P;m+=38*V;C+=38*O;E+=38*K;i=1;a=n+i+65535;i=Math.floor(a/65536);n=a-i*65536;a=s+i+65535;i=Math.floor(a/65536);s=a-i*65536;a=o+i+65535;i=Math.floor(a/65536);o=a-i*65536;a=u+i+65535;i=Math.floor(a/65536);u=a-i*65536;a=l+i+65535;i=Math.floor(a/65536);l=a-i*65536;a=c+i+65535;i=Math.floor(a/65536);c=a-i*65536;a=p+i+65535;i=Math.floor(a/65536);p=a-i*65536;a=h+i+65535;i=Math.floor(a/65536);h=a-i*65536;a=d+i+65535;i=Math.floor(a/65536);d=a-i*65536;a=g+i+65535;i=Math.floor(a/65536);g=a-i*65536;a=y+i+65535;i=Math.floor(a/65536);y=a-i*65536;a=v+i+65535;i=Math.floor(a/65536);v=a-i*65536;a=m+i+65535;i=Math.floor(a/65536);m=a-i*65536;a=C+i+65535;i=Math.floor(a/65536);C=a-i*65536;a=E+i+65535;i=Math.floor(a/65536);E=a-i*65536;a=I+i+65535;i=Math.floor(a/65536);I=a-i*65536;n+=i-1+37*(i-1);i=1;a=n+i+65535;i=Math.floor(a/65536);n=a-i*65536;a=s+i+65535;i=Math.floor(a/65536);s=a-i*65536;a=o+i+65535;i=Math.floor(a/65536);o=a-i*65536;a=u+i+65535;i=Math.floor(a/65536);u=a-i*65536;a=l+i+65535;i=Math.floor(a/65536);l=a-i*65536;a=c+i+65535;i=Math.floor(a/65536);c=a-i*65536;a=p+i+65535;i=Math.floor(a/65536);p=a-i*65536;a=h+i+65535;i=Math.floor(a/65536);h=a-i*65536;a=d+i+65535;i=Math.floor(a/65536);d=a-i*65536;a=g+i+65535;i=Math.floor(a/65536);g=a-i*65536;a=y+i+65535;i=Math.floor(a/65536);y=a-i*65536;a=v+i+65535;i=Math.floor(a/65536);v=a-i*65536;a=m+i+65535;i=Math.floor(a/65536);m=a-i*65536;a=C+i+65535;i=Math.floor(a/65536);C=a-i*65536;a=E+i+65535;i=Math.floor(a/65536);E=a-i*65536;a=I+i+65535;i=Math.floor(a/65536);I=a-i*65536;n+=i-1+37*(i-1);e[0]=n;e[1]=s;e[2]=o;e[3]=u;e[4]=l;e[5]=c;e[6]=p;e[7]=h;e[8]=d;e[9]=g;e[10]=y;e[11]=v;e[12]=m;e[13]=C;e[14]=E;e[15]=I}},809:function(e){e.exports={options:{usePureJavaScript:false}}},787:function(e,t,r){var a=r(809);r(5);r(362);var i=e.exports=a.hmac=a.hmac||{};i.create=function(){var e=null;var t=null;var r=null;var i=null;var n={};n.start=function(n,s){if(n!==null){if(typeof n==="string"){n=n.toLowerCase();if(n in a.md.algorithms){t=a.md.algorithms[n].create()}else{throw new Error('Unknown hash algorithm "'+n+'"')}}else{t=n}}if(s===null){s=e}else{if(typeof s==="string"){s=a.util.createBuffer(s)}else if(a.util.isArray(s)){var o=s;s=a.util.createBuffer();for(var u=0;u<o.length;++u){s.putByte(o[u])}}var l=s.length();if(l>t.blockLength){t.start();t.update(s.bytes());s=t.digest()}r=a.util.createBuffer();i=a.util.createBuffer();l=s.length();for(var u=0;u<l;++u){var o=s.at(u);r.putByte(54^o);i.putByte(92^o)}if(l<t.blockLength){var o=t.blockLength-l;for(var u=0;u<o;++u){r.putByte(54);i.putByte(92)}}e=s;r=r.bytes();i=i.bytes()}t.start();t.update(r)};n.update=function(e){t.update(e)};n.getMac=function(){var e=t.digest().bytes();t.start();t.update(i);t.update(e);return t.digest()};n.digest=n.getMac;return n}},386:function(e,t,r){e.exports=r(809);r(801);r(901);r(446);r(690);r(599);r(955);r(787);r(750);r(822);r(590);r(609);r(305);r(227);r(825);r(966);r(620);r(886);r(451);r(658);r(533);r(394);r(653);r(740);r(486);r(362)},319:function(e,t,r){var a=r(809);e.exports=a.jsbn=a.jsbn||{};var i;var n=0xdeadbeefcafe;var s=(n&16777215)==15715070;function BigInteger(e,t,r){this.data=[];if(e!=null)if("number"==typeof e)this.fromNumber(e,t,r);else if(t==null&&"string"!=typeof e)this.fromString(e,256);else this.fromString(e,t)}a.jsbn.BigInteger=BigInteger;function nbi(){return new BigInteger(null)}function am1(e,t,r,a,i,n){while(--n>=0){var s=t*this.data[e++]+r.data[a]+i;i=Math.floor(s/67108864);r.data[a++]=s&67108863}return i}function am2(e,t,r,a,i,n){var s=t&32767,o=t>>15;while(--n>=0){var u=this.data[e]&32767;var l=this.data[e++]>>15;var c=o*u+l*s;u=s*u+((c&32767)<<15)+r.data[a]+(i&1073741823);i=(u>>>30)+(c>>>15)+o*l+(i>>>30);r.data[a++]=u&1073741823}return i}function am3(e,t,r,a,i,n){var s=t&16383,o=t>>14;while(--n>=0){var u=this.data[e]&16383;var l=this.data[e++]>>14;var c=o*u+l*s;u=s*u+((c&16383)<<14)+r.data[a]+i;i=(u>>28)+(c>>14)+o*l;r.data[a++]=u&268435455}return i}if(typeof navigator==="undefined"){BigInteger.prototype.am=am3;i=28}else if(s&&navigator.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;i=30}else if(s&&navigator.appName!="Netscape"){BigInteger.prototype.am=am1;i=26}else{BigInteger.prototype.am=am3;i=28}BigInteger.prototype.DB=i;BigInteger.prototype.DM=(1<<i)-1;BigInteger.prototype.DV=1<<i;var o=52;BigInteger.prototype.FV=Math.pow(2,o);BigInteger.prototype.F1=o-i;BigInteger.prototype.F2=2*i-o;var u="0123456789abcdefghijklmnopqrstuvwxyz";var l=new Array;var c,p;c="0".charCodeAt(0);for(p=0;p<=9;++p)l[c++]=p;c="a".charCodeAt(0);for(p=10;p<36;++p)l[c++]=p;c="A".charCodeAt(0);for(p=10;p<36;++p)l[c++]=p;function int2char(e){return u.charAt(e)}function intAt(e,t){var r=l[e.charCodeAt(t)];return r==null?-1:r}function bnpCopyTo(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t;e.s=this.s}function bnpFromInt(e){this.t=1;this.s=e<0?-1:0;if(e>0)this.data[0]=e;else if(e<-1)this.data[0]=e+this.DV;else this.t=0}function nbv(e){var t=nbi();t.fromInt(e);return t}function bnpFromString(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0;this.s=0;var a=e.length,i=false,n=0;while(--a>=0){var s=r==8?e[a]&255:intAt(e,a);if(s<0){if(e.charAt(a)=="-")i=true;continue}i=false;if(n==0)this.data[this.t++]=s;else if(n+r>this.DB){this.data[this.t-1]|=(s&(1<<this.DB-n)-1)<<n;this.data[this.t++]=s>>this.DB-n}else this.data[this.t-1]|=s<<n;n+=r;if(n>=this.DB)n-=this.DB}if(r==8&&(e[0]&128)!=0){this.s=-1;if(n>0)this.data[this.t-1]|=(1<<this.DB-n)-1<<n}this.clamp();if(i)BigInteger.ZERO.subTo(this,this)}function bnpClamp(){var e=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==e)--this.t}function bnToString(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,a,i=false,n="",s=this.t;var o=this.DB-s*this.DB%t;if(s-- >0){if(o<this.DB&&(a=this.data[s]>>o)>0){i=true;n=int2char(a)}while(s>=0){if(o<t){a=(this.data[s]&(1<<o)-1)<<t-o;a|=this.data[--s]>>(o+=this.DB-t)}else{a=this.data[s]>>(o-=t)&r;if(o<=0){o+=this.DB;--s}}if(a>0)i=true;if(i)n+=int2char(a)}}return i?n:"0"}function bnNegate(){var e=nbi();BigInteger.ZERO.subTo(this,e);return e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;t=r-e.t;if(t!=0)return this.s<0?-t:t;while(--r>=0)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function nbits(e){var t=1,r;if((r=e>>>16)!=0){e=r;t+=16}if((r=e>>8)!=0){e=r;t+=8}if((r=e>>4)!=0){e=r;t+=4}if((r=e>>2)!=0){e=r;t+=2}if((r=e>>1)!=0){e=r;t+=1}return t}function bnBitLength(){if(this.t<=0)return 0;return this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e;t.s=this.s}function bnpDRShiftTo(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0);t.s=this.s}function bnpLShiftTo(e,t){var r=e%this.DB;var a=this.DB-r;var i=(1<<a)-1;var n=Math.floor(e/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o){t.data[o+n+1]=this.data[o]>>a|s;s=(this.data[o]&i)<<r}for(o=n-1;o>=0;--o)t.data[o]=0;t.data[n]=s;t.t=this.t+n+1;t.s=this.s;t.clamp()}function bnpRShiftTo(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var a=e%this.DB;var i=this.DB-a;var n=(1<<a)-1;t.data[0]=this.data[r]>>a;for(var s=r+1;s<this.t;++s){t.data[s-r-1]|=(this.data[s]&n)<<i;t.data[s-r]=this.data[s]>>a}if(a>0)t.data[this.t-r-1]|=(this.s&n)<<i;t.t=this.t-r;t.clamp()}function bnpSubTo(e,t){var r=0,a=0,i=Math.min(e.t,this.t);while(r<i){a+=this.data[r]-e.data[r];t.data[r++]=a&this.DM;a>>=this.DB}if(e.t<this.t){a-=e.s;while(r<this.t){a+=this.data[r];t.data[r++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(r<e.t){a-=e.data[r];t.data[r++]=a&this.DM;a>>=this.DB}a-=e.s}t.s=a<0?-1:0;if(a<-1)t.data[r++]=this.DV+a;else if(a>0)t.data[r++]=a;t.t=r;t.clamp()}function bnpMultiplyTo(e,t){var r=this.abs(),a=e.abs();var i=r.t;t.t=i+a.t;while(--i>=0)t.data[i]=0;for(i=0;i<a.t;++i)t.data[i+r.t]=r.am(0,a.data[i],t,i,0,r.t);t.s=0;t.clamp();if(this.s!=e.s)BigInteger.ZERO.subTo(t,t)}function bnpSquareTo(e){var t=this.abs();var r=e.t=2*t.t;while(--r>=0)e.data[r]=0;for(r=0;r<t.t-1;++r){var a=t.am(r,t.data[r],e,2*r,0,1);if((e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,a,t.t-r-1))>=t.DV){e.data[r+t.t]-=t.DV;e.data[r+t.t+1]=1}}if(e.t>0)e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1);e.s=0;e.clamp()}function bnpDivRemTo(e,t,r){var a=e.abs();if(a.t<=0)return;var i=this.abs();if(i.t<a.t){if(t!=null)t.fromInt(0);if(r!=null)this.copyTo(r);return}if(r==null)r=nbi();var n=nbi(),s=this.s,o=e.s;var u=this.DB-nbits(a.data[a.t-1]);if(u>0){a.lShiftTo(u,n);i.lShiftTo(u,r)}else{a.copyTo(n);i.copyTo(r)}var l=n.t;var c=n.data[l-1];if(c==0)return;var p=c*(1<<this.F1)+(l>1?n.data[l-2]>>this.F2:0);var h=this.FV/p,d=(1<<this.F1)/p,g=1<<this.F2;var y=r.t,v=y-l,m=t==null?nbi():t;n.dlShiftTo(v,m);if(r.compareTo(m)>=0){r.data[r.t++]=1;r.subTo(m,r)}BigInteger.ONE.dlShiftTo(l,m);m.subTo(n,n);while(n.t<l)n.data[n.t++]=0;while(--v>=0){var C=r.data[--y]==c?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+g)*d);if((r.data[y]+=n.am(0,C,r,v,0,l))<C){n.dlShiftTo(v,m);r.subTo(m,r);while(r.data[y]<--C)r.subTo(m,r)}}if(t!=null){r.drShiftTo(l,t);if(s!=o)BigInteger.ZERO.subTo(t,t)}r.t=l;r.clamp();if(u>0)r.rShiftTo(u,r);if(s<0)BigInteger.ZERO.subTo(r,r)}function bnMod(e){var t=nbi();this.abs().divRemTo(e,null,t);if(this.s<0&&t.compareTo(BigInteger.ZERO)>0)e.subTo(t,t);return t}function Classic(e){this.m=e}function cConvert(e){if(e.s<0||e.compareTo(this.m)>=0)return e.mod(this.m);else return e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}function cSqrTo(e,t){e.squareTo(t);this.reduce(t)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;t=t*(2-(e&15)*t)&15;t=t*(2-(e&255)*t)&255;t=t*(2-((e&65535)*t&65535))&65535;t=t*(2-e*t%this.DV)%this.DV;return t>0?this.DV-t:-t}function Montgomery(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function montConvert(e){var t=nbi();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);if(e.s<0&&t.compareTo(BigInteger.ZERO)>0)this.m.subTo(t,t);return t}function montRevert(e){var t=nbi();e.copyTo(t);this.reduce(t);return t}function montReduce(e){while(e.t<=this.mt2)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767;var a=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;r=t+this.m.t;e.data[r]+=this.m.am(0,a,e,t,0,this.m.t);while(e.data[r]>=e.DV){e.data[r]-=e.DV;e.data[++r]++}}e.clamp();e.drShiftTo(this.m.t,e);if(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function montSqrTo(e,t){e.squareTo(t);this.reduce(t)}function montMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(e,t){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),a=nbi(),i=t.convert(this),n=nbits(e)-1;i.copyTo(r);while(--n>=0){t.sqrTo(r,a);if((e&1<<n)>0)t.mulTo(a,i,r);else{var s=r;r=a;a=s}}return t.revert(r)}function bnModPowInt(e,t){var r;if(e<256||t.isEven())r=new Classic(t);else r=new Montgomery(t);return this.exp(e,r)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var e=nbi();this.copyTo(e);return e}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this.data[0];else if(this.t==0)return 0;return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bnSigNum(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this.data[0]<=0)return 0;else return 1}function bnpToRadix(e){if(e==null)e=10;if(this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e);var r=Math.pow(e,t);var a=nbv(r),i=nbi(),n=nbi(),s="";this.divRemTo(a,i,n);while(i.signum()>0){s=(r+n.intValue()).toString(e).substr(1)+s;i.divRemTo(a,i,n)}return n.intValue().toString(e)+s}function bnpFromRadix(e,t){this.fromInt(0);if(t==null)t=10;var r=this.chunkSize(t);var a=Math.pow(t,r),i=false,n=0,s=0;for(var o=0;o<e.length;++o){var u=intAt(e,o);if(u<0){if(e.charAt(o)=="-"&&this.signum()==0)i=true;continue}s=t*s+u;if(++n>=r){this.dMultiply(a);this.dAddOffset(s,0);n=0;s=0}}if(n>0){this.dMultiply(Math.pow(t,n));this.dAddOffset(s,0)}if(i)BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,t,r){if("number"==typeof t){if(e<2)this.fromInt(1);else{this.fromNumber(e,r);if(!this.testBit(e-1))this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(t)){this.dAddOffset(2,0);if(this.bitLength()>e)this.subTo(BigInteger.ONE.shiftLeft(e-1),this)}}}else{var a=new Array,i=e&7;a.length=(e>>3)+1;t.nextBytes(a);if(i>0)a[0]&=(1<<i)-1;else a[0]=0;this.fromString(a,256)}}function bnToByteArray(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,a,i=0;if(e-- >0){if(r<this.DB&&(a=this.data[e]>>r)!=(this.s&this.DM)>>r)t[i++]=a|this.s<<this.DB-r;while(e>=0){if(r<8){a=(this.data[e]&(1<<r)-1)<<8-r;a|=this.data[--e]>>(r+=this.DB-8)}else{a=this.data[e]>>(r-=8)&255;if(r<=0){r+=this.DB;--e}}if((a&128)!=0)a|=-256;if(i==0&&(this.s&128)!=(a&128))++i;if(i>0||a!=this.s)t[i++]=a}}return t}function bnEquals(e){return this.compareTo(e)==0}function bnMin(e){return this.compareTo(e)<0?this:e}function bnMax(e){return this.compareTo(e)>0?this:e}function bnpBitwiseTo(e,t,r){var a,i,n=Math.min(e.t,this.t);for(a=0;a<n;++a)r.data[a]=t(this.data[a],e.data[a]);if(e.t<this.t){i=e.s&this.DM;for(a=n;a<this.t;++a)r.data[a]=t(this.data[a],i);r.t=this.t}else{i=this.s&this.DM;for(a=n;a<e.t;++a)r.data[a]=t(i,e.data[a]);r.t=e.t}r.s=t(this.s,e.s);r.clamp()}function op_and(e,t){return e&t}function bnAnd(e){var t=nbi();this.bitwiseTo(e,op_and,t);return t}function op_or(e,t){return e|t}function bnOr(e){var t=nbi();this.bitwiseTo(e,op_or,t);return t}function op_xor(e,t){return e^t}function bnXor(e){var t=nbi();this.bitwiseTo(e,op_xor,t);return t}function op_andnot(e,t){return e&~t}function bnAndNot(e){var t=nbi();this.bitwiseTo(e,op_andnot,t);return t}function bnNot(){var e=nbi();for(var t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];e.t=this.t;e.s=~this.s;return e}function bnShiftLeft(e){var t=nbi();if(e<0)this.rShiftTo(-e,t);else this.lShiftTo(e,t);return t}function bnShiftRight(e){var t=nbi();if(e<0)this.lShiftTo(-e,t);else this.rShiftTo(e,t);return t}function lbit(e){if(e==0)return-1;var t=0;if((e&65535)==0){e>>=16;t+=16}if((e&255)==0){e>>=8;t+=8}if((e&15)==0){e>>=4;t+=4}if((e&3)==0){e>>=2;t+=2}if((e&1)==0)++t;return t}function bnGetLowestSetBit(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+lbit(this.data[e]);if(this.s<0)return this.t*this.DB;return-1}function cbit(e){var t=0;while(e!=0){e&=e-1;++t}return t}function bnBitCount(){var e=0,t=this.s&this.DM;for(var r=0;r<this.t;++r)e+=cbit(this.data[r]^t);return e}function bnTestBit(e){var t=Math.floor(e/this.DB);if(t>=this.t)return this.s!=0;return(this.data[t]&1<<e%this.DB)!=0}function bnpChangeBit(e,t){var r=BigInteger.ONE.shiftLeft(e);this.bitwiseTo(r,t,r);return r}function bnSetBit(e){return this.changeBit(e,op_or)}function bnClearBit(e){return this.changeBit(e,op_andnot)}function bnFlipBit(e){return this.changeBit(e,op_xor)}function bnpAddTo(e,t){var r=0,a=0,i=Math.min(e.t,this.t);while(r<i){a+=this.data[r]+e.data[r];t.data[r++]=a&this.DM;a>>=this.DB}if(e.t<this.t){a+=e.s;while(r<this.t){a+=this.data[r];t.data[r++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(r<e.t){a+=e.data[r];t.data[r++]=a&this.DM;a>>=this.DB}a+=e.s}t.s=a<0?-1:0;if(a>0)t.data[r++]=a;else if(a<-1)t.data[r++]=this.DV+a;t.t=r;t.clamp()}function bnAdd(e){var t=nbi();this.addTo(e,t);return t}function bnSubtract(e){var t=nbi();this.subTo(e,t);return t}function bnMultiply(e){var t=nbi();this.multiplyTo(e,t);return t}function bnDivide(e){var t=nbi();this.divRemTo(e,t,null);return t}function bnRemainder(e){var t=nbi();this.divRemTo(e,null,t);return t}function bnDivideAndRemainder(e){var t=nbi(),r=nbi();this.divRemTo(e,t,r);return new Array(t,r)}function bnpDMultiply(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(e,t){if(e==0)return;while(this.t<=t)this.data[this.t++]=0;this.data[t]+=e;while(this.data[t]>=this.DV){this.data[t]-=this.DV;if(++t>=this.t)this.data[this.t++]=0;++this.data[t]}}function NullExp(){}function nNop(e){return e}function nMulTo(e,t,r){e.multiplyTo(t,r)}function nSqrTo(e,t){e.squareTo(t)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(e,t,r){var a=Math.min(this.t+e.t,t);r.s=0;r.t=a;while(a>0)r.data[--a]=0;var i;for(i=r.t-this.t;a<i;++a)r.data[a+this.t]=this.am(0,e.data[a],r,a,0,this.t);for(i=Math.min(e.t,t);a<i;++a)this.am(0,e.data[a],r,a,0,t-a);r.clamp()}function bnpMultiplyUpperTo(e,t,r){--t;var a=r.t=this.t+e.t-t;r.s=0;while(--a>=0)r.data[a]=0;for(a=Math.max(t-this.t,0);a<e.t;++a)r.data[this.t+a-t]=this.am(t-a,e.data[a],r,0,0,this.t+a-t);r.clamp();r.drShiftTo(1,r)}function Barrett(e){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}function barrettConvert(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);else if(e.compareTo(this.m)<0)return e;else{var t=nbi();e.copyTo(t);this.reduce(t);return t}}function barrettRevert(e){return e}function barrettReduce(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function barrettSqrTo(e,t){e.squareTo(t);this.reduce(t)}function barrettMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(e,t){var r=e.bitLength(),a,i=nbv(1),n;if(r<=0)return i;else if(r<18)a=1;else if(r<48)a=3;else if(r<144)a=4;else if(r<768)a=5;else a=6;if(r<8)n=new Classic(t);else if(t.isEven())n=new Barrett(t);else n=new Montgomery(t);var s=new Array,o=3,u=a-1,l=(1<<a)-1;s[1]=n.convert(this);if(a>1){var c=nbi();n.sqrTo(s[1],c);while(o<=l){s[o]=nbi();n.mulTo(c,s[o-2],s[o]);o+=2}}var p=e.t-1,h,d=true,g=nbi(),y;r=nbits(e.data[p])-1;while(p>=0){if(r>=u)h=e.data[p]>>r-u&l;else{h=(e.data[p]&(1<<r+1)-1)<<u-r;if(p>0)h|=e.data[p-1]>>this.DB+r-u}o=a;while((h&1)==0){h>>=1;--o}if((r-=o)<0){r+=this.DB;--p}if(d){s[h].copyTo(i);d=false}else{while(o>1){n.sqrTo(i,g);n.sqrTo(g,i);o-=2}if(o>0)n.sqrTo(i,g);else{y=i;i=g;g=y}n.mulTo(g,s[h],i)}while(p>=0&&(e.data[p]&1<<r)==0){n.sqrTo(i,g);y=i;i=g;g=y;if(--r<0){r=this.DB-1;--p}}}return n.revert(i)}function bnGCD(e){var t=this.s<0?this.negate():this.clone();var r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var a=t;t=r;r=a}var i=t.getLowestSetBit(),n=r.getLowestSetBit();if(n<0)return t;if(i<n)n=i;if(n>0){t.rShiftTo(n,t);r.rShiftTo(n,r)}while(t.signum()>0){if((i=t.getLowestSetBit())>0)t.rShiftTo(i,t);if((i=r.getLowestSetBit())>0)r.rShiftTo(i,r);if(t.compareTo(r)>=0){t.subTo(r,t);t.rShiftTo(1,t)}else{r.subTo(t,r);r.rShiftTo(1,r)}}if(n>0)r.lShiftTo(n,r);return r}function bnpModInt(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var a=this.t-1;a>=0;--a)r=(t*r+this.data[a])%e;return r}function bnModInverse(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return BigInteger.ZERO;var r=e.clone(),a=this.clone();var i=nbv(1),n=nbv(0),s=nbv(0),o=nbv(1);while(r.signum()!=0){while(r.isEven()){r.rShiftTo(1,r);if(t){if(!i.isEven()||!n.isEven()){i.addTo(this,i);n.subTo(e,n)}i.rShiftTo(1,i)}else if(!n.isEven())n.subTo(e,n);n.rShiftTo(1,n)}while(a.isEven()){a.rShiftTo(1,a);if(t){if(!s.isEven()||!o.isEven()){s.addTo(this,s);o.subTo(e,o)}s.rShiftTo(1,s)}else if(!o.isEven())o.subTo(e,o);o.rShiftTo(1,o)}if(r.compareTo(a)>=0){r.subTo(a,r);if(t)i.subTo(s,i);n.subTo(o,n)}else{a.subTo(r,a);if(t)s.subTo(i,s);o.subTo(n,o)}}if(a.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;if(o.signum()<0)return o.add(e);else return o}var h=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var d=(1<<26)/h[h.length-1];function bnIsProbablePrime(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=h[h.length-1]){for(t=0;t<h.length;++t)if(r.data[0]==h[t])return true;return false}if(r.isEven())return false;t=1;while(t<h.length){var a=h[t],i=t+1;while(i<h.length&&a<d)a*=h[i++];a=r.modInt(a);while(t<i)if(a%h[t++]==0)return false}return r.millerRabin(e)}function bnpMillerRabin(e){var t=this.subtract(BigInteger.ONE);var r=t.getLowestSetBit();if(r<=0)return false;var a=t.shiftRight(r);var i=bnGetPrng();var n;for(var s=0;s<e;++s){do{n=new BigInteger(this.bitLength(),i)}while(n.compareTo(BigInteger.ONE)<=0||n.compareTo(t)>=0);var o=n.modPow(a,this);if(o.compareTo(BigInteger.ONE)!=0&&o.compareTo(t)!=0){var u=1;while(u++<r&&o.compareTo(t)!=0){o=o.modPowInt(2,this);if(o.compareTo(BigInteger.ONE)==0)return false}if(o.compareTo(t)!=0)return false}}return true}function bnGetPrng(){return{nextBytes:function(e){for(var t=0;t<e.length;++t){e[t]=Math.floor(Math.random()*256)}}}}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime},750:function(e,t,r){var a=r(809);r(362);r(394);r(319);e.exports=a.kem=a.kem||{};var i=a.jsbn.BigInteger;a.kem.rsa={};a.kem.rsa.create=function(e,t){t=t||{};var r=t.prng||a.random;var n={};n.encrypt=function(t,n){var s=Math.ceil(t.n.bitLength()/8);var o;do{o=new i(a.util.bytesToHex(r.getBytesSync(s)),16).mod(t.n)}while(o.compareTo(i.ONE)<=0);o=a.util.hexToBytes(o.toString(16));var u=s-o.length;if(u>0){o=a.util.fillString(String.fromCharCode(0),u)+o}var l=t.encrypt(o,"NONE");var c=e.generate(o,n);return{encapsulation:l,key:c}};n.decrypt=function(t,r,a){var i=t.decrypt(r,"NONE");return e.generate(i,a)};return n};a.kem.kdf1=function(e,t){_createKDF(this,e,0,t||e.digestLength)};a.kem.kdf2=function(e,t){_createKDF(this,e,1,t||e.digestLength)};function _createKDF(e,t,r,i){e.generate=function(e,n){var s=new a.util.ByteBuffer;var o=Math.ceil(n/i)+r;var u=new a.util.ByteBuffer;for(var l=r;l<o;++l){u.putInt32(l);t.start();t.update(e+u.getBytes());var c=t.digest();s.putBytes(c.getBytes(i))}s.truncate(s.length()-n);return s.getBytes()}}},822:function(e,t,r){var a=r(809);r(362);e.exports=a.log=a.log||{};a.log.levels=["none","error","warning","info","debug","verbose","max"];var i={};var n=[];var s=null;a.log.LEVEL_LOCKED=1<<1;a.log.NO_LEVEL_CHECK=1<<2;a.log.INTERPOLATE=1<<3;for(var o=0;o<a.log.levels.length;++o){var u=a.log.levels[o];i[u]={index:o,name:u.toUpperCase()}}a.log.logMessage=function(e){var t=i[e.level].index;for(var r=0;r<n.length;++r){var s=n[r];if(s.flags&a.log.NO_LEVEL_CHECK){s.f(e)}else{var o=i[s.level].index;if(t<=o){s.f(s,e)}}}};a.log.prepareStandard=function(e){if(!("standard"in e)){e.standard=i[e.level].name+" ["+e.category+"] "+e.message}};a.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||0);e.full=a.util.format.apply(this,t)}};a.log.prepareStandardFull=function(e){if(!("standardFull"in e)){a.log.prepareStandard(e);e.standardFull=e.standard}};if(true){var l=["error","warning","info","debug","verbose"];for(var o=0;o<l.length;++o){(function(e){a.log[e]=function(t,r){var i=Array.prototype.slice.call(arguments).slice(2);var n={timestamp:new Date,level:e,category:t,message:r,arguments:i};a.log.logMessage(n)}})(l[o])}}a.log.makeLogger=function(e){var t={flags:0,f:e};a.log.setLevel(t,"none");return t};a.log.setLevel=function(e,t){var r=false;if(e&&!(e.flags&a.log.LEVEL_LOCKED)){for(var i=0;i<a.log.levels.length;++i){var n=a.log.levels[i];if(t==n){e.level=t;r=true;break}}}return r};a.log.lock=function(e,t){if(typeof t==="undefined"||t){e.flags|=a.log.LEVEL_LOCKED}else{e.flags&=~a.log.LEVEL_LOCKED}};a.log.addLogger=function(e){n.push(e)};if(typeof console!=="undefined"&&"log"in console){var c;if(console.error&&console.warn&&console.info&&console.debug){var p={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug};var f=function(e,t){a.log.prepareStandard(t);var r=p[t.level];var i=[t.standard];i=i.concat(t["arguments"].slice());r.apply(console,i)};c=a.log.makeLogger(f)}else{var f=function(e,t){a.log.prepareStandardFull(t);console.log(t.standardFull)};c=a.log.makeLogger(f)}a.log.setLevel(c,"debug");a.log.addLogger(c);s=c}else{console={log:function(){}}}if(s!==null&&typeof window!=="undefined"&&window.location){var h=new URL(window.location.href).searchParams;if(h.has("console.level")){a.log.setLevel(s,h.get("console.level").slice(-1)[0])}if(h.has("console.lock")){var d=h.get("console.lock").slice(-1)[0];if(d=="true"){a.log.lock(s)}}}a.log.consoleLogger=s},590:function(e,t,r){e.exports=r(5);r(212);r(241);r(358);r(189)},5:function(e,t,r){var a=r(809);e.exports=a.md=a.md||{};a.md.algorithms=a.md.algorithms||{}},212:function(e,t,r){var a=r(809);r(5);r(362);var i=e.exports=a.md5=a.md5||{};a.md.md5=a.md.algorithms.md5=i;i.create=function(){if(!l){_init()}var e=null;var t=a.util.createBuffer();var r=new Array(16);var i={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};i.start=function(){i.messageLength=0;i.fullMessageLength=i.messageLength64=[];var r=i.messageLengthSize/4;for(var n=0;n<r;++n){i.fullMessageLength.push(0)}t=a.util.createBuffer();e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878};return i};i.start();i.update=function(n,s){if(s==="utf8"){n=a.util.encodeUtf8(n)}var o=n.length;i.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u){i.fullMessageLength[u]+=o[1];o[1]=o[0]+(i.fullMessageLength[u]/4294967296>>>0);i.fullMessageLength[u]=i.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(n);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return i};i.digest=function(){var s=a.util.createBuffer();s.putBytes(t.bytes());var o=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize;var u=o&i.blockLength-1;s.putBytes(n.substr(0,i.blockLength-u));var l,c=0;for(var p=i.fullMessageLength.length-1;p>=0;--p){l=i.fullMessageLength[p]*8+c;c=l/4294967296>>>0;s.putInt32Le(l>>>0)}var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};_update(h,r,s);var d=a.util.createBuffer();d.putInt32Le(h.h0);d.putInt32Le(h.h1);d.putInt32Le(h.h2);d.putInt32Le(h.h3);return d};return i};var n=null;var s=null;var o=null;var u=null;var l=false;function _init(){n=String.fromCharCode(128);n+=a.util.fillString(String.fromCharCode(0),64);s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];o=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];u=new Array(64);for(var e=0;e<64;++e){u[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296)}l=true}function _update(e,t,r){var a,i,n,l,c,p,h,d;var g=r.length();while(g>=64){i=e.h0;n=e.h1;l=e.h2;c=e.h3;for(d=0;d<16;++d){t[d]=r.getInt32Le();p=c^n&(l^c);a=i+p+u[d]+t[d];h=o[d];i=c;c=l;l=n;n+=a<<h|a>>>32-h}for(;d<32;++d){p=l^c&(n^l);a=i+p+u[d]+t[s[d]];h=o[d];i=c;c=l;l=n;n+=a<<h|a>>>32-h}for(;d<48;++d){p=n^l^c;a=i+p+u[d]+t[s[d]];h=o[d];i=c;c=l;l=n;n+=a<<h|a>>>32-h}for(;d<64;++d){p=l^(n|~c);a=i+p+u[d]+t[s[d]];h=o[d];i=c;c=l;l=n;n+=a<<h|a>>>32-h}e.h0=e.h0+i|0;e.h1=e.h1+n|0;e.h2=e.h2+l|0;e.h3=e.h3+c|0;g-=64}}},964:function(e,t,r){var a=r(809);r(609);e.exports=a.mgf=a.mgf||{};a.mgf.mgf1=a.mgf1},609:function(e,t,r){var a=r(809);r(362);a.mgf=a.mgf||{};var i=e.exports=a.mgf.mgf1=a.mgf1=a.mgf1||{};i.create=function(e){var t={generate:function(t,r){var i=new a.util.ByteBuffer;var n=Math.ceil(r/e.digestLength);for(var s=0;s<n;s++){var o=new a.util.ByteBuffer;o.putInt32(s);e.start();e.update(t+o.getBytes());i.putBuffer(e.digest())}i.truncate(i.length()-r);return i.getBytes()}};return t}},957:function(e,t,r){var a=r(809);a.pki=a.pki||{};var i=e.exports=a.pki.oids=a.oids=a.oids||{};function _IN(e,t){i[e]=t;i[t]=e}function _I_(e,t){i[e]=t}_IN("1.2.840.113549.1.1.1","rsaEncryption");_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption");_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_IN("1.2.840.113549.1.1.7","RSAES-OAEP");_IN("1.2.840.113549.1.1.8","mgf1");_IN("1.2.840.113549.1.1.9","pSpecified");_IN("1.2.840.113549.1.1.10","RSASSA-PSS");_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_IN("1.3.101.112","EdDSA25519");_IN("1.2.840.10040.4.3","dsa-with-sha1");_IN("1.3.14.3.2.7","desCBC");_IN("1.3.14.3.2.26","sha1");_IN("1.3.14.3.2.29","sha1WithRSASignature");_IN("2.16.840.1.101.3.4.2.1","sha256");_IN("2.16.840.1.101.3.4.2.2","sha384");_IN("2.16.840.1.101.3.4.2.3","sha512");_IN("2.16.840.1.101.3.4.2.4","sha224");_IN("2.16.840.1.101.3.4.2.5","sha512-224");_IN("2.16.840.1.101.3.4.2.6","sha512-256");_IN("1.2.840.113549.2.2","md2");_IN("1.2.840.113549.2.5","md5");_IN("1.2.840.113549.1.7.1","data");_IN("1.2.840.113549.1.7.2","signedData");_IN("1.2.840.113549.1.7.3","envelopedData");_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData");_IN("1.2.840.113549.1.7.5","digestedData");_IN("1.2.840.113549.1.7.6","encryptedData");_IN("1.2.840.113549.1.9.1","emailAddress");_IN("1.2.840.113549.1.9.2","unstructuredName");_IN("1.2.840.113549.1.9.3","contentType");_IN("1.2.840.113549.1.9.4","messageDigest");_IN("1.2.840.113549.1.9.5","signingTime");_IN("1.2.840.113549.1.9.6","counterSignature");_IN("1.2.840.113549.1.9.7","challengePassword");_IN("1.2.840.113549.1.9.8","unstructuredAddress");_IN("1.2.840.113549.1.9.14","extensionRequest");_IN("1.2.840.113549.1.9.20","friendlyName");_IN("1.2.840.113549.1.9.21","localKeyId");_IN("1.2.840.113549.1.9.22.1","x509Certificate");_IN("1.2.840.113549.1.12.10.1.1","keyBag");_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_IN("1.2.840.113549.1.12.10.1.3","certBag");_IN("1.2.840.113549.1.12.10.1.4","crlBag");_IN("1.2.840.113549.1.12.10.1.5","secretBag");_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag");_IN("1.2.840.113549.1.5.13","pkcs5PBES2");_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2");_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_IN("1.2.840.113549.2.7","hmacWithSHA1");_IN("1.2.840.113549.2.8","hmacWithSHA224");_IN("1.2.840.113549.2.9","hmacWithSHA256");_IN("1.2.840.113549.2.10","hmacWithSHA384");_IN("1.2.840.113549.2.11","hmacWithSHA512");_IN("1.2.840.113549.3.7","des-EDE3-CBC");_IN("2.16.840.1.101.3.4.1.2","aes128-CBC");_IN("2.16.840.1.101.3.4.1.22","aes192-CBC");_IN("2.16.840.1.101.3.4.1.42","aes256-CBC");_IN("2.5.4.3","commonName");_IN("2.5.4.4","surname");_IN("2.5.4.5","serialNumber");_IN("2.5.4.6","countryName");_IN("2.5.4.7","localityName");_IN("2.5.4.8","stateOrProvinceName");_IN("2.5.4.9","streetAddress");_IN("2.5.4.10","organizationName");_IN("2.5.4.11","organizationalUnitName");_IN("2.5.4.12","title");_IN("2.5.4.13","description");_IN("2.5.4.15","businessCategory");_IN("2.5.4.17","postalCode");_IN("2.5.4.42","givenName");_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_IN("2.16.840.1.113730.1.1","nsCertType");_IN("2.16.840.1.113730.1.13","nsComment");_I_("2.5.29.1","authorityKeyIdentifier");_I_("2.5.29.2","keyAttributes");_I_("2.5.29.3","certificatePolicies");_I_("2.5.29.4","keyUsageRestriction");_I_("2.5.29.5","policyMapping");_I_("2.5.29.6","subtreesConstraint");_I_("2.5.29.7","subjectAltName");_I_("2.5.29.8","issuerAltName");_I_("2.5.29.9","subjectDirectoryAttributes");_I_("2.5.29.10","basicConstraints");_I_("2.5.29.11","nameConstraints");_I_("2.5.29.12","policyConstraints");_I_("2.5.29.13","basicConstraints");_IN("2.5.29.14","subjectKeyIdentifier");_IN("2.5.29.15","keyUsage");_I_("2.5.29.16","privateKeyUsagePeriod");_IN("2.5.29.17","subjectAltName");_IN("2.5.29.18","issuerAltName");_IN("2.5.29.19","basicConstraints");_I_("2.5.29.20","cRLNumber");_I_("2.5.29.21","cRLReason");_I_("2.5.29.22","expirationDate");_I_("2.5.29.23","instructionCode");_I_("2.5.29.24","invalidityDate");_I_("2.5.29.25","cRLDistributionPoints");_I_("2.5.29.26","issuingDistributionPoint");_I_("2.5.29.27","deltaCRLIndicator");_I_("2.5.29.28","issuingDistributionPoint");_I_("2.5.29.29","certificateIssuer");_I_("2.5.29.30","nameConstraints");_IN("2.5.29.31","cRLDistributionPoints");_IN("2.5.29.32","certificatePolicies");_I_("2.5.29.33","policyMappings");_I_("2.5.29.34","policyConstraints");_IN("2.5.29.35","authorityKeyIdentifier");_I_("2.5.29.36","policyConstraints");_IN("2.5.29.37","extKeyUsage");_I_("2.5.29.46","freshestCRL");_I_("2.5.29.54","inhibitAnyPolicy");_IN("1.3.6.1.4.1.11129.2.4.2","timestampList");_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_IN("1.3.6.1.5.5.7.3.1","serverAuth");_IN("1.3.6.1.5.5.7.3.2","clientAuth");_IN("1.3.6.1.5.5.7.3.3","codeSigning");_IN("1.3.6.1.5.5.7.3.4","emailProtection");_IN("1.3.6.1.5.5.7.3.8","timeStamping")},243:function(e,t,r){var a=r(809);r(801);r(446);r(599);r(5);r(957);r(305);r(227);r(394);r(653);r(28);r(362);if(typeof i==="undefined"){var i=a.jsbn.BigInteger}var n=a.asn1;var s=a.pki=a.pki||{};e.exports=s.pbe=a.pbe=a.pbe||{};var o=s.oids;var u={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"encryptedData"}]};var l={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,optional:true,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,optional:true,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"encIv"}]}]};var c={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(e,t,r){r=r||{};r.saltSize=r.saltSize||8;r.count=r.count||2048;r.algorithm=r.algorithm||"aes128";r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=a.random.getBytesSync(r.saltSize);var u=r.count;var l=n.integerToDer(u);var c;var p;var h;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var d,g,y;switch(r.algorithm){case"aes128":c=16;d=16;g=o["aes128-CBC"];y=a.aes.createEncryptionCipher;break;case"aes192":c=24;d=16;g=o["aes192-CBC"];y=a.aes.createEncryptionCipher;break;case"aes256":c=32;d=16;g=o["aes256-CBC"];y=a.aes.createEncryptionCipher;break;case"des":c=8;d=8;g=o["desCBC"];y=a.des.createEncryptionCipher;break;default:var v=new Error("Cannot encrypt private key. Unknown encryption algorithm.");v.algorithm=r.algorithm;throw v}var m="hmacWith"+r.prfAlgorithm.toUpperCase();var C=prfAlgorithmToMessageDigest(m);var E=a.pkcs5.pbkdf2(t,i,u,c,C);var I=a.random.getBytesSync(d);var T=y(E);T.start(I);T.update(n.toDer(e));T.finish();h=T.output.getBytes();var b=createPbkdf2Params(i,l,c,m);p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(o["pkcs5PBES2"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(o["pkcs5PBKDF2"]).getBytes()),b]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(g).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,I)])])])}else if(r.algorithm==="3des"){c=24;var B=new a.util.ByteBuffer(i);var E=s.pbe.generatePkcs12Key(t,B,1,u,c);var I=s.pbe.generatePkcs12Key(t,B,2,u,c);var T=a.des.createEncryptionCipher(E);T.start(I);T.update(n.toDer(e));T.finish();h=T.output.getBytes();p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(o["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,i),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,l.getBytes())])])}else{var v=new Error("Cannot encrypt private key. Unknown encryption algorithm.");v.algorithm=r.algorithm;throw v}var _=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[p,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,h)]);return _};s.decryptPrivateKeyInfo=function(e,t){var r=null;var i={};var o=[];if(!n.validate(e,u,i,o)){var l=new Error("Cannot read encrypted private key. "+"ASN.1 object is not a supported EncryptedPrivateKeyInfo.");l.errors=o;throw l}var c=n.derToOid(i.encryptionOid);var p=s.pbe.getCipher(c,i.encryptionParams,t);var h=a.util.createBuffer(i.encryptedData);p.update(h);if(p.finish()){r=n.fromDer(p.output)}return r};s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(e).getBytes()};return a.pem.encode(r,{maxline:t})};s.encryptedPrivateKeyFromPem=function(e){var t=a.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error("Could not convert encrypted private key from PEM; "+'PEM header type is "ENCRYPTED PRIVATE KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert encrypted private key from PEM; "+"PEM is encrypted.")}return n.fromDer(t.body)};s.encryptRsaPrivateKey=function(e,t,r){r=r||{};if(!r.legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));i=s.encryptPrivateKeyInfo(i,t,r);return s.encryptedPrivateKeyToPem(i)}var o;var u;var l;var c;switch(r.algorithm){case"aes128":o="AES-128-CBC";l=16;u=a.random.getBytesSync(16);c=a.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC";l=24;u=a.random.getBytesSync(16);c=a.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC";l=32;u=a.random.getBytesSync(16);c=a.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC";l=24;u=a.random.getBytesSync(8);c=a.des.createEncryptionCipher;break;case"des":o="DES-CBC";l=8;u=a.random.getBytesSync(8);c=a.des.createEncryptionCipher;break;default:var p=new Error("Could not encrypt RSA private key; unsupported "+'encryption algorithm "'+r.algorithm+'".');p.algorithm=r.algorithm;throw p}var h=a.pbe.opensslDeriveBytes(t,u.substr(0,8),l);var d=c(h);d.start(u);d.update(n.toDer(s.privateKeyToAsn1(e)));d.finish();var g={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:a.util.bytesToHex(u).toUpperCase()},body:d.output.getBytes()};return a.pem.encode(g)};s.decryptRsaPrivateKey=function(e,t){var r=null;var i=a.pem.decode(e)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var o=new Error("Could not convert private key from PEM; PEM header type "+'is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');o.headerType=o;throw o}if(i.procType&&i.procType.type==="ENCRYPTED"){var u;var l;switch(i.dekInfo.algorithm){case"DES-CBC":u=8;l=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":u=24;l=a.des.createDecryptionCipher;break;case"AES-128-CBC":u=16;l=a.aes.createDecryptionCipher;break;case"AES-192-CBC":u=24;l=a.aes.createDecryptionCipher;break;case"AES-256-CBC":u=32;l=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":u=5;l=function(e){return a.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":u=8;l=function(e){return a.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":u=16;l=function(e){return a.rc2.createDecryptionCipher(e,128)};break;default:var o=new Error("Could not decrypt private key; unsupported "+'encryption algorithm "'+i.dekInfo.algorithm+'".');o.algorithm=i.dekInfo.algorithm;throw o}var c=a.util.hexToBytes(i.dekInfo.parameters);var p=a.pbe.opensslDeriveBytes(t,c.substr(0,8),u);var h=l(p);h.start(c);h.update(a.util.createBuffer(i.body));if(h.finish()){r=h.output.getBytes()}else{return r}}else{r=i.body}if(i.type==="ENCRYPTED PRIVATE KEY"){r=s.decryptPrivateKeyInfo(n.fromDer(r),t)}else{r=n.fromDer(r)}if(r!==null){r=s.privateKeyFromAsn1(r)}return r};s.pbe.generatePkcs12Key=function(e,t,r,i,n,s){var o,u;if(typeof s==="undefined"||s===null){if(!("sha1"in a.md)){throw new Error('"sha1" hash algorithm unavailable.')}s=a.md.sha1.create()}var l=s.digestLength;var c=s.blockLength;var p=new a.util.ByteBuffer;var h=new a.util.ByteBuffer;if(e!==null&&e!==undefined){for(u=0;u<e.length;u++){h.putInt16(e.charCodeAt(u))}h.putInt16(0)}var d=h.length();var g=t.length();var y=new a.util.ByteBuffer;y.fillWithByte(r,c);var v=c*Math.ceil(g/c);var m=new a.util.ByteBuffer;for(u=0;u<v;u++){m.putByte(t.at(u%g))}var C=c*Math.ceil(d/c);var E=new a.util.ByteBuffer;for(u=0;u<C;u++){E.putByte(h.at(u%d))}var I=m;I.putBuffer(E);var T=Math.ceil(n/l);for(var b=1;b<=T;b++){var B=new a.util.ByteBuffer;B.putBytes(y.bytes());B.putBytes(I.bytes());for(var _=0;_<i;_++){s.start();s.update(B.getBytes());B=s.digest()}var N=new a.util.ByteBuffer;for(u=0;u<c;u++){N.putByte(B.at(u%l))}var w=Math.ceil(g/c)+Math.ceil(d/c);var R=new a.util.ByteBuffer;for(o=0;o<w;o++){var k=new a.util.ByteBuffer(I.getBytes(c));var L=511;for(u=N.length()-1;u>=0;u--){L=L>>8;L+=N.at(u)+k.at(u);k.setAt(u,L&255)}R.putBuffer(k)}I=R;p.putBuffer(B)}p.truncate(p.length()-n);return p};s.pbe.getCipher=function(e,t,r){switch(e){case s.oids["pkcs5PBES2"]:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var a=new Error("Cannot read encrypted PBE data block. Unsupported OID.");a.oid=e;a.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"];throw a}};s.pbe.getCipherForPBES2=function(e,t,r){var i={};var o=[];if(!n.validate(t,l,i,o)){var u=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");u.errors=o;throw u}e=n.derToOid(i.kdfOid);if(e!==s.oids["pkcs5PBKDF2"]){var u=new Error("Cannot read encrypted private key. "+"Unsupported key derivation function OID.");u.oid=e;u.supportedOids=["pkcs5PBKDF2"];throw u}e=n.derToOid(i.encOid);if(e!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids["desCBC"]){var u=new Error("Cannot read encrypted private key. "+"Unsupported encryption scheme OID.");u.oid=e;u.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"];throw u}var c=i.kdfSalt;var p=a.util.createBuffer(i.kdfIterationCount);p=p.getInt(p.length()<<3);var h;var d;switch(s.oids[e]){case"aes128-CBC":h=16;d=a.aes.createDecryptionCipher;break;case"aes192-CBC":h=24;d=a.aes.createDecryptionCipher;break;case"aes256-CBC":h=32;d=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":h=24;d=a.des.createDecryptionCipher;break;case"desCBC":h=8;d=a.des.createDecryptionCipher;break}var g=prfOidToMessageDigest(i.prfOid);var y=a.pkcs5.pbkdf2(r,c,p,h,g);var v=i.encIv;var m=d(y);m.start(v);return m};s.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={};var o=[];if(!n.validate(t,c,i,o)){var u=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");u.errors=o;throw u}var l=a.util.createBuffer(i.salt);var p=a.util.createBuffer(i.iterations);p=p.getInt(p.length()<<3);var h,d,g;switch(e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:h=24;d=8;g=a.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:h=5;d=8;g=function(e,t){var r=a.rc2.createDecryptionCipher(e,40);r.start(t,null);return r};break;default:var u=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");u.oid=e;throw u}var y=prfOidToMessageDigest(i.prfOid);var v=s.pbe.generatePkcs12Key(r,l,1,p,h,y);y.start();var m=s.pbe.generatePkcs12Key(r,l,2,p,d,y);return g(v,m)};s.pbe.opensslDeriveBytes=function(e,t,r,i){if(typeof i==="undefined"||i===null){if(!("md5"in a.md)){throw new Error('"md5" hash algorithm unavailable.')}i=a.md.md5.create()}if(t===null){t=""}var n=[hash(i,e+t)];for(var s=16,o=1;s<r;++o,s+=16){n.push(hash(i,n[o-1]+e+t))}return n.join("").substr(0,r)};function hash(e,t){return e.start().update(t).digest().getBytes()}function prfOidToMessageDigest(e){var t;if(!e){t="hmacWithSHA1"}else{t=s.oids[n.derToOid(e)];if(!t){var r=new Error("Unsupported PRF OID.");r.oid=e;r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"];throw r}}return prfAlgorithmToMessageDigest(t)}function prfAlgorithmToMessageDigest(e){var t=a.md;switch(e){case"hmacWithSHA224":t=a.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");r.algorithm=e;r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"];throw r}if(!t||!(e in t)){throw new Error("Unknown hash algorithm: "+e)}return t[e].create()}function createPbkdf2Params(e,t,r,i){var o=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,t.getBytes())]);if(i!=="hmacWithSHA1"){o.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,a.util.hexToBytes(r.toString(16))),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(s.oids[i]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")]))}return o}},305:function(e,t,r){var a=r(809);r(787);r(5);r(362);var i=a.pkcs5=a.pkcs5||{};var n;if(a.util.isNodejs&&!a.options.usePureJavaScript){n=r(113)}e.exports=a.pbkdf2=i.pbkdf2=function(e,t,r,i,s,o){if(typeof s==="function"){o=s;s=null}if(a.util.isNodejs&&!a.options.usePureJavaScript&&n.pbkdf2&&(s===null||typeof s!=="object")&&(n.pbkdf2Sync.length>4||(!s||s==="sha1"))){if(typeof s!=="string"){s="sha1"}e=Buffer.from(e,"binary");t=Buffer.from(t,"binary");if(!o){if(n.pbkdf2Sync.length===4){return n.pbkdf2Sync(e,t,r,i).toString("binary")}return n.pbkdf2Sync(e,t,r,i,s).toString("binary")}if(n.pbkdf2Sync.length===4){return n.pbkdf2(e,t,r,i,(function(e,t){if(e){return o(e)}o(null,t.toString("binary"))}))}return n.pbkdf2(e,t,r,i,s,(function(e,t){if(e){return o(e)}o(null,t.toString("binary"))}))}if(typeof s==="undefined"||s===null){s="sha1"}if(typeof s==="string"){if(!(s in a.md.algorithms)){throw new Error("Unknown hash algorithm: "+s)}s=a.md[s].create()}var u=s.digestLength;if(i>4294967295*u){var l=new Error("Derived key is too long.");if(o){return o(l)}throw l}var c=Math.ceil(i/u);var p=i-(c-1)*u;var h=a.hmac.create();h.start(s,e);var d="";var g,y,v;if(!o){for(var m=1;m<=c;++m){h.start(null,null);h.update(t);h.update(a.util.int32ToBytes(m));g=v=h.digest().getBytes();for(var C=2;C<=r;++C){h.start(null,null);h.update(v);y=h.digest().getBytes();g=a.util.xorBytes(g,y,u);v=y}d+=m<c?g:g.substr(0,p)}return d}var m=1,C;function outer(){if(m>c){return o(null,d)}h.start(null,null);h.update(t);h.update(a.util.int32ToBytes(m));g=v=h.digest().getBytes();C=2;inner()}function inner(){if(C<=r){h.start(null,null);h.update(v);y=h.digest().getBytes();g=a.util.xorBytes(g,y,u);v=y;++C;return a.util.setImmediate(inner)}d+=m<c?g:g.substr(0,p);++m;outer()}outer()}},227:function(e,t,r){var a=r(809);r(362);var i=e.exports=a.pem=a.pem||{};i.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+"-----\r\n";var i;if(e.procType){i={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]};r+=foldHeader(i)}if(e.contentDomain){i={name:"Content-Domain",values:[e.contentDomain]};r+=foldHeader(i)}if(e.dekInfo){i={name:"DEK-Info",values:[e.dekInfo.algorithm]};if(e.dekInfo.parameters){i.values.push(e.dekInfo.parameters)}r+=foldHeader(i)}if(e.headers){for(var n=0;n<e.headers.length;++n){r+=foldHeader(e.headers[n])}}if(e.procType){r+="\r\n"}r+=a.util.encode64(e.body,t.maxline||64)+"\r\n";r+="-----END "+e.type+"-----\r\n";return r};i.decode=function(e){var t=[];var r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var n=/\r?\n/;var s;while(true){s=r.exec(e);if(!s){break}var o=s[1];if(o==="NEW CERTIFICATE REQUEST"){o="CERTIFICATE REQUEST"}var u={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(s[3])};t.push(u);if(!s[2]){continue}var l=s[2].split(n);var c=0;while(s&&c<l.length){var p=l[c].replace(/\s+$/,"");for(var h=c+1;h<l.length;++h){var d=l[h];if(!/\s/.test(d[0])){break}p+=d;c=h}s=p.match(i);if(s){var g={name:s[1],values:[]};var y=s[2].split(",");for(var v=0;v<y.length;++v){g.values.push(ltrim(y[v]))}if(!u.procType){if(g.name!=="Proc-Type"){throw new Error("Invalid PEM formatted message. The first "+'encapsulated header must be "Proc-Type".')}else if(g.values.length!==2){throw new Error('Invalid PEM formatted message. The "Proc-Type" '+"header must have two subfields.")}u.procType={version:y[0],type:y[1]}}else if(!u.contentDomain&&g.name==="Content-Domain"){u.contentDomain=y[0]||""}else if(!u.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+"header must have at least one subfield.")}u.dekInfo={algorithm:y[0],parameters:y[1]||null}}else{u.headers.push(g)}}++c}if(u.procType==="ENCRYPTED"&&!u.dekInfo){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+'header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0){throw new Error("Invalid PEM formatted message.")}return t};function foldHeader(e){var t=e.name+": ";var r=[];var insertSpace=function(e,t){return" "+t};for(var a=0;a<e.values.length;++a){r.push(e.values[a].replace(/^(\S+\r\n)/,insertSpace))}t+=r.join(",")+"\r\n";var i=0;var n=-1;for(var a=0;a<t.length;++a,++i){if(i>65&&n!==-1){var s=t[n];if(s===","){++n;t=t.substr(0,n)+"\r\n "+t.substr(n)}else{t=t.substr(0,n)+"\r\n"+s+t.substr(n+1)}i=a-n-1;n=-1;++a}else if(t[a]===" "||t[a]==="\t"||t[a]===","){n=a}}return t}function ltrim(e){return e.replace(/^\s+/,"")}},825:function(e,t,r){var a=r(809);r(362);r(394);r(241);var i=e.exports=a.pkcs1=a.pkcs1||{};i.encode_rsa_oaep=function(e,t,r){var i;var n;var s;var o;if(typeof r==="string"){i=r;n=arguments[3]||undefined;s=arguments[4]||undefined}else if(r){i=r.label||undefined;n=r.seed||undefined;s=r.md||undefined;if(r.mgf1&&r.mgf1.md){o=r.mgf1.md}}if(!s){s=a.md.sha1.create()}else{s.start()}if(!o){o=s}var u=Math.ceil(e.n.bitLength()/8);var l=u-2*s.digestLength-2;if(t.length>l){var c=new Error("RSAES-OAEP input message length is too long.");c.length=t.length;c.maxLength=l;throw c}if(!i){i=""}s.update(i,"raw");var p=s.digest();var h="";var d=l-t.length;for(var g=0;g<d;g++){h+="\0"}var y=p.getBytes()+h+""+t;if(!n){n=a.random.getBytes(s.digestLength)}else if(n.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must "+"match the digest length.");c.seedLength=n.length;c.digestLength=s.digestLength;throw c}var v=rsa_mgf1(n,u-s.digestLength-1,o);var m=a.util.xorBytes(y,v,y.length);var C=rsa_mgf1(m,s.digestLength,o);var E=a.util.xorBytes(n,C,n.length);return"\0"+E+m};i.decode_rsa_oaep=function(e,t,r){var i;var n;var s;if(typeof r==="string"){i=r;n=arguments[3]||undefined}else if(r){i=r.label||undefined;n=r.md||undefined;if(r.mgf1&&r.mgf1.md){s=r.mgf1.md}}var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var u=new Error("RSAES-OAEP encoded message length is invalid.");u.length=t.length;u.expectedLength=o;throw u}if(n===undefined){n=a.md.sha1.create()}else{n.start()}if(!s){s=n}if(o<2*n.digestLength+2){throw new Error("RSAES-OAEP key is too short for the hash function.")}if(!i){i=""}n.update(i,"raw");var l=n.digest().getBytes();var c=t.charAt(0);var p=t.substring(1,n.digestLength+1);var h=t.substring(1+n.digestLength);var d=rsa_mgf1(h,n.digestLength,s);var g=a.util.xorBytes(p,d,p.length);var y=rsa_mgf1(g,o-n.digestLength-1,s);var v=a.util.xorBytes(h,y,h.length);var m=v.substring(0,n.digestLength);var u=c!=="\0";for(var C=0;C<n.digestLength;++C){u|=l.charAt(C)!==m.charAt(C)}var E=1;var I=n.digestLength;for(var T=n.digestLength;T<v.length;T++){var b=v.charCodeAt(T);var B=b&1^1;var _=E?65534:0;u|=b&_;E=E&B;I+=E}if(u||v.charCodeAt(I)!==1){throw new Error("Invalid RSAES-OAEP padding.")}return v.substring(I+1)};function rsa_mgf1(e,t,r){if(!r){r=a.md.sha1.create()}var i="";var n=Math.ceil(t/r.digestLength);for(var s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start();r.update(e+o);i+=r.digest().getBytes()}return i.substring(0,t)}},966:function(e,t,r){var a=r(809);r(446);r(787);r(957);r(40);r(243);r(394);r(28);r(241);r(362);r(715);var i=a.asn1;var n=a.pki;var s=e.exports=a.pkcs12=a.pkcs12||{};var o={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"content"}]};var u={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"version"},o,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:false,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:false,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,optional:true,capture:"macIterations"}]}]};var l={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:true,optional:true,capture:"bagAttributes"}]};var c={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:true,capture:"values"}]};var p={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:true,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:false,capture:"cert"}]}]};function _getBagsByAttribute(e,t,r,a){var i=[];for(var n=0;n<e.length;n++){for(var s=0;s<e[n].safeBags.length;s++){var o=e[n].safeBags[s];if(a!==undefined&&o.type!==a){continue}if(t===null){i.push(o);continue}if(o.attributes[t]!==undefined&&o.attributes[t].indexOf(r)>=0){i.push(o)}}}return i}s.pkcs12FromAsn1=function(e,t,r){if(typeof t==="string"){r=t;t=true}else if(t===undefined){t=true}var o={};var l=[];if(!i.validate(e,u,o,l)){var c=new Error("Cannot read PKCS#12 PFX. "+"ASN.1 object is not an PKCS#12 PFX.");c.errors=c;throw c}var p={version:o.version.charCodeAt(0),safeContents:[],getBags:function(e){var t={};var r;if("localKeyId"in e){r=e.localKeyId}else if("localKeyIdHex"in e){r=a.util.hexToBytes(e.localKeyIdHex)}if(r===undefined&&!("friendlyName"in e)&&"bagType"in e){t[e.bagType]=_getBagsByAttribute(p.safeContents,null,null,e.bagType)}if(r!==undefined){t.localKeyId=_getBagsByAttribute(p.safeContents,"localKeyId",r,e.bagType)}if("friendlyName"in e){t.friendlyName=_getBagsByAttribute(p.safeContents,"friendlyName",e.friendlyName,e.bagType)}return t},getBagsByFriendlyName:function(e,t){return _getBagsByAttribute(p.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return _getBagsByAttribute(p.safeContents,"localKeyId",e,t)}};if(o.version.charCodeAt(0)!==3){var c=new Error("PKCS#12 PFX of version other than 3 not supported.");c.version=o.version.charCodeAt(0);throw c}if(i.derToOid(o.contentType)!==n.oids.data){var c=new Error("Only PKCS#12 PFX in password integrity mode supported.");c.oid=i.derToOid(o.contentType);throw c}var h=o.content.value[0];if(h.tagClass!==i.Class.UNIVERSAL||h.type!==i.Type.OCTETSTRING){throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.")}h=_decodePkcs7Data(h);if(o.mac){var d=null;var g=0;var y=i.derToOid(o.macAlgorithm);switch(y){case n.oids.sha1:d=a.md.sha1.create();g=20;break;case n.oids.sha256:d=a.md.sha256.create();g=32;break;case n.oids.sha384:d=a.md.sha384.create();g=48;break;case n.oids.sha512:d=a.md.sha512.create();g=64;break;case n.oids.md5:d=a.md.md5.create();g=16;break}if(d===null){throw new Error("PKCS#12 uses unsupported MAC algorithm: "+y)}var v=new a.util.ByteBuffer(o.macSalt);var m="macIterations"in o?parseInt(a.util.bytesToHex(o.macIterations),16):1;var C=s.generateKey(r,v,3,m,g,d);var E=a.hmac.create();E.start(d,C);E.update(h.value);var I=E.getMac();if(I.getBytes()!==o.macDigest){throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}}_decodeAuthenticatedSafe(p,h.value,t,r);return p};function _decodePkcs7Data(e){if(e.composed||e.constructed){var t=a.util.createBuffer();for(var r=0;r<e.value.length;++r){t.putBytes(e.value[r].value)}e.composed=e.constructed=false;e.value=t.getBytes()}return e}function _decodeAuthenticatedSafe(e,t,r,a){t=i.fromDer(t,r);if(t.tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||t.constructed!==true){throw new Error("PKCS#12 AuthenticatedSafe expected to be a "+"SEQUENCE OF ContentInfo")}for(var s=0;s<t.value.length;s++){var u=t.value[s];var l={};var c=[];if(!i.validate(u,o,l,c)){var p=new Error("Cannot read ContentInfo.");p.errors=c;throw p}var h={encrypted:false};var d=null;var g=l.content.value[0];switch(i.derToOid(l.contentType)){case n.oids.data:if(g.tagClass!==i.Class.UNIVERSAL||g.type!==i.Type.OCTETSTRING){throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.")}d=_decodePkcs7Data(g).value;break;case n.oids.encryptedData:d=_decryptSafeContents(g,a);h.encrypted=true;break;default:var p=new Error("Unsupported PKCS#12 contentType.");p.contentType=i.derToOid(l.contentType);throw p}h.safeBags=_decodeSafeContents(d,r,a);e.safeContents.push(h)}}function _decryptSafeContents(e,t){var r={};var s=[];if(!i.validate(e,a.pkcs7.asn1.encryptedDataValidator,r,s)){var o=new Error("Cannot read EncryptedContentInfo.");o.errors=s;throw o}var u=i.derToOid(r.contentType);if(u!==n.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");o.oid=u;throw o}u=i.derToOid(r.encAlgorithm);var l=n.pbe.getCipher(u,r.encParameter,t);var c=_decodePkcs7Data(r.encryptedContentAsn1);var p=a.util.createBuffer(c.value);l.update(p);if(!l.finish()){throw new Error("Failed to decrypt PKCS#12 SafeContents.")}return l.output.getBytes()}function _decodeSafeContents(e,t,r){if(!t&&e.length===0){return[]}e=i.fromDer(e,t);if(e.tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||e.constructed!==true){throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.")}var a=[];for(var s=0;s<e.value.length;s++){var o=e.value[s];var u={};var c=[];if(!i.validate(o,l,u,c)){var h=new Error("Cannot read SafeBag.");h.errors=c;throw h}var d={type:i.derToOid(u.bagId),attributes:_decodeBagAttributes(u.bagAttributes)};a.push(d);var g,y;var v=u.bagValue.value[0];switch(d.type){case n.oids.pkcs8ShroudedKeyBag:v=n.decryptPrivateKeyInfo(v,r);if(v===null){throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?")}case n.oids.keyBag:try{d.key=n.privateKeyFromAsn1(v)}catch(e){d.key=null;d.asn1=v}continue;case n.oids.certBag:g=p;y=function(){if(i.derToOid(u.certId)!==n.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");e.oid=i.derToOid(u.certId);throw e}var r=i.fromDer(u.cert,t);try{d.cert=n.certificateFromAsn1(r,true)}catch(e){d.cert=null;d.asn1=r}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");h.oid=d.type;throw h}if(g!==undefined&&!i.validate(v,g,u,c)){var h=new Error("Cannot read PKCS#12 "+g.name);h.errors=c;throw h}y()}return a}function _decodeBagAttributes(e){var t={};if(e!==undefined){for(var r=0;r<e.length;++r){var a={};var s=[];if(!i.validate(e[r],c,a,s)){var o=new Error("Cannot read PKCS#12 BagAttribute.");o.errors=s;throw o}var u=i.derToOid(a.oid);if(n.oids[u]===undefined){continue}t[n.oids[u]]=[];for(var l=0;l<a.values.length;++l){t[n.oids[u]].push(a.values[l].value)}}}return t}s.toPkcs12Asn1=function(e,t,r,o){o=o||{};o.saltSize=o.saltSize||8;o.count=o.count||2048;o.algorithm=o.algorithm||o.encAlgorithm||"aes128";if(!("useMac"in o)){o.useMac=true}if(!("localKeyId"in o)){o.localKeyId=null}if(!("generateLocalKeyId"in o)){o.generateLocalKeyId=true}var u=o.localKeyId;var l;if(u!==null){u=a.util.hexToBytes(u)}else if(o.generateLocalKeyId){if(t){var c=a.util.isArray(t)?t[0]:t;if(typeof c==="string"){c=n.certificateFromPem(c)}var p=a.md.sha1.create();p.update(i.toDer(n.certificateToAsn1(c)).getBytes());u=p.digest().getBytes()}else{u=a.random.getBytes(20)}}var h=[];if(u!==null){h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,u)])]))}if("friendlyName"in o){h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,false,o.friendlyName)])]))}if(h.length>0){l=i.create(i.Class.UNIVERSAL,i.Type.SET,true,h)}var d=[];var g=[];if(t!==null){if(a.util.isArray(t)){g=t}else{g=[t]}}var y=[];for(var v=0;v<g.length;++v){t=g[v];if(typeof t==="string"){t=n.certificateFromPem(t)}var m=v===0?l:undefined;var C=n.certificateToAsn1(t);var E=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,i.toDer(C).getBytes())])])]),m]);y.push(E)}if(y.length>0){var I=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,y);var T=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,i.toDer(I).getBytes())])]);d.push(T)}var b=null;if(e!==null){var B=n.wrapRsaPrivateKey(n.privateKeyToAsn1(e));if(r===null){b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[B]),l])}else{b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[n.encryptPrivateKeyInfo(B,r,o)]),l])}var _=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[b]);var N=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,i.toDer(_).getBytes())])]);d.push(N)}var w=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,d);var R;if(o.useMac){var p=a.md.sha1.create();var k=new a.util.ByteBuffer(a.random.getBytes(o.saltSize));var L=o.count;var e=s.generateKey(r,k,3,L,20);var U=a.hmac.create();U.start(p,e);U.update(i.toDer(w).getBytes());var D=U.getMac();R=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,D.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,k.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(L).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(n.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,i.toDer(w).getBytes())])]),R])};s.generateKey=a.pbe.generatePkcs12Key},620:function(e,t,r){var a=r(809);r(801);r(446);r(599);r(957);r(227);r(40);r(394);r(362);r(715);var i=a.asn1;var n=e.exports=a.pkcs7=a.pkcs7||{};n.messageFromPem=function(e){var t=a.pem.decode(e)[0];if(t.type!=="PKCS7"){var r=new Error("Could not convert PKCS#7 message from PEM; PEM "+'header type is not "PKCS#7".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.")}var s=i.fromDer(t.body);return n.messageFromAsn1(s)};n.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return a.pem.encode(r,{maxline:t})};n.messageFromAsn1=function(e){var t={};var r=[];if(!i.validate(e,n.asn1.contentInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 ContentInfo.");s.errors=r;throw s}var o=i.derToOid(t.contentType);var u;switch(o){case a.pki.oids.envelopedData:u=n.createEnvelopedData();break;case a.pki.oids.encryptedData:u=n.createEncryptedData();break;case a.pki.oids.signedData:u=n.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}u.fromAsn1(t.content.value[0]);return u};n.createSignedData=function(){var e=null;e={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){_fromAsn1(e,t,n.asn1.signedDataValidator);e.certificates=[];e.crls=[];e.digestAlgorithmIdentifiers=[];e.contentInfo=null;e.signerInfos=[];if(e.rawCapture.certificates){var r=e.rawCapture.certificates.value;for(var i=0;i<r.length;++i){e.certificates.push(a.pki.certificateFromAsn1(r[i]))}}},toAsn1:function(){if(!e.contentInfo){e.sign()}var t=[];for(var r=0;r<e.certificates.length;++r){t.push(a.pki.certificateToAsn1(e.certificates[r]))}var n=[];var s=i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,e.digestAlgorithmIdentifiers),e.contentInfo])]);if(t.length>0){s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,true,t))}if(n.length>0){s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,true,n))}s.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,true,e.signerInfos));return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.type).getBytes()),s])},addSigner:function(t){var r=t.issuer;var i=t.serialNumber;if(t.certificate){var n=t.certificate;if(typeof n==="string"){n=a.pki.certificateFromPem(n)}r=n.issuer.attributes;i=n.serialNumber}var s=t.key;if(!s){throw new Error("Could not add PKCS#7 signer; no private key specified.")}if(typeof s==="string"){s=a.pki.privateKeyFromPem(s)}var o=t.digestAlgorithm||a.pki.oids.sha1;switch(o){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var u=t.authenticatedAttributes||[];if(u.length>0){var l=false;var c=false;for(var p=0;p<u.length;++p){var h=u[p];if(!l&&h.type===a.pki.oids.contentType){l=true;if(c){break}continue}if(!c&&h.type===a.pki.oids.messageDigest){c=true;if(l){break}continue}}if(!l||!c){throw new Error("Invalid signer.authenticatedAttributes. If "+"signer.authenticatedAttributes is specified, then it must "+"contain at least two attributes, PKCS #9 content-type and "+"PKCS #9 message-digest.")}}e.signers.push({key:s,version:1,issuer:r,serialNumber:i,digestAlgorithm:o,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(t){t=t||{};if(typeof e.content!=="object"||e.contentInfo===null){e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(a.pki.oids.data).getBytes())]);if("content"in e){var r;if(e.content instanceof a.util.ByteBuffer){r=e.content.bytes()}else if(typeof e.content==="string"){r=a.util.encodeUtf8(e.content)}if(t.detached){e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,r)}else{e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,r)]))}}}if(e.signers.length===0){return}var n=addDigestAlgorithmIds();addSignerInfos(n)},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){if(typeof t==="string"){t=a.pki.certificateFromPem(t)}e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}};return e;function addDigestAlgorithmIds(){var t={};for(var r=0;r<e.signers.length;++r){var n=e.signers[r];var s=n.digestAlgorithm;if(!(s in t)){t[s]=a.md[a.pki.oids[s]].create()}if(n.authenticatedAttributes.length===0){n.md=t[s]}else{n.md=a.md[a.pki.oids[s]].create()}}e.digestAlgorithmIdentifiers=[];for(var s in t){e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(s).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")]))}return t}function addSignerInfos(t){var r;if(e.detachedContent){r=e.detachedContent}else{r=e.contentInfo.value[1];r=r.value[0]}if(!r){throw new Error("Could not sign PKCS#7 message; there is no content to sign.")}var n=i.derToOid(e.contentInfo.value[0].value);var s=i.toDer(r);s.getByte();i.getBerValueLength(s);s=s.getBytes();for(var o in t){t[o].start().update(s)}var u=new Date;for(var l=0;l<e.signers.length;++l){var c=e.signers[l];if(c.authenticatedAttributes.length===0){if(n!==a.pki.oids.data){throw new Error("Invalid signer; authenticatedAttributes must be present "+"when the ContentInfo content type is not PKCS#7 Data.")}}else{c.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,true,[]);var p=i.create(i.Class.UNIVERSAL,i.Type.SET,true,[]);for(var h=0;h<c.authenticatedAttributes.length;++h){var d=c.authenticatedAttributes[h];if(d.type===a.pki.oids.messageDigest){d.value=t[c.digestAlgorithm].digest()}else if(d.type===a.pki.oids.signingTime){if(!d.value){d.value=u}}p.value.push(_attributeToAsn1(d));c.authenticatedAttributesAsn1.value.push(_attributeToAsn1(d))}s=i.toDer(p).getBytes();c.md.start().update(s)}c.signature=c.key.sign(c.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=_signersToAsn1(e.signers)}};n.createEncryptedData=function(){var e=null;e={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){_fromAsn1(e,t,n.asn1.encryptedDataValidator)},decrypt:function(t){if(t!==undefined){e.encryptedContent.key=t}_decryptContent(e)}};return e};n.createEnvelopedData=function(){var e=null;e={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=_fromAsn1(e,t,n.asn1.envelopedDataValidator);e.recipients=_recipientsFromAsn1(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,_recipientsToAsn1(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,_encryptedContentToAsn1(e.encryptedContent))])])])},findRecipient:function(t){var r=t.issuer.attributes;for(var a=0;a<e.recipients.length;++a){var i=e.recipients[a];var n=i.issuer;if(i.serialNumber!==t.serialNumber){continue}if(n.length!==r.length){continue}var s=true;for(var o=0;o<r.length;++o){if(n[o].type!==r[o].type||n[o].value!==r[o].value){s=false;break}}if(s){return i}}return null},decrypt:function(t,r){if(e.encryptedContent.key===undefined&&t!==undefined&&r!==undefined){switch(t.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=a.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, "+"OID "+t.encryptedContent.algorithm)}}_decryptContent(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(e.encryptedContent.content===undefined){r=r||e.encryptedContent.algorithm;t=t||e.encryptedContent.key;var i,n,s;switch(r){case a.pki.oids["aes128-CBC"]:i=16;n=16;s=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:i=24;n=16;s=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:i=32;n=16;s=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:i=24;n=8;s=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(t===undefined){t=a.util.createBuffer(a.random.getBytes(i))}else if(t.length()!=i){throw new Error("Symmetric key has wrong length; "+"got "+t.length()+" bytes, expected "+i+".")}e.encryptedContent.algorithm=r;e.encryptedContent.key=t;e.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(n));var o=s(t);o.start(e.encryptedContent.parameter.copy());o.update(e.content);if(!o.finish()){throw new Error("Symmetric encryption failed.")}e.encryptedContent.content=o.output}for(var u=0;u<e.recipients.length;++u){var l=e.recipients[u];if(l.encryptedContent.content!==undefined){continue}switch(l.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}};return e};function _recipientFromAsn1(e){var t={};var r=[];if(!i.validate(e,n.asn1.recipientInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 RecipientInfo. "+"ASN.1 object is not an PKCS#7 RecipientInfo.");s.errors=r;throw s}return{version:t.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(t.issuer),serialNumber:a.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:undefined,content:t.encKey}}}function _recipientToAsn1(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[a.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,a.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,e.encryptedContent.content)])}function _recipientsFromAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_recipientFromAsn1(e[r]))}return t}function _recipientsToAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_recipientToAsn1(e[r]))}return t}function _signerFromAsn1(e){var t={};var r=[];if(!i.validate(e,n.asn1.signerInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 SignerInfo. "+"ASN.1 object is not an PKCS#7 SignerInfo.");s.errors=r;throw s}var o={version:t.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(t.issuer),serialNumber:a.util.createBuffer(t.serial).toHex(),digestAlgorithm:i.derToOid(t.digestAlgorithm),signatureAlgorithm:i.derToOid(t.signatureAlgorithm),signature:t.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]};var u=t.authenticatedAttributes||[];var l=t.unauthenticatedAttributes||[];return o}function _signerToAsn1(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[a.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,a.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")])]);if(e.authenticatedAttributesAsn1){t.value.push(e.authenticatedAttributesAsn1)}t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")]));t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,e.signature));if(e.unauthenticatedAttributes.length>0){var r=i.create(i.Class.CONTEXT_SPECIFIC,1,true,[]);for(var n=0;n<e.unauthenticatedAttributes.length;++n){var s=e.unauthenticatedAttributes[n];r.values.push(_attributeToAsn1(s))}t.value.push(r)}return t}function _signersFromAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_signerFromAsn1(e[r]))}return t}function _signersToAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_signerToAsn1(e[r]))}return t}function _attributeToAsn1(e){var t;if(e.type===a.pki.oids.contentType){t=i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.value).getBytes())}else if(e.type===a.pki.oids.messageDigest){t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,e.value.bytes())}else if(e.type===a.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z");var n=new Date("2050-01-01T00:00:00Z");var s=e.value;if(typeof s==="string"){var o=Date.parse(s);if(!isNaN(o)){s=new Date(o)}else if(s.length===13){s=i.utcTimeToDate(s)}else{s=i.generalizedTimeToDate(s)}}if(s>=r&&s<n){t=i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,false,i.dateToUtcTime(s))}else{t=i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,false,i.dateToGeneralizedTime(s))}}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,[t])])}function _encryptedContentToAsn1(e){return[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(a.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.algorithm).getBytes()),!e.parameter?undefined:i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,e.parameter.getBytes())]),i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,e.content.getBytes())])]}function _fromAsn1(e,t,r){var n={};var s=[];if(!i.validate(t,r,n,s)){var o=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not a supported PKCS#7 message.");o.errors=o;throw o}var u=i.derToOid(n.contentType);if(u!==a.pki.oids.data){throw new Error("Unsupported PKCS#7 message. "+"Only wrapped ContentType Data supported.")}if(n.encryptedContent){var l="";if(a.util.isArray(n.encryptedContent)){for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==i.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting encrypted "+"content constructed of only OCTET STRING objects.")}l+=n.encryptedContent[c].value}}else{l=n.encryptedContent}e.encryptedContent={algorithm:i.derToOid(n.encAlgorithm),parameter:a.util.createBuffer(n.encParameter.value),content:a.util.createBuffer(l)}}if(n.content){var l="";if(a.util.isArray(n.content)){for(var c=0;c<n.content.length;++c){if(n.content[c].type!==i.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting "+"content constructed of only OCTET STRING objects.")}l+=n.content[c].value}}else{l=n.content}e.content=a.util.createBuffer(l)}e.version=n.version.charCodeAt(0);e.rawCapture=n;return n}function _decryptContent(e){if(e.encryptedContent.key===undefined){throw new Error("Symmetric key not available.")}if(e.content===undefined){var t;switch(e.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:t=a.aes.createDecryptionCipher(e.encryptedContent.key);break;case a.pki.oids["desCBC"]:case a.pki.oids["des-EDE3-CBC"]:t=a.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}t.start(e.encryptedContent.parameter);t.update(e.encryptedContent.content);if(!t.finish()){throw new Error("Symmetric decryption failed.")}e.content=t.output}}},40:function(e,t,r){var a=r(809);r(446);r(362);var i=a.asn1;var n=e.exports=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{};a.pkcs7.asn1=n;var s={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,captureAsn1:"content"}]};n.contentInfoValidator=s;var o={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:true,captureAsn1:"recipientInfos"}].concat(o)};n.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"version"}].concat(o)};var u={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:false,captureAsn1:"digestParameter",optional:true}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:false,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,capture:"unauthenticatedAttributes"}]};n.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:true,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:true,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:true,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:true,value:[u]}]};n.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:false,captureAsn1:"encParameter",optional:true}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:false,capture:"encKey"}]}},886:function(e,t,r){var a=r(809);r(446);r(957);r(243);r(227);r(305);r(966);r(533);r(28);r(362);r(715);var i=a.asn1;var n=e.exports=a.pki=a.pki||{};n.pemToDer=function(e){var t=a.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert PEM to DER; PEM is encrypted.")}return a.util.createBuffer(t.body)};n.privateKeyFromPem=function(e){var t=a.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var r=new Error("Could not convert private key from PEM; PEM "+'header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert private key from PEM; PEM is encrypted.")}var s=i.fromDer(t.body);return n.privateKeyFromAsn1(s)};n.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(n.privateKeyToAsn1(e)).getBytes()};return a.pem.encode(r,{maxline:t})};n.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return a.pem.encode(r,{maxline:t})}},451:function(e,t,r){var a=r(809);r(362);r(319);r(394);(function(){if(a.prime){e.exports=a.prime;return}var t=e.exports=a.prime=a.prime||{};var r=a.jsbn.BigInteger;var i=[6,4,2,4,2,4,6,2];var n=new r(null);n.fromInt(30);var op_or=function(e,t){return e|t};t.generateProbablePrime=function(e,t,r){if(typeof t==="function"){r=t;t={}}t=t||{};var i=t.algorithm||"PRIMEINC";if(typeof i==="string"){i={name:i}}i.options=i.options||{};var n=t.prng||a.random;var s={nextBytes:function(e){var t=n.getBytesSync(e.length);for(var r=0;r<e.length;++r){e[r]=t.charCodeAt(r)}}};if(i.name==="PRIMEINC"){return primeincFindPrime(e,s,i.options,r)}throw new Error("Invalid prime generation algorithm: "+i.name)};function primeincFindPrime(e,t,r,a){if("workers"in r){return primeincFindPrimeWithWorkers(e,t,r,a)}return primeincFindPrimeWithoutWorkers(e,t,r,a)}function primeincFindPrimeWithoutWorkers(e,t,r,a){var i=generateRandom(e,t);var n=0;var s=getMillerRabinTests(i.bitLength());if("millerRabinTests"in r){s=r.millerRabinTests}var o=10;if("maxBlockTime"in r){o=r.maxBlockTime}_primeinc(i,e,t,n,s,o,a)}function _primeinc(e,t,r,n,s,o,u){var l=+new Date;do{if(e.bitLength()>t){e=generateRandom(t,r)}if(e.isProbablePrime(s)){return u(null,e)}e.dAddOffset(i[n++%8],0)}while(o<0||+new Date-l<o);a.util.setImmediate((function(){_primeinc(e,t,r,n,s,o,u)}))}function primeincFindPrimeWithWorkers(e,t,i,n){if(typeof Worker==="undefined"){return primeincFindPrimeWithoutWorkers(e,t,i,n)}var s=generateRandom(e,t);var o=i.workers;var u=i.workLoad||100;var l=u*30/8;var c=i.workerScript||"forge/prime.worker.js";if(o===-1){return a.util.estimateCores((function(e,t){if(e){t=2}o=t-1;generate()}))}generate();function generate(){o=Math.max(1,o);var a=[];for(var i=0;i<o;++i){a[i]=new Worker(c)}var p=o;for(var i=0;i<o;++i){a[i].addEventListener("message",workerMessage)}var h=false;function workerMessage(i){if(h){return}--p;var o=i.data;if(o.found){for(var c=0;c<a.length;++c){a[c].terminate()}h=true;return n(null,new r(o.prime,16))}if(s.bitLength()>e){s=generateRandom(e,t)}var d=s.toString(16);i.target.postMessage({hex:d,workLoad:u});s.dAddOffset(l,0)}}}function generateRandom(e,t){var a=new r(e,t);var i=e-1;if(!a.testBit(i)){a.bitwiseTo(r.ONE.shiftLeft(i),op_or,a)}a.dAddOffset(31-a.mod(n).byteValue(),0);return a}function getMillerRabinTests(e){if(e<=100)return 27;if(e<=150)return 18;if(e<=200)return 15;if(e<=250)return 12;if(e<=300)return 9;if(e<=350)return 8;if(e<=400)return 7;if(e<=500)return 6;if(e<=600)return 5;if(e<=800)return 4;if(e<=1250)return 3;return 2}})()},658:function(e,t,r){var a=r(809);r(362);var i=null;if(a.util.isNodejs&&!a.options.usePureJavaScript&&!process.versions["node-webkit"]){i=r(113)}var n=e.exports=a.prng=a.prng||{};n.create=function(e){var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""};var r=e.md;var n=new Array(32);for(var s=0;s<32;++s){n[s]=r.create()}t.pools=n;t.pool=0;t.generate=function(e,r){if(!r){return t.generateSync(e)}var i=t.plugin.cipher;var n=t.plugin.increment;var s=t.plugin.formatKey;var o=t.plugin.formatSeed;var u=a.util.createBuffer();t.key=null;generate();function generate(l){if(l){return r(l)}if(u.length()>=e){return r(null,u.getBytes(e))}if(t.generated>1048575){t.key=null}if(t.key===null){return a.util.nextTick((function(){_reseed(generate)}))}var c=i(t.key,t.seed);t.generated+=c.length;u.putBytes(c);t.key=s(i(t.key,n(t.seed)));t.seed=o(i(t.key,t.seed));a.util.setImmediate(generate)}};t.generateSync=function(e){var r=t.plugin.cipher;var i=t.plugin.increment;var n=t.plugin.formatKey;var s=t.plugin.formatSeed;t.key=null;var o=a.util.createBuffer();while(o.length()<e){if(t.generated>1048575){t.key=null}if(t.key===null){_reseedSync()}var u=r(t.key,t.seed);t.generated+=u.length;o.putBytes(u);t.key=n(r(t.key,i(t.seed)));t.seed=s(r(t.key,t.seed))}return o.getBytes(e)};function _reseed(e){if(t.pools[0].messageLength>=32){_seed();return e()}var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,a){if(r){return e(r)}t.collect(a);_seed();e()}))}function _reseedSync(){if(t.pools[0].messageLength>=32){return _seed()}var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e));_seed()}function _seed(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);var r=1;for(var a=0;a<32;++a){if(t.reseeds%r===0){e.update(t.pools[a].digest().getBytes());t.pools[a].start()}r=r<<1}t.keyBytes=e.digest().getBytes();e.start();e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes);t.seed=t.plugin.formatSeed(i);t.generated=0}function defaultSeedFile(e){var t=null;var r=a.util.globalScope;var i=r.crypto||r.msCrypto;if(i&&i.getRandomValues){t=function(e){return i.getRandomValues(e)}}var n=a.util.createBuffer();if(t){while(n.length()<e){var s=Math.max(1,Math.min(e-n.length(),65536)/4);var o=new Uint32Array(Math.floor(s));try{t(o);for(var u=0;u<o.length;++u){n.putInt32(o[u])}}catch(e){if(!(typeof QuotaExceededError!=="undefined"&&e instanceof QuotaExceededError)){throw e}}}}if(n.length()<e){var l,c,p;var h=Math.floor(Math.random()*65536);while(n.length()<e){c=16807*(h&65535);l=16807*(h>>16);c+=(l&32767)<<16;c+=l>>15;c=(c&2147483647)+(c>>31);h=c&4294967295;for(var u=0;u<3;++u){p=h>>>(u<<3);p^=Math.floor(Math.random()*256);n.putByte(p&255)}}}return n.getBytes(e)}if(i){t.seedFile=function(e,t){i.randomBytes(e,(function(e,r){if(e){return t(e)}t(null,r.toString())}))};t.seedFileSync=function(e){return i.randomBytes(e).toString()}}else{t.seedFile=function(e,t){try{t(null,defaultSeedFile(e))}catch(e){t(e)}};t.seedFileSync=defaultSeedFile}t.collect=function(e){var r=e.length;for(var a=0;a<r;++a){t.pools[t.pool].update(e.substr(a,1));t.pool=t.pool===31?0:t.pool+1}};t.collectInt=function(e,r){var a="";for(var i=0;i<r;i+=8){a+=String.fromCharCode(e>>i&255)}t.collect(a)};t.registerWorker=function(e){if(e===self){t.seedFile=function(e,t){function listener(e){var r=e.data;if(r.forge&&r.forge.prng){self.removeEventListener("message",listener);t(r.forge.prng.err,r.forge.prng.bytes)}}self.addEventListener("message",listener);self.postMessage({forge:{prng:{needed:e}}})}}else{var listener=function(r){var a=r.data;if(a.forge&&a.forge.prng){t.seedFile(a.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}};e.addEventListener("message",listener)}};return t}},533:function(e,t,r){var a=r(809);r(394);r(362);var i=e.exports=a.pss=a.pss||{};i.create=function(e){if(arguments.length===3){e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]}}var t=e.md;var r=e.mgf;var i=t.digestLength;var n=e.salt||null;if(typeof n==="string"){n=a.util.createBuffer(n)}var s;if("saltLength"in e){s=e.saltLength}else if(n!==null){s=n.length()}else{throw new Error("Salt length not specified or specific salt not given.")}if(n!==null&&n.length()!==s){throw new Error("Given salt length does not match length of given salt.")}var o=e.prng||a.random;var u={};u.encode=function(e,u){var l;var c=u-1;var p=Math.ceil(c/8);var h=e.digest().getBytes();if(p<i+s+2){throw new Error("Message is too long to encrypt.")}var d;if(n===null){d=o.getBytesSync(s)}else{d=n.bytes()}var g=new a.util.ByteBuffer;g.fillWithByte(0,8);g.putBytes(h);g.putBytes(d);t.start();t.update(g.getBytes());var y=t.digest().getBytes();var v=new a.util.ByteBuffer;v.fillWithByte(0,p-s-i-2);v.putByte(1);v.putBytes(d);var m=v.getBytes();var C=p-i-1;var E=r.generate(y,C);var I="";for(l=0;l<C;l++){I+=String.fromCharCode(m.charCodeAt(l)^E.charCodeAt(l))}var T=65280>>8*p-c&255;I=String.fromCharCode(I.charCodeAt(0)&~T)+I.substr(1);return I+y+String.fromCharCode(188)};u.verify=function(e,n,o){var u;var l=o-1;var c=Math.ceil(l/8);n=n.substr(-c);if(c<i+s+2){throw new Error("Inconsistent parameters to PSS signature verification.")}if(n.charCodeAt(c-1)!==188){throw new Error("Encoded message does not end in 0xBC.")}var p=c-i-1;var h=n.substr(0,p);var d=n.substr(p,i);var g=65280>>8*c-l&255;if((h.charCodeAt(0)&g)!==0){throw new Error("Bits beyond keysize not zero as expected.")}var y=r.generate(d,p);var v="";for(u=0;u<p;u++){v+=String.fromCharCode(h.charCodeAt(u)^y.charCodeAt(u))}v=String.fromCharCode(v.charCodeAt(0)&~g)+v.substr(1);var m=c-i-s-2;for(u=0;u<m;u++){if(v.charCodeAt(u)!==0){throw new Error("Leftmost octets not zero as expected")}}if(v.charCodeAt(m)!==1){throw new Error("Inconsistent PSS signature, 0x01 marker not found")}var C=v.substr(-s);var E=new a.util.ByteBuffer;E.fillWithByte(0,8);E.putBytes(e);E.putBytes(C);t.start();t.update(E.getBytes());var I=t.digest().getBytes();return d===I};return u}},394:function(e,t,r){var a=r(809);r(801);r(358);r(658);r(362);(function(){if(a.random&&a.random.getBytes){e.exports=a.random;return}(function(t){var r={};var i=new Array(4);var n=a.util.createBuffer();r.formatKey=function(e){var t=a.util.createBuffer(e);e=new Array(4);e[0]=t.getInt32();e[1]=t.getInt32();e[2]=t.getInt32();e[3]=t.getInt32();return a.aes._expandKey(e,false)};r.formatSeed=function(e){var t=a.util.createBuffer(e);e=new Array(4);e[0]=t.getInt32();e[1]=t.getInt32();e[2]=t.getInt32();e[3]=t.getInt32();return e};r.cipher=function(e,t){a.aes._updateBlock(e,t,i,false);n.putInt32(i[0]);n.putInt32(i[1]);n.putInt32(i[2]);n.putInt32(i[3]);return n.getBytes()};r.increment=function(e){++e[3];return e};r.md=a.md.sha256;function spawnPrng(){var e=a.prng.create(r);e.getBytes=function(t,r){return e.generate(t,r)};e.getBytesSync=function(t){return e.generate(t)};return e}var s=spawnPrng();var o=null;var u=a.util.globalScope;var l=u.crypto||u.msCrypto;if(l&&l.getRandomValues){o=function(e){return l.getRandomValues(e)}}if(a.options.usePureJavaScript||!a.util.isNodejs&&!o){if(typeof window==="undefined"||window.document===undefined){}s.collectInt(+new Date,32);if(typeof navigator!=="undefined"){var c="";for(var p in navigator){try{if(typeof navigator[p]=="string"){c+=navigator[p]}}catch(e){}}s.collect(c);c=null}if(t){t().mousemove((function(e){s.collectInt(e.clientX,16);s.collectInt(e.clientY,16)}));t().keypress((function(e){s.collectInt(e.charCode,8)}))}}if(!a.random){a.random=s}else{for(var p in s){a.random[p]=s[p]}}a.random.createInstance=spawnPrng;e.exports=a.random})(typeof jQuery!=="undefined"?jQuery:null)})()},653:function(e,t,r){var a=r(809);r(362);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173];var n=[1,2,3,5];var rol=function(e,t){return e<<t&65535|(e&65535)>>16-t};var ror=function(e,t){return(e&65535)>>t|e<<16-t&65535};e.exports=a.rc2=a.rc2||{};a.rc2.expandKey=function(e,t){if(typeof e==="string"){e=a.util.createBuffer(e)}t=t||128;var r=e;var n=e.length();var s=t;var o=Math.ceil(s/8);var u=255>>(s&7);var l;for(l=n;l<128;l++){r.putByte(i[r.at(l-1)+r.at(l-n)&255])}r.setAt(128-o,i[r.at(128-o)&u]);for(l=127-o;l>=0;l--){r.setAt(l,i[r.at(l+1)^r.at(l+o)])}return r};var createCipher=function(e,t,r){var i=false,s=null,o=null,u=null;var l,c;var p,h,d=[];e=a.rc2.expandKey(e,t);for(p=0;p<64;p++){d.push(e.getInt16Le())}if(r){l=function(e){for(p=0;p<4;p++){e[p]+=d[h]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]);e[p]=rol(e[p],n[p]);h++}};c=function(e){for(p=0;p<4;p++){e[p]+=d[e[(p+3)%4]&63]}}}else{l=function(e){for(p=3;p>=0;p--){e[p]=ror(e[p],n[p]);e[p]-=d[h]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]);h--}};c=function(e){for(p=3;p>=0;p--){e[p]-=d[e[(p+3)%4]&63]}}}var runPlan=function(e){var t=[];for(p=0;p<4;p++){var a=s.getInt16Le();if(u!==null){if(r){a^=u.getInt16Le()}else{u.putInt16Le(a)}}t.push(a&65535)}h=r?0:63;for(var i=0;i<e.length;i++){for(var n=0;n<e[i][0];n++){e[i][1](t)}}for(p=0;p<4;p++){if(u!==null){if(r){u.putInt16Le(t[p])}else{t[p]^=u.getInt16Le()}}o.putInt16Le(t[p])}};var g=null;g={start:function(e,t){if(e){if(typeof e==="string"){e=a.util.createBuffer(e)}}i=false;s=a.util.createBuffer();o=t||new a.util.createBuffer;u=e;g.output=o},update:function(e){if(!i){s.putBuffer(e)}while(s.length()>=8){runPlan([[5,l],[1,c],[6,l],[1,c],[5,l]])}},finish:function(e){var t=true;if(r){if(e){t=e(8,s,!r)}else{var a=s.length()===8?8:8-s.length();s.fillWithByte(a,a)}}if(t){i=true;g.update()}if(!r){t=s.length()===0;if(t){if(e){t=e(8,o,!r)}else{var n=o.length();var u=o.at(n-1);if(u>n){t=false}else{o.truncate(u)}}}}return t}};return g};a.rc2.startEncrypting=function(e,t,r){var i=a.rc2.createEncryptionCipher(e,128);i.start(t,r);return i};a.rc2.createEncryptionCipher=function(e,t){return createCipher(e,t,true)};a.rc2.startDecrypting=function(e,t,r){var i=a.rc2.createDecryptionCipher(e,128);i.start(t,r);return i};a.rc2.createDecryptionCipher=function(e,t){return createCipher(e,t,false)}},28:function(e,t,r){var a=r(809);r(446);r(319);r(957);r(825);r(451);r(394);r(362);if(typeof i==="undefined"){var i=a.jsbn.BigInteger}var n=a.util.isNodejs?r(113):null;var s=a.asn1;var o=a.util;a.pki=a.pki||{};e.exports=a.pki.rsa=a.rsa=a.rsa||{};var u=a.pki;var l=[6,4,2,4,2,4,6,2];var c={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};var p={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyCoefficient"}]};var h={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyExponent"}]};var d=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:false,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"rsaPublicKey"}]}]};var g={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:true,constructed:false}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:false,capture:"digest"}]};var emsaPkcs1v15encode=function(e){var t;if(e.algorithm in u.oids){t=u.oids[e.algorithm]}else{var r=new Error("Unknown message digest algorithm.");r.algorithm=e.algorithm;throw r}var a=s.oidToDer(t).getBytes();var i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);var n=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);n.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,false,a));n.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,false,""));var o=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,e.digest().getBytes());i.value.push(n);i.value.push(o);return s.toDer(i).getBytes()};var _modPow=function(e,t,r){if(r){return e.modPow(t.e,t.n)}if(!t.p||!t.q){return e.modPow(t.d,t.n)}if(!t.dP){t.dP=t.d.mod(t.p.subtract(i.ONE))}if(!t.dQ){t.dQ=t.d.mod(t.q.subtract(i.ONE))}if(!t.qInv){t.qInv=t.q.modInverse(t.p)}var n;do{n=new i(a.util.bytesToHex(a.random.getBytes(t.n.bitLength()/8)),16)}while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(i.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);var s=e.mod(t.p).modPow(t.dP,t.p);var o=e.mod(t.q).modPow(t.dQ,t.q);while(s.compareTo(o)<0){s=s.add(t.p)}var u=s.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);u=u.multiply(n.modInverse(t.n)).mod(t.n);return u};u.rsa.encrypt=function(e,t,r){var n=r;var s;var o=Math.ceil(t.n.bitLength()/8);if(r!==false&&r!==true){n=r===2;s=_encodePkcs1_v1_5(e,t,r)}else{s=a.util.createBuffer();s.putBytes(e)}var u=new i(s.toHex(),16);var l=_modPow(u,t,n);var c=l.toString(16);var p=a.util.createBuffer();var h=o-Math.ceil(c.length/2);while(h>0){p.putByte(0);--h}p.putBytes(a.util.hexToBytes(c));return p.getBytes()};u.rsa.decrypt=function(e,t,r,n){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var o=new Error("Encrypted message length is invalid.");o.length=e.length;o.expected=s;throw o}var u=new i(a.util.createBuffer(e).toHex(),16);if(u.compareTo(t.n)>=0){throw new Error("Encrypted message is invalid.")}var l=_modPow(u,t,r);var c=l.toString(16);var p=a.util.createBuffer();var h=s-Math.ceil(c.length/2);while(h>0){p.putByte(0);--h}p.putBytes(a.util.hexToBytes(c));if(n!==false){return _decodePkcs1_v1_5(p.getBytes(),t,r)}return p.getBytes()};u.rsa.createKeyPairGenerationState=function(e,t,r){if(typeof e==="string"){e=parseInt(e,10)}e=e||2048;r=r||{};var n=r.prng||a.random;var s={nextBytes:function(e){var t=n.getBytesSync(e.length);for(var r=0;r<e.length;++r){e[r]=t.charCodeAt(r)}}};var o=r.algorithm||"PRIMEINC";var u;if(o==="PRIMEINC"){u={algorithm:o,state:0,bits:e,rng:s,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null};u.e.fromInt(u.eInt)}else{throw new Error("Invalid key generation algorithm: "+o)}return u};u.rsa.stepKeyPairGenerationState=function(e,t){if(!("algorithm"in e)){e.algorithm="PRIMEINC"}var r=new i(null);r.fromInt(30);var a=0;var op_or=function(e,t){return e|t};var n=+new Date;var s;var o=0;while(e.keys===null&&(t<=0||o<t)){if(e.state===0){var c=e.p===null?e.pBits:e.qBits;var p=c-1;if(e.pqState===0){e.num=new i(c,e.rng);if(!e.num.testBit(p)){e.num.bitwiseTo(i.ONE.shiftLeft(p),op_or,e.num)}e.num.dAddOffset(31-e.num.mod(r).byteValue(),0);a=0;++e.pqState}else if(e.pqState===1){if(e.num.bitLength()>c){e.pqState=0}else if(e.num.isProbablePrime(_getMillerRabinTests(e.num.bitLength()))){++e.pqState}else{e.num.dAddOffset(l[a++%8],0)}}else if(e.pqState===2){e.pqState=e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)===0?3:0}else if(e.pqState===3){e.pqState=0;if(e.p===null){e.p=e.num}else{e.q=e.num}if(e.p!==null&&e.q!==null){++e.state}e.num=null}}else if(e.state===1){if(e.p.compareTo(e.q)<0){e.num=e.p;e.p=e.q;e.q=e.num}++e.state}else if(e.state===2){e.p1=e.p.subtract(i.ONE);e.q1=e.q.subtract(i.ONE);e.phi=e.p1.multiply(e.q1);++e.state}else if(e.state===3){if(e.phi.gcd(e.e).compareTo(i.ONE)===0){++e.state}else{e.p=null;e.q=null;e.state=0}}else if(e.state===4){e.n=e.p.multiply(e.q);if(e.n.bitLength()===e.bits){++e.state}else{e.q=null;e.state=0}}else if(e.state===5){var h=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,h,e.p,e.q,h.mod(e.p1),h.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)}}s=+new Date;o+=s-n;n=s}return e.keys!==null};u.rsa.generateKeyPair=function(e,t,r,i){if(arguments.length===1){if(typeof e==="object"){r=e;e=undefined}else if(typeof e==="function"){i=e;e=undefined}}else if(arguments.length===2){if(typeof e==="number"){if(typeof t==="function"){i=t;t=undefined}else if(typeof t!=="number"){r=t;t=undefined}}else{r=e;i=t;e=undefined;t=undefined}}else if(arguments.length===3){if(typeof t==="number"){if(typeof r==="function"){i=r;r=undefined}}else{i=r;r=t;t=undefined}}r=r||{};if(e===undefined){e=r.bits||2048}if(t===undefined){t=r.e||65537}if(!a.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(i){if(_detectNodeCrypto("generateKeyPair")){return n.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e){return i(e)}i(null,{privateKey:u.privateKeyFromPem(r),publicKey:u.publicKeyFromPem(t)})}))}if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey")){return o.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_intToUint8Array(t),hash:{name:"SHA-256"}},true,["sign","verify"]).then((function(e){return o.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(undefined,(function(e){i(e)})).then((function(e){if(e){var t=u.privateKeyFromAsn1(s.fromDer(a.util.createBuffer(e)));i(null,{privateKey:t,publicKey:u.setRsaPublicKey(t.n,t.e)})}}))}if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var l=o.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_intToUint8Array(t),hash:{name:"SHA-256"}},true,["sign","verify"]);l.oncomplete=function(e){var t=e.target.result;var r=o.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result;var r=u.privateKeyFromAsn1(s.fromDer(a.util.createBuffer(t)));i(null,{privateKey:r,publicKey:u.setRsaPublicKey(r.n,r.e)})};r.onerror=function(e){i(e)}};l.onerror=function(e){i(e)};return}}else{if(_detectNodeCrypto("generateKeyPairSync")){var c=n.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(c.privateKey),publicKey:u.publicKeyFromPem(c.publicKey)}}}}var p=u.rsa.createKeyPairGenerationState(e,t,r);if(!i){u.rsa.stepKeyPairGenerationState(p,0);return p.keys}_generateKeyPair(p,r,i)};u.setRsaPublicKey=u.rsa.setPublicKey=function(e,t){var r={n:e,e:t};r.encrypt=function(e,t,i){if(typeof t==="string"){t=t.toUpperCase()}else if(t===undefined){t="RSAES-PKCS1-V1_5"}if(t==="RSAES-PKCS1-V1_5"){t={encode:function(e,t,r){return _encodePkcs1_v1_5(e,t,2).getBytes()}}}else if(t==="RSA-OAEP"||t==="RSAES-OAEP"){t={encode:function(e,t){return a.pkcs1.encode_rsa_oaep(t,e,i)}}}else if(["RAW","NONE","NULL",null].indexOf(t)!==-1){t={encode:function(e){return e}}}else if(typeof t==="string"){throw new Error('Unsupported encryption scheme: "'+t+'".')}var n=t.encode(e,r,true);return u.rsa.encrypt(n,r,true)};r.verify=function(e,t,i,n){if(typeof i==="string"){i=i.toUpperCase()}else if(i===undefined){i="RSASSA-PKCS1-V1_5"}if(n===undefined){n={_parseAllDigestBytes:true}}if(!("_parseAllDigestBytes"in n)){n._parseAllDigestBytes=true}if(i==="RSASSA-PKCS1-V1_5"){i={verify:function(e,t){t=_decodePkcs1_v1_5(t,r,true);var i=s.fromDer(t,{parseAllBytes:n._parseAllDigestBytes});var o={};var u=[];if(!s.validate(i,g,o,u)){var l=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 "+"DigestInfo value.");l.errors=u;throw l}var c=s.derToOid(o.algorithmIdentifier);if(!(c===a.oids.md2||c===a.oids.md5||c===a.oids.sha1||c===a.oids.sha224||c===a.oids.sha256||c===a.oids.sha384||c===a.oids.sha512||c===a.oids["sha512-224"]||c===a.oids["sha512-256"])){var l=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");l.oid=c;throw l}if(c===a.oids.md2||c===a.oids.md5){if(!("parameters"in o)){throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 "+"DigestInfo value. "+"Missing algorithm identifer NULL parameters.")}}return e===o.digest}}}else if(i==="NONE"||i==="NULL"||i===null){i={verify:function(e,t){t=_decodePkcs1_v1_5(t,r,true);return e===t}}}var o=u.rsa.decrypt(t,r,true,false);return i.verify(e,o,r.n.bitLength())};return r};u.setRsaPrivateKey=u.rsa.setPrivateKey=function(e,t,r,i,n,s,o,l){var c={n:e,e:t,d:r,p:i,q:n,dP:s,dQ:o,qInv:l};c.decrypt=function(e,t,r){if(typeof t==="string"){t=t.toUpperCase()}else if(t===undefined){t="RSAES-PKCS1-V1_5"}var i=u.rsa.decrypt(e,c,false,false);if(t==="RSAES-PKCS1-V1_5"){t={decode:_decodePkcs1_v1_5}}else if(t==="RSA-OAEP"||t==="RSAES-OAEP"){t={decode:function(e,t){return a.pkcs1.decode_rsa_oaep(t,e,r)}}}else if(["RAW","NONE","NULL",null].indexOf(t)!==-1){t={decode:function(e){return e}}}else{throw new Error('Unsupported encryption scheme: "'+t+'".')}return t.decode(i,c,false)};c.sign=function(e,t){var r=false;if(typeof t==="string"){t=t.toUpperCase()}if(t===undefined||t==="RSASSA-PKCS1-V1_5"){t={encode:emsaPkcs1v15encode};r=1}else if(t==="NONE"||t==="NULL"||t===null){t={encode:function(){return e}};r=1}var a=t.encode(e,c.n.bitLength());return u.rsa.encrypt(a,c,r)};return c};u.wrapRsaPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,s.toDer(e).getBytes())])};u.privateKeyFromAsn1=function(e){var t={};var r=[];if(s.validate(e,c,t,r)){e=s.fromDer(a.util.createBuffer(t.privateKey))}t={};r=[];if(!s.validate(e,p,t,r)){var n=new Error("Cannot read private key. "+"ASN.1 object does not contain an RSAPrivateKey.");n.errors=r;throw n}var o,l,h,d,g,y,v,m;o=a.util.createBuffer(t.privateKeyModulus).toHex();l=a.util.createBuffer(t.privateKeyPublicExponent).toHex();h=a.util.createBuffer(t.privateKeyPrivateExponent).toHex();d=a.util.createBuffer(t.privateKeyPrime1).toHex();g=a.util.createBuffer(t.privateKeyPrime2).toHex();y=a.util.createBuffer(t.privateKeyExponent1).toHex();v=a.util.createBuffer(t.privateKeyExponent2).toHex();m=a.util.createBuffer(t.privateKeyCoefficient).toHex();return u.setRsaPrivateKey(new i(o,16),new i(l,16),new i(h,16),new i(d,16),new i(g,16),new i(y,16),new i(v,16),new i(m,16))};u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.qInv))])};u.publicKeyFromAsn1=function(e){var t={};var r=[];if(s.validate(e,d,t,r)){var n=s.derToOid(t.publicKeyOid);if(n!==u.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");o.oid=n;throw o}e=t.rsaPublicKey}r=[];if(!s.validate(e,h,t,r)){var o=new Error("Cannot read public key. "+"ASN.1 object does not contain an RSAPublicKey.");o.errors=r;throw o}var l=a.util.createBuffer(t.publicKeyModulus).toHex();var c=a.util.createBuffer(t.publicKeyExponent).toHex();return u.setRsaPublicKey(new i(l,16),new i(c,16))};u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,false,[u.publicKeyToRSAPublicKey(e)])])};u.publicKeyToRSAPublicKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.e))])};function _encodePkcs1_v1_5(e,t,r){var i=a.util.createBuffer();var n=Math.ceil(t.n.bitLength()/8);if(e.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");s.length=e.length;s.max=n-11;throw s}i.putByte(0);i.putByte(r);var o=n-3-e.length;var u;if(r===0||r===1){u=r===0?0:255;for(var l=0;l<o;++l){i.putByte(u)}}else{while(o>0){var c=0;var p=a.random.getBytes(o);for(var l=0;l<o;++l){u=p.charCodeAt(l);if(u===0){++c}else{i.putByte(u)}}o=c}}i.putByte(0);i.putBytes(e);return i}function _decodePkcs1_v1_5(e,t,r,i){var n=Math.ceil(t.n.bitLength()/8);var s=a.util.createBuffer(e);var o=s.getByte();var u=s.getByte();if(o!==0||r&&u!==0&&u!==1||!r&&u!=2||r&&u===0&&typeof i==="undefined"){throw new Error("Encryption block is invalid.")}var l=0;if(u===0){l=n-3-i;for(var c=0;c<l;++c){if(s.getByte()!==0){throw new Error("Encryption block is invalid.")}}}else if(u===1){l=0;while(s.length()>1){if(s.getByte()!==255){--s.read;break}++l}}else if(u===2){l=0;while(s.length()>1){if(s.getByte()===0){--s.read;break}++l}}var p=s.getByte();if(p!==0||l!==n-3-s.length()){throw new Error("Encryption block is invalid.")}return s.getBytes()}function _generateKeyPair(e,t,r){if(typeof t==="function"){r=t;t={}}t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};if("prng"in t){n.prng=t.prng}generate();function generate(){getPrime(e.pBits,(function(t,a){if(t){return r(t)}e.p=a;if(e.q!==null){return finish(t,e.q)}getPrime(e.qBits,finish)}))}function getPrime(e,t){a.prime.generateProbablePrime(e,n,t)}function finish(t,a){if(t){return r(t)}e.q=a;if(e.p.compareTo(e.q)<0){var n=e.p;e.p=e.q;e.q=n}if(e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)!==0){e.p=null;generate();return}if(e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)!==0){e.q=null;getPrime(e.qBits,finish);return}e.p1=e.p.subtract(i.ONE);e.q1=e.q.subtract(i.ONE);e.phi=e.p1.multiply(e.q1);if(e.phi.gcd(e.e).compareTo(i.ONE)!==0){e.p=e.q=null;generate();return}e.n=e.p.multiply(e.q);if(e.n.bitLength()!==e.bits){e.q=null;getPrime(e.qBits,finish);return}var s=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,s,e.p,e.q,s.mod(e.p1),s.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)};r(null,e.keys)}}function _bnToBytes(e){var t=e.toString(16);if(t[0]>="8"){t="00"+t}var r=a.util.hexToBytes(t);if(r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)){return r.substr(1)}return r}function _getMillerRabinTests(e){if(e<=100)return 27;if(e<=150)return 18;if(e<=200)return 15;if(e<=250)return 12;if(e<=300)return 9;if(e<=350)return 8;if(e<=400)return 7;if(e<=500)return 6;if(e<=600)return 5;if(e<=800)return 4;if(e<=1250)return 3;return 2}function _detectNodeCrypto(e){return a.util.isNodejs&&typeof n[e]==="function"}function _detectSubtleCrypto(e){return typeof o.globalScope!=="undefined"&&typeof o.globalScope.crypto==="object"&&typeof o.globalScope.crypto.subtle==="object"&&typeof o.globalScope.crypto.subtle[e]==="function"}function _detectSubtleMsCrypto(e){return typeof o.globalScope!=="undefined"&&typeof o.globalScope.msCrypto==="object"&&typeof o.globalScope.msCrypto.subtle==="object"&&typeof o.globalScope.msCrypto.subtle[e]==="function"}function _intToUint8Array(e){var t=a.util.hexToBytes(e.toString(16));var r=new Uint8Array(t.length);for(var i=0;i<t.length;++i){r[i]=t.charCodeAt(i)}return r}function _privateKeyFromJwk(e){if(e.kty!=="RSA"){throw new Error('Unsupported key algorithm "'+e.kty+'"; algorithm must be "RSA".')}return u.setRsaPrivateKey(_base64ToBigInt(e.n),_base64ToBigInt(e.e),_base64ToBigInt(e.d),_base64ToBigInt(e.p),_base64ToBigInt(e.q),_base64ToBigInt(e.dp),_base64ToBigInt(e.dq),_base64ToBigInt(e.qi))}function _publicKeyFromJwk(e){if(e.kty!=="RSA"){throw new Error('Key algorithm must be "RSA".')}return u.setRsaPublicKey(_base64ToBigInt(e.n),_base64ToBigInt(e.e))}function _base64ToBigInt(e){return new i(a.util.bytesToHex(a.util.decode64(e)),16)}},241:function(e,t,r){var a=r(809);r(5);r(362);var i=e.exports=a.sha1=a.sha1||{};a.md.sha1=a.md.algorithms.sha1=i;i.create=function(){if(!s){_init()}var e=null;var t=a.util.createBuffer();var r=new Array(80);var i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};i.start=function(){i.messageLength=0;i.fullMessageLength=i.messageLength64=[];var r=i.messageLengthSize/4;for(var n=0;n<r;++n){i.fullMessageLength.push(0)}t=a.util.createBuffer();e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return i};i.start();i.update=function(n,s){if(s==="utf8"){n=a.util.encodeUtf8(n)}var o=n.length;i.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u){i.fullMessageLength[u]+=o[1];o[1]=o[0]+(i.fullMessageLength[u]/4294967296>>>0);i.fullMessageLength[u]=i.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(n);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return i};i.digest=function(){var s=a.util.createBuffer();s.putBytes(t.bytes());var o=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize;var u=o&i.blockLength-1;s.putBytes(n.substr(0,i.blockLength-u));var l,c;var p=i.fullMessageLength[0]*8;for(var h=0;h<i.fullMessageLength.length-1;++h){l=i.fullMessageLength[h+1]*8;c=l/4294967296>>>0;p+=c;s.putInt32(p>>>0);p=l>>>0}s.putInt32(p);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};_update(d,r,s);var g=a.util.createBuffer();g.putInt32(d.h0);g.putInt32(d.h1);g.putInt32(d.h2);g.putInt32(d.h3);g.putInt32(d.h4);return g};return i};var n=null;var s=false;function _init(){n=String.fromCharCode(128);n+=a.util.fillString(String.fromCharCode(0),64);s=true}function _update(e,t,r){var a,i,n,s,o,u,l,c;var p=r.length();while(p>=64){i=e.h0;n=e.h1;s=e.h2;o=e.h3;u=e.h4;for(c=0;c<16;++c){a=r.getInt32();t[c]=a;l=o^n&(s^o);a=(i<<5|i>>>27)+l+u+1518500249+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}for(;c<20;++c){a=t[c-3]^t[c-8]^t[c-14]^t[c-16];a=a<<1|a>>>31;t[c]=a;l=o^n&(s^o);a=(i<<5|i>>>27)+l+u+1518500249+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}for(;c<32;++c){a=t[c-3]^t[c-8]^t[c-14]^t[c-16];a=a<<1|a>>>31;t[c]=a;l=n^s^o;a=(i<<5|i>>>27)+l+u+1859775393+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}for(;c<40;++c){a=t[c-6]^t[c-16]^t[c-28]^t[c-32];a=a<<2|a>>>30;t[c]=a;l=n^s^o;a=(i<<5|i>>>27)+l+u+1859775393+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}for(;c<60;++c){a=t[c-6]^t[c-16]^t[c-28]^t[c-32];a=a<<2|a>>>30;t[c]=a;l=n&s|o&(n^s);a=(i<<5|i>>>27)+l+u+2400959708+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}for(;c<80;++c){a=t[c-6]^t[c-16]^t[c-28]^t[c-32];a=a<<2|a>>>30;t[c]=a;l=n^s^o;a=(i<<5|i>>>27)+l+u+3395469782+a;u=o;o=s;s=(n<<30|n>>>2)>>>0;n=i;i=a}e.h0=e.h0+i|0;e.h1=e.h1+n|0;e.h2=e.h2+s|0;e.h3=e.h3+o|0;e.h4=e.h4+u|0;p-=64}}},358:function(e,t,r){var a=r(809);r(5);r(362);var i=e.exports=a.sha256=a.sha256||{};a.md.sha256=a.md.algorithms.sha256=i;i.create=function(){if(!s){_init()}var e=null;var t=a.util.createBuffer();var r=new Array(64);var i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};i.start=function(){i.messageLength=0;i.fullMessageLength=i.messageLength64=[];var r=i.messageLengthSize/4;for(var n=0;n<r;++n){i.fullMessageLength.push(0)}t=a.util.createBuffer();e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return i};i.start();i.update=function(n,s){if(s==="utf8"){n=a.util.encodeUtf8(n)}var o=n.length;i.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u){i.fullMessageLength[u]+=o[1];o[1]=o[0]+(i.fullMessageLength[u]/4294967296>>>0);i.fullMessageLength[u]=i.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(n);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return i};i.digest=function(){var s=a.util.createBuffer();s.putBytes(t.bytes());var o=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize;var u=o&i.blockLength-1;s.putBytes(n.substr(0,i.blockLength-u));var l,c;var p=i.fullMessageLength[0]*8;for(var h=0;h<i.fullMessageLength.length-1;++h){l=i.fullMessageLength[h+1]*8;c=l/4294967296>>>0;p+=c;s.putInt32(p>>>0);p=l>>>0}s.putInt32(p);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};_update(d,r,s);var g=a.util.createBuffer();g.putInt32(d.h0);g.putInt32(d.h1);g.putInt32(d.h2);g.putInt32(d.h3);g.putInt32(d.h4);g.putInt32(d.h5);g.putInt32(d.h6);g.putInt32(d.h7);return g};return i};var n=null;var s=false;var o=null;function _init(){n=String.fromCharCode(128);n+=a.util.fillString(String.fromCharCode(0),64);o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];s=true}function _update(e,t,r){var a,i,n,s,u,l,c,p,h,d,g,y,v,m,C;var E=r.length();while(E>=64){for(c=0;c<16;++c){t[c]=r.getInt32()}for(;c<64;++c){a=t[c-2];a=(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10;i=t[c-15];i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3;t[c]=a+t[c-7]+i+t[c-16]|0}p=e.h0;h=e.h1;d=e.h2;g=e.h3;y=e.h4;v=e.h5;m=e.h6;C=e.h7;for(c=0;c<64;++c){s=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7);u=m^y&(v^m);n=(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10);l=p&h|d&(p^h);a=C+s+u+o[c]+t[c];i=n+l;C=m;m=v;v=y;y=g+a>>>0;g=d;d=h;h=p;p=a+i>>>0}e.h0=e.h0+p|0;e.h1=e.h1+h|0;e.h2=e.h2+d|0;e.h3=e.h3+g|0;e.h4=e.h4+y|0;e.h5=e.h5+v|0;e.h6=e.h6+m|0;e.h7=e.h7+C|0;E-=64}}},189:function(e,t,r){var a=r(809);r(5);r(362);var i=e.exports=a.sha512=a.sha512||{};a.md.sha512=a.md.algorithms.sha512=i;var n=a.sha384=a.sha512.sha384=a.sha512.sha384||{};n.create=function(){return i.create("SHA-384")};a.md.sha384=a.md.algorithms.sha384=n;a.sha512.sha256=a.sha512.sha256||{create:function(){return i.create("SHA-512/256")}};a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256;a.sha512.sha224=a.sha512.sha224||{create:function(){return i.create("SHA-512/224")}};a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224;i.create=function(e){if(!o){_init()}if(typeof e==="undefined"){e="SHA-512"}if(!(e in l)){throw new Error("Invalid SHA-512 algorithm: "+e)}var t=l[e];var r=null;var i=a.util.createBuffer();var n=new Array(80);for(var u=0;u<80;++u){n[u]=new Array(2)}var c=64;switch(e){case"SHA-384":c=48;break;case"SHA-512/256":c=32;break;case"SHA-512/224":c=28;break}var p={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:c,messageLength:0,fullMessageLength:null,messageLengthSize:16};p.start=function(){p.messageLength=0;p.fullMessageLength=p.messageLength128=[];var e=p.messageLengthSize/4;for(var n=0;n<e;++n){p.fullMessageLength.push(0)}i=a.util.createBuffer();r=new Array(t.length);for(var n=0;n<t.length;++n){r[n]=t[n].slice(0)}return p};p.start();p.update=function(e,t){if(t==="utf8"){e=a.util.encodeUtf8(e)}var s=e.length;p.messageLength+=s;s=[s/4294967296>>>0,s>>>0];for(var o=p.fullMessageLength.length-1;o>=0;--o){p.fullMessageLength[o]+=s[1];s[1]=s[0]+(p.fullMessageLength[o]/4294967296>>>0);p.fullMessageLength[o]=p.fullMessageLength[o]>>>0;s[0]=s[1]/4294967296>>>0}i.putBytes(e);_update(r,n,i);if(i.read>2048||i.length()===0){i.compact()}return p};p.digest=function(){var t=a.util.createBuffer();t.putBytes(i.bytes());var o=p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize;var u=o&p.blockLength-1;t.putBytes(s.substr(0,p.blockLength-u));var l,c;var h=p.fullMessageLength[0]*8;for(var d=0;d<p.fullMessageLength.length-1;++d){l=p.fullMessageLength[d+1]*8;c=l/4294967296>>>0;h+=c;t.putInt32(h>>>0);h=l>>>0}t.putInt32(h);var g=new Array(r.length);for(var d=0;d<r.length;++d){g[d]=r[d].slice(0)}_update(g,n,t);var y=a.util.createBuffer();var v;if(e==="SHA-512"){v=g.length}else if(e==="SHA-384"){v=g.length-2}else{v=g.length-4}for(var d=0;d<v;++d){y.putInt32(g[d][0]);if(d!==v-1||e!=="SHA-512/224"){y.putInt32(g[d][1])}}return y};return p};var s=null;var o=false;var u=null;var l=null;function _init(){s=String.fromCharCode(128);s+=a.util.fillString(String.fromCharCode(0),128);u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]];l={};l["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]];l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]];l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]];l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]];o=true}function _update(e,t,r){var a,i;var n,s;var o,l;var c,p;var h,d;var g,y;var v,m;var C,E;var I,T;var b,B;var _,N;var w,R;var k,L;var U,D;var P,V,O,K,x,F,q;var H=r.length();while(H>=128){for(P=0;P<16;++P){t[P][0]=r.getInt32()>>>0;t[P][1]=r.getInt32()>>>0}for(;P<80;++P){K=t[P-2];V=K[0];O=K[1];a=((V>>>19|O<<13)^(O>>>29|V<<3)^V>>>6)>>>0;i=((V<<13|O>>>19)^(O<<3|V>>>29)^(V<<26|O>>>6))>>>0;F=t[P-15];V=F[0];O=F[1];n=((V>>>1|O<<31)^(V>>>8|O<<24)^V>>>7)>>>0;s=((V<<31|O>>>1)^(V<<24|O>>>8)^(V<<25|O>>>7))>>>0;x=t[P-7];q=t[P-16];O=i+x[1]+s+q[1];t[P][0]=a+x[0]+n+q[0]+(O/4294967296>>>0)>>>0;t[P][1]=O>>>0}v=e[0][0];m=e[0][1];C=e[1][0];E=e[1][1];I=e[2][0];T=e[2][1];b=e[3][0];B=e[3][1];_=e[4][0];N=e[4][1];w=e[5][0];R=e[5][1];k=e[6][0];L=e[6][1];U=e[7][0];D=e[7][1];for(P=0;P<80;++P){c=((_>>>14|N<<18)^(_>>>18|N<<14)^(N>>>9|_<<23))>>>0;p=((_<<18|N>>>14)^(_<<14|N>>>18)^(N<<23|_>>>9))>>>0;h=(k^_&(w^k))>>>0;d=(L^N&(R^L))>>>0;o=((v>>>28|m<<4)^(m>>>2|v<<30)^(m>>>7|v<<25))>>>0;l=((v<<4|m>>>28)^(m<<30|v>>>2)^(m<<25|v>>>7))>>>0;g=(v&C|I&(v^C))>>>0;y=(m&E|T&(m^E))>>>0;O=D+p+d+u[P][1]+t[P][1];a=U+c+h+u[P][0]+t[P][0]+(O/4294967296>>>0)>>>0;i=O>>>0;O=l+y;n=o+g+(O/4294967296>>>0)>>>0;s=O>>>0;U=k;D=L;k=w;L=R;w=_;R=N;O=B+i;_=b+a+(O/4294967296>>>0)>>>0;N=O>>>0;b=I;B=T;I=C;T=E;C=v;E=m;O=i+s;v=a+n+(O/4294967296>>>0)>>>0;m=O>>>0}O=e[0][1]+m;e[0][0]=e[0][0]+v+(O/4294967296>>>0)>>>0;e[0][1]=O>>>0;O=e[1][1]+E;e[1][0]=e[1][0]+C+(O/4294967296>>>0)>>>0;e[1][1]=O>>>0;O=e[2][1]+T;e[2][0]=e[2][0]+I+(O/4294967296>>>0)>>>0;e[2][1]=O>>>0;O=e[3][1]+B;e[3][0]=e[3][0]+b+(O/4294967296>>>0)>>>0;e[3][1]=O>>>0;O=e[4][1]+N;e[4][0]=e[4][0]+_+(O/4294967296>>>0)>>>0;e[4][1]=O>>>0;O=e[5][1]+R;e[5][0]=e[5][0]+w+(O/4294967296>>>0)>>>0;e[5][1]=O>>>0;O=e[6][1]+L;e[6][0]=e[6][0]+k+(O/4294967296>>>0)>>>0;e[6][1]=O>>>0;O=e[7][1]+D;e[7][0]=e[7][0]+U+(O/4294967296>>>0)>>>0;e[7][1]=O>>>0;H-=128}}},740:function(e,t,r){var a=r(809);r(801);r(787);r(212);r(241);r(362);var i=e.exports=a.ssh=a.ssh||{};i.privateKeyToPutty=function(e,t,r){r=r||"";t=t||"";var i="ssh-rsa";var n=t===""?"none":"aes256-cbc";var s="PuTTY-User-Key-File-2: "+i+"\r\n";s+="Encryption: "+n+"\r\n";s+="Comment: "+r+"\r\n";var o=a.util.createBuffer();_addStringToBuffer(o,i);_addBigIntegerToBuffer(o,e.e);_addBigIntegerToBuffer(o,e.n);var u=a.util.encode64(o.bytes(),64);var l=Math.floor(u.length/66)+1;s+="Public-Lines: "+l+"\r\n";s+=u;var c=a.util.createBuffer();_addBigIntegerToBuffer(c,e.d);_addBigIntegerToBuffer(c,e.p);_addBigIntegerToBuffer(c,e.q);_addBigIntegerToBuffer(c,e.qInv);var p;if(!t){p=a.util.encode64(c.bytes(),64)}else{var h=c.length()+16-1;h-=h%16;var d=_sha1(c.bytes());d.truncate(d.length()-h+c.length());c.putBuffer(d);var g=a.util.createBuffer();g.putBuffer(_sha1("\0\0\0\0",t));g.putBuffer(_sha1("\0\0\0",t));var y=a.aes.createEncryptionCipher(g.truncate(8),"CBC");y.start(a.util.createBuffer().fillWithByte(0,16));y.update(c.copy());y.finish();var v=y.output;v.truncate(16);p=a.util.encode64(v.bytes(),64)}l=Math.floor(p.length/66)+1;s+="\r\nPrivate-Lines: "+l+"\r\n";s+=p;var m=_sha1("putty-private-key-file-mac-key",t);var C=a.util.createBuffer();_addStringToBuffer(C,i);_addStringToBuffer(C,n);_addStringToBuffer(C,r);C.putInt32(o.length());C.putBuffer(o);C.putInt32(c.length());C.putBuffer(c);var E=a.hmac.create();E.start("sha1",m);E.update(C.bytes());s+="\r\nPrivate-MAC: "+E.digest().toHex()+"\r\n";return s};i.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var i=a.util.createBuffer();_addStringToBuffer(i,r);_addBigIntegerToBuffer(i,e.e);_addBigIntegerToBuffer(i,e.n);return r+" "+a.util.encode64(i.bytes())+" "+t};i.privateKeyToOpenSSH=function(e,t){if(!t){return a.pki.privateKeyToPem(e)}return a.pki.encryptRsaPrivateKey(e,t,{legacy:true,algorithm:"aes128"})};i.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||a.md.md5.create();var i="ssh-rsa";var n=a.util.createBuffer();_addStringToBuffer(n,i);_addBigIntegerToBuffer(n,e.e);_addBigIntegerToBuffer(n,e.n);r.start();r.update(n.getBytes());var s=r.digest();if(t.encoding==="hex"){var o=s.toHex();if(t.delimiter){return o.match(/.{2}/g).join(t.delimiter)}return o}else if(t.encoding==="binary"){return s.getBytes()}else if(t.encoding){throw new Error('Unknown encoding "'+t.encoding+'".')}return s};function _addBigIntegerToBuffer(e,t){var r=t.toString(16);if(r[0]>="8"){r="00"+r}var i=a.util.hexToBytes(r);e.putInt32(i.length);e.putBytes(i)}function _addStringToBuffer(e,t){e.putInt32(t.length);e.putString(t)}function _sha1(){var e=a.md.sha1.create();var t=arguments.length;for(var r=0;r<t;++r){e.update(arguments[r])}return e.digest()}},486:function(e,t,r){var a=r(809);r(446);r(787);r(212);r(227);r(886);r(394);r(241);r(362);var prf_TLS1=function(e,t,r,i){var n=a.util.createBuffer();var s=e.length>>1;var o=s+(e.length&1);var u=e.substr(0,o);var l=e.substr(s,o);var c=a.util.createBuffer();var p=a.hmac.create();r=t+r;var h=Math.ceil(i/16);var d=Math.ceil(i/20);p.start("MD5",u);var g=a.util.createBuffer();c.putBytes(r);for(var y=0;y<h;++y){p.start(null,null);p.update(c.getBytes());c.putBuffer(p.digest());p.start(null,null);p.update(c.bytes()+r);g.putBuffer(p.digest())}p.start("SHA1",l);var v=a.util.createBuffer();c.clear();c.putBytes(r);for(var y=0;y<d;++y){p.start(null,null);p.update(c.getBytes());c.putBuffer(p.digest());p.start(null,null);p.update(c.bytes()+r);v.putBuffer(p.digest())}n.putBytes(a.util.xorBytes(g.getBytes(),v.getBytes(),i));return n};var prf_sha256=function(e,t,r,a){};var hmac_sha1=function(e,t,r){var i=a.hmac.create();i.start("SHA1",e);var n=a.util.createBuffer();n.putInt32(t[0]);n.putInt32(t[1]);n.putByte(r.type);n.putByte(r.version.major);n.putByte(r.version.minor);n.putInt16(r.length);n.putBytes(r.fragment.bytes());i.update(n.getBytes());return i.digest().getBytes()};var deflate=function(e,t,r){var i=false;try{var n=e.deflate(t.fragment.getBytes());t.fragment=a.util.createBuffer(n);t.length=n.length;i=true}catch(e){}return i};var inflate=function(e,t,r){var i=false;try{var n=e.inflate(t.fragment.getBytes());t.fragment=a.util.createBuffer(n);t.length=n.length;i=true}catch(e){}return i};var readVector=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32();break}return a.util.createBuffer(e.getBytes(r))};var writeVector=function(e,t,r){e.putInt(r.length(),t<<3);e.putBuffer(r)};var i={};i.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};i.SupportedVersions=[i.Versions.TLS_1_1,i.Versions.TLS_1_0];i.Version=i.SupportedVersions[0];i.MaxFragment=16384-1024;i.ConnectionEnd={server:0,client:1};i.PRFAlgorithm={tls_prf_sha256:0};i.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};i.CipherType={stream:0,block:1,aead:2};i.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};i.CompressionMethod={none:0,deflate:1};i.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};i.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};i.Alert={};i.Alert.Level={warning:1,fatal:2};i.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};i.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};i.CipherSuites={};i.getCipherSuite=function(e){var t=null;for(var r in i.CipherSuites){var a=i.CipherSuites[r];if(a.id[0]===e.charCodeAt(0)&&a.id[1]===e.charCodeAt(1)){t=a;break}}return t};i.handleUnexpected=function(e,t){var r=!e.open&&e.entity===i.ConnectionEnd.client;if(!r){e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})}};i.handleHelloRequest=function(e,t,r){if(!e.handshaking&&e.handshakes>0){i.queue(e,i.createAlert(e,{level:i.Alert.Level.warning,description:i.Alert.Description.no_renegotiation}));i.flush(e)}e.process()};i.parseHelloMessage=function(e,t,r){var n=null;var s=e.entity===i.ConnectionEnd.client;if(r<38){e.error(e,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}else{var o=t.fragment;var u=o.length();n={version:{major:o.getByte(),minor:o.getByte()},random:a.util.createBuffer(o.getBytes(32)),session_id:readVector(o,1),extensions:[]};if(s){n.cipher_suite=o.getBytes(2);n.compression_method=o.getByte()}else{n.cipher_suites=readVector(o,2);n.compression_methods=readVector(o,1)}u=r-(u-o.length());if(u>0){var l=readVector(o,2);while(l.length()>0){n.extensions.push({type:[l.getByte(),l.getByte()],data:readVector(l,2)})}if(!s){for(var c=0;c<n.extensions.length;++c){var p=n.extensions[c];if(p.type[0]===0&&p.type[1]===0){var h=readVector(p.data,2);while(h.length()>0){var d=h.getByte();if(d!==0){break}e.session.extensions.server_name.serverNameList.push(readVector(h,2).getBytes())}}}}}if(e.session.version){if(n.version.major!==e.session.version.major||n.version.minor!==e.session.version.minor){return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}})}}if(s){e.session.cipherSuite=i.getCipherSuite(n.cipher_suite)}else{var g=a.util.createBuffer(n.cipher_suites.bytes());while(g.length()>0){e.session.cipherSuite=i.getCipherSuite(g.getBytes(2));if(e.session.cipherSuite!==null){break}}}if(e.session.cipherSuite===null){return e.error(e,{message:"No cipher suites in common.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(n.cipher_suite)})}if(s){e.session.compressionMethod=n.compression_method}else{e.session.compressionMethod=i.CompressionMethod.none}}return n};i.createSecurityParameters=function(e,t){var r=e.entity===i.ConnectionEnd.client;var a=t.random.bytes();var n=r?e.session.sp.client_random:a;var s=r?a:i.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:i.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:s}};i.handleServerHello=function(e,t,r){var a=i.parseHelloMessage(e,t,r);if(e.fail){return}if(a.version.minor<=e.version.minor){e.version.minor=a.version.minor}else{return e.error(e,{message:"Incompatible TLS version.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}})}e.session.version=e.version;var n=a.session_id.bytes();if(n.length>0&&n===e.session.id){e.expect=c;e.session.resuming=true;e.session.sp.server_random=a.random.bytes()}else{e.expect=s;e.session.resuming=false;i.createSecurityParameters(e,a)}e.session.id=n;e.process()};i.handleClientHello=function(e,t,r){var n=i.parseHelloMessage(e,t,r);if(e.fail){return}var s=n.session_id.bytes();var o=null;if(e.sessionCache){o=e.sessionCache.getSession(s);if(o===null){s=""}else if(o.version.major!==n.version.major||o.version.minor>n.version.minor){o=null;s=""}}if(s.length===0){s=a.random.getBytes(32)}e.session.id=s;e.session.clientHelloVersion=n.version;e.session.sp={};if(o){e.version=e.session.version=o.version;e.session.sp=o.sp}else{var u;for(var l=1;l<i.SupportedVersions.length;++l){u=i.SupportedVersions[l];if(u.minor<=n.version.minor){break}}e.version={major:u.major,minor:u.minor};e.session.version=e.version}if(o!==null){e.expect=C;e.session.resuming=true;e.session.sp.client_random=n.random.bytes()}else{e.expect=e.verifyClient!==false?y:v;e.session.resuming=false;i.createSecurityParameters(e,n)}e.open=true;i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createServerHello(e)}));if(e.session.resuming){i.queue(e,i.createRecord(e,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()}));e.state.pending=i.createConnectionState(e);e.state.current.write=e.state.pending.write;i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createFinished(e)}))}else{i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createCertificate(e)}));if(!e.fail){i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createServerKeyExchange(e)}));if(e.verifyClient!==false){i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createCertificateRequest(e)}))}i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createServerHelloDone(e)}))}}i.flush(e);e.process()};i.handleCertificate=function(e,t,r){if(r<3){return e.error(e,{message:"Invalid Certificate message. Message too short.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}var n=t.fragment;var s={certificate_list:readVector(n,3)};var u,l;var c=[];try{while(s.certificate_list.length()>0){u=readVector(s.certificate_list,3);l=a.asn1.fromDer(u);u=a.pki.certificateFromAsn1(l,true);c.push(u)}}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}var p=e.entity===i.ConnectionEnd.client;if((p||e.verifyClient===true)&&c.length===0){e.error(e,{message:p?"No server certificate provided.":"No client certificate provided.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}else if(c.length===0){e.expect=p?o:v}else{if(p){e.session.serverCertificate=c[0]}else{e.session.clientCertificate=c[0]}if(i.verifyCertificateChain(e,c)){e.expect=p?o:v}}e.process()};i.handleServerKeyExchange=function(e,t,r){if(r>0){return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}})}e.expect=u;e.process()};i.handleClientKeyExchange=function(e,t,r){if(r<48){return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}})}var n=t.fragment;var s={enc_pre_master_secret:readVector(n,2).getBytes()};var o=null;if(e.getPrivateKey){try{o=e.getPrivateKey(e,e.session.serverCertificate);o=a.pki.privateKeyFromPem(o)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}}if(o===null){return e.error(e,{message:"No private key set.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}try{var u=e.session.sp;u.pre_master_secret=o.decrypt(s.enc_pre_master_secret);var l=e.session.clientHelloVersion;if(l.major!==u.pre_master_secret.charCodeAt(0)||l.minor!==u.pre_master_secret.charCodeAt(1)){throw new Error("TLS version rollback attack detected.")}}catch(e){u.pre_master_secret=a.random.getBytes(48)}e.expect=C;if(e.session.clientCertificate!==null){e.expect=m}e.process()};i.handleCertificateRequest=function(e,t,r){if(r<3){return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}var a=t.fragment;var n={certificate_types:readVector(a,1),certificate_authorities:readVector(a,2)};e.session.certificateRequest=n;e.expect=l;e.process()};i.handleCertificateVerify=function(e,t,r){if(r<2){return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}var n=t.fragment;n.read-=4;var s=n.bytes();n.read+=4;var o={signature:readVector(n,2).getBytes()};var u=a.util.createBuffer();u.putBuffer(e.session.md5.digest());u.putBuffer(e.session.sha1.digest());u=u.getBytes();try{var l=e.session.clientCertificate;if(!l.publicKey.verify(u,o.signature,"NONE")){throw new Error("CertificateVerify signature does not match.")}e.session.md5.update(s);e.session.sha1.update(s)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure}})}e.expect=C;e.process()};i.handleServerHelloDone=function(e,t,r){if(r>0){return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.record_overflow}})}if(e.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.insufficient_security}};var s=0;var o=e.verify(e,n.alert.description,s,[]);if(o!==true){if(o||o===0){if(typeof o==="object"&&!a.util.isArray(o)){if(o.message){n.message=o.message}if(o.alert){n.alert.description=o.alert}}else if(typeof o==="number"){n.alert.description=o}}return e.error(e,n)}}if(e.session.certificateRequest!==null){t=i.createRecord(e,{type:i.ContentType.handshake,data:i.createCertificate(e)});i.queue(e,t)}t=i.createRecord(e,{type:i.ContentType.handshake,data:i.createClientKeyExchange(e)});i.queue(e,t);e.expect=d;var callback=function(e,t){if(e.session.certificateRequest!==null&&e.session.clientCertificate!==null){i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createCertificateVerify(e,t)}))}i.queue(e,i.createRecord(e,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()}));e.state.pending=i.createConnectionState(e);e.state.current.write=e.state.pending.write;i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createFinished(e)}));e.expect=c;i.flush(e);e.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null){return callback(e,null)}i.getClientSignature(e,callback)};i.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1){return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}})}var r=e.entity===i.ConnectionEnd.client;if(e.session.resuming&&r||!e.session.resuming&&!r){e.state.pending=i.createConnectionState(e)}e.state.current.read=e.state.pending.read;if(!e.session.resuming&&r||e.session.resuming&&!r){e.state.pending=null}e.expect=r?p:E;e.process()};i.handleFinished=function(e,t,r){var n=t.fragment;n.read-=4;var s=n.bytes();n.read+=4;var o=t.fragment.getBytes();n=a.util.createBuffer();n.putBuffer(e.session.md5.digest());n.putBuffer(e.session.sha1.digest());var u=e.entity===i.ConnectionEnd.client;var l=u?"server finished":"client finished";var c=e.session.sp;var p=12;var d=prf_TLS1;n=d(c.master_secret,l,n.getBytes(),p);if(n.getBytes()!==o){return e.error(e,{message:"Invalid verify_data in Finished message.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decrypt_error}})}e.session.md5.update(s);e.session.sha1.update(s);if(e.session.resuming&&u||!e.session.resuming&&!u){i.queue(e,i.createRecord(e,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()}));e.state.current.write=e.state.pending.write;e.state.pending=null;i.queue(e,i.createRecord(e,{type:i.ContentType.handshake,data:i.createFinished(e)}))}e.expect=u?h:I;e.handshaking=false;++e.handshakes;e.peerCertificate=u?e.session.serverCertificate:e.session.clientCertificate;i.flush(e);e.isConnected=true;e.connected(e);e.process()};i.handleAlert=function(e,t){var r=t.fragment;var a={level:r.getByte(),description:r.getByte()};var n;switch(a.description){case i.Alert.Description.close_notify:n="Connection closed.";break;case i.Alert.Description.unexpected_message:n="Unexpected message.";break;case i.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case i.Alert.Description.decryption_failed:n="Decryption failed.";break;case i.Alert.Description.record_overflow:n="Record overflow.";break;case i.Alert.Description.decompression_failure:n="Decompression failed.";break;case i.Alert.Description.handshake_failure:n="Handshake failure.";break;case i.Alert.Description.bad_certificate:n="Bad certificate.";break;case i.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case i.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case i.Alert.Description.certificate_expired:n="Certificate expired.";break;case i.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case i.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case i.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case i.Alert.Description.access_denied:n="Access denied.";break;case i.Alert.Description.decode_error:n="Decode error.";break;case i.Alert.Description.decrypt_error:n="Decrypt error.";break;case i.Alert.Description.export_restriction:n="Export restriction.";break;case i.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case i.Alert.Description.insufficient_security:n="Insufficient security.";break;case i.Alert.Description.internal_error:n="Internal error.";break;case i.Alert.Description.user_canceled:n="User canceled.";break;case i.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(a.description===i.Alert.Description.close_notify){return e.close()}e.error(e,{message:n,send:false,origin:e.entity===i.ConnectionEnd.client?"server":"client",alert:a});e.process()};i.handleHandshake=function(e,t){var r=t.fragment;var n=r.getByte();var s=r.getInt24();if(s>r.length()){e.fragmented=t;t.fragment=a.util.createBuffer();r.read-=4;return e.process()}e.fragmented=null;r.read-=4;var o=r.bytes(s+4);r.read+=4;if(n in x[e.entity][e.expect]){if(e.entity===i.ConnectionEnd.server&&!e.open&&!e.fail){e.handshaking=true;e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}}if(n!==i.HandshakeType.hello_request&&n!==i.HandshakeType.certificate_verify&&n!==i.HandshakeType.finished){e.session.md5.update(o);e.session.sha1.update(o)}x[e.entity][e.expect][n](e,t,s)}else{i.handleUnexpected(e,t)}};i.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment);e.dataReady(e);e.process()};i.handleHeartbeat=function(e,t){var r=t.fragment;var n=r.getByte();var s=r.getInt16();var o=r.getBytes(s);if(n===i.HeartbeatMessageType.heartbeat_request){if(e.handshaking||s>o.length){return e.process()}i.queue(e,i.createRecord(e,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_response,o)}));i.flush(e)}else if(n===i.HeartbeatMessageType.heartbeat_response){if(o!==e.expectedHeartbeatPayload){return e.process()}if(e.heartbeatReceived){e.heartbeatReceived(e,a.util.createBuffer(o))}}e.process()};var n=0;var s=1;var o=2;var u=3;var l=4;var c=5;var p=6;var h=7;var d=8;var g=0;var y=1;var v=2;var m=3;var C=4;var E=5;var I=6;var T=7;var b=i.handleUnexpected;var B=i.handleChangeCipherSpec;var _=i.handleAlert;var N=i.handleHandshake;var w=i.handleApplicationData;var R=i.handleHeartbeat;var k=[];k[i.ConnectionEnd.client]=[[b,_,N,b,R],[b,_,N,b,R],[b,_,N,b,R],[b,_,N,b,R],[b,_,N,b,R],[B,_,b,b,R],[b,_,N,b,R],[b,_,N,w,R],[b,_,N,b,R]];k[i.ConnectionEnd.server]=[[b,_,N,b,R],[b,_,N,b,R],[b,_,N,b,R],[b,_,N,b,R],[B,_,b,b,R],[b,_,N,b,R],[b,_,N,w,R],[b,_,N,b,R]];var L=i.handleHelloRequest;var U=i.handleServerHello;var D=i.handleCertificate;var P=i.handleServerKeyExchange;var V=i.handleCertificateRequest;var O=i.handleServerHelloDone;var K=i.handleFinished;var x=[];x[i.ConnectionEnd.client]=[[b,b,U,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,D,P,V,O,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,P,V,O,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,V,O,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,O,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,K],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[L,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b]];var F=i.handleClientHello;var q=i.handleClientKeyExchange;var H=i.handleCertificateVerify;x[i.ConnectionEnd.server]=[[b,F,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,D,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,q,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,H,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,K],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b]];i.generateKeys=function(e,t){var r=prf_TLS1;var a=t.client_random+t.server_random;if(!e.session.resuming){t.master_secret=r(t.pre_master_secret,"master secret",a,48).bytes();t.pre_master_secret=null}a=t.server_random+t.client_random;var n=2*t.mac_key_length+2*t.enc_key_length;var s=e.version.major===i.Versions.TLS_1_0.major&&e.version.minor===i.Versions.TLS_1_0.minor;if(s){n+=2*t.fixed_iv_length}var o=r(t.master_secret,"key expansion",a,n);var u={client_write_MAC_key:o.getBytes(t.mac_key_length),server_write_MAC_key:o.getBytes(t.mac_key_length),client_write_key:o.getBytes(t.enc_key_length),server_write_key:o.getBytes(t.enc_key_length)};if(s){u.client_write_IV=o.getBytes(t.fixed_iv_length);u.server_write_IV=o.getBytes(t.fixed_iv_length)}return u};i.createConnectionState=function(e){var t=e.entity===i.ConnectionEnd.client;var createMode=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return true},compressionState:null,compressFunction:function(e){return true},updateSequenceNumber:function(){if(e.sequenceNumber[1]===4294967295){e.sequenceNumber[1]=0;++e.sequenceNumber[0]}else{++e.sequenceNumber[1]}}};return e};var r={read:createMode(),write:createMode()};r.read.update=function(e,t){if(!r.read.cipherFunction(t,r.read)){e.error(e,{message:"Could not decrypt record or bad MAC.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_record_mac}})}else if(!r.read.compressFunction(e,t,r.read)){e.error(e,{message:"Could not decompress record.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decompression_failure}})}return!e.fail};r.write.update=function(e,t){if(!r.write.compressFunction(e,t,r.write)){e.error(e,{message:"Could not compress record.",send:false,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}else if(!r.write.cipherFunction(t,r.write)){e.error(e,{message:"Could not encrypt record.",send:false,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}return!e.fail};if(e.session){var a=e.session.sp;e.session.cipherSuite.initSecurityParameters(a);a.keys=i.generateKeys(e,a);r.read.macKey=t?a.keys.server_write_MAC_key:a.keys.client_write_MAC_key;r.write.macKey=t?a.keys.client_write_MAC_key:a.keys.server_write_MAC_key;e.session.cipherSuite.initConnectionState(r,e,a);switch(a.compression_algorithm){case i.CompressionMethod.none:break;case i.CompressionMethod.deflate:r.read.compressFunction=inflate;r.write.compressFunction=deflate;break;default:throw new Error("Unsupported compression algorithm.")}}return r};i.createRandom=function(){var e=new Date;var t=+e+e.getTimezoneOffset()*6e4;var r=a.util.createBuffer();r.putInt32(t);r.putBytes(a.random.getBytes(28));return r};i.createRecord=function(e,t){if(!t.data){return null}var r={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return r};i.createAlert=function(e,t){var r=a.util.createBuffer();r.putByte(t.level);r.putByte(t.description);return i.createRecord(e,{type:i.ContentType.alert,data:r})};i.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};var t=a.util.createBuffer();for(var r=0;r<e.cipherSuites.length;++r){var n=e.cipherSuites[r];t.putByte(n.id[0]);t.putByte(n.id[1])}var s=t.length();var o=a.util.createBuffer();o.putByte(i.CompressionMethod.none);var u=o.length();var l=a.util.createBuffer();if(e.virtualHost){var c=a.util.createBuffer();c.putByte(0);c.putByte(0);var p=a.util.createBuffer();p.putByte(0);writeVector(p,2,a.util.createBuffer(e.virtualHost));var h=a.util.createBuffer();writeVector(h,2,p);writeVector(c,2,h);l.putBuffer(c)}var d=l.length();if(d>0){d+=2}var g=e.session.id;var y=g.length+1+2+4+28+2+s+1+u+d;var v=a.util.createBuffer();v.putByte(i.HandshakeType.client_hello);v.putInt24(y);v.putByte(e.version.major);v.putByte(e.version.minor);v.putBytes(e.session.sp.client_random);writeVector(v,1,a.util.createBuffer(g));writeVector(v,2,t);writeVector(v,1,o);if(d>0){writeVector(v,2,l)}return v};i.createServerHello=function(e){var t=e.session.id;var r=t.length+1+2+4+28+2+1;var n=a.util.createBuffer();n.putByte(i.HandshakeType.server_hello);n.putInt24(r);n.putByte(e.version.major);n.putByte(e.version.minor);n.putBytes(e.session.sp.server_random);writeVector(n,1,a.util.createBuffer(t));n.putByte(e.session.cipherSuite.id[0]);n.putByte(e.session.cipherSuite.id[1]);n.putByte(e.session.compressionMethod);return n};i.createCertificate=function(e){var t=e.entity===i.ConnectionEnd.client;var r=null;if(e.getCertificate){var n;if(t){n=e.session.certificateRequest}else{n=e.session.extensions.server_name.serverNameList}r=e.getCertificate(e,n)}var s=a.util.createBuffer();if(r!==null){try{if(!a.util.isArray(r)){r=[r]}var o=null;for(var u=0;u<r.length;++u){var l=a.pem.decode(r[u])[0];if(l.type!=="CERTIFICATE"&&l.type!=="X509 CERTIFICATE"&&l.type!=="TRUSTED CERTIFICATE"){var c=new Error("Could not convert certificate from PEM; PEM "+'header type is not "CERTIFICATE", "X509 CERTIFICATE", or '+'"TRUSTED CERTIFICATE".');c.headerType=l.type;throw c}if(l.procType&&l.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.")}var p=a.util.createBuffer(l.body);if(o===null){o=a.asn1.fromDer(p.bytes(),false)}var h=a.util.createBuffer();writeVector(h,3,p);s.putBuffer(h)}r=a.pki.certificateFromAsn1(o);if(t){e.session.clientCertificate=r}else{e.session.serverCertificate=r}}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}}var d=3+s.length();var g=a.util.createBuffer();g.putByte(i.HandshakeType.certificate);g.putInt24(d);writeVector(g,3,s);return g};i.createClientKeyExchange=function(e){var t=a.util.createBuffer();t.putByte(e.session.clientHelloVersion.major);t.putByte(e.session.clientHelloVersion.minor);t.putBytes(a.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var n=e.session.serverCertificate.publicKey;t=n.encrypt(r.pre_master_secret);var s=t.length+2;var o=a.util.createBuffer();o.putByte(i.HandshakeType.client_key_exchange);o.putInt24(s);o.putInt16(t.length);o.putBytes(t);return o};i.createServerKeyExchange=function(e){var t=0;var r=a.util.createBuffer();if(t>0){r.putByte(i.HandshakeType.server_key_exchange);r.putInt24(t)}return r};i.getClientSignature=function(e,t){var r=a.util.createBuffer();r.putBuffer(e.session.md5.digest());r.putBuffer(e.session.sha1.digest());r=r.getBytes();e.getSignature=e.getSignature||function(e,t,r){var n=null;if(e.getPrivateKey){try{n=e.getPrivateKey(e,e.session.clientCertificate);n=a.pki.privateKeyFromPem(n)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}}if(n===null){e.error(e,{message:"No private key set.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}else{t=n.sign(t,null)}r(e,t)};e.getSignature(e,r,t)};i.createCertificateVerify=function(e,t){var r=t.length+2;var n=a.util.createBuffer();n.putByte(i.HandshakeType.certificate_verify);n.putInt24(r);n.putInt16(t.length);n.putBytes(t);return n};i.createCertificateRequest=function(e){var t=a.util.createBuffer();t.putByte(1);var r=a.util.createBuffer();for(var n in e.caStore.certs){var s=e.caStore.certs[n];var o=a.pki.distinguishedNameToAsn1(s.subject);var u=a.asn1.toDer(o);r.putInt16(u.length());r.putBuffer(u)}var l=1+t.length()+2+r.length();var c=a.util.createBuffer();c.putByte(i.HandshakeType.certificate_request);c.putInt24(l);writeVector(c,1,t);writeVector(c,2,r);return c};i.createServerHelloDone=function(e){var t=a.util.createBuffer();t.putByte(i.HandshakeType.server_hello_done);t.putInt24(0);return t};i.createChangeCipherSpec=function(){var e=a.util.createBuffer();e.putByte(1);return e};i.createFinished=function(e){var t=a.util.createBuffer();t.putBuffer(e.session.md5.digest());t.putBuffer(e.session.sha1.digest());var r=e.entity===i.ConnectionEnd.client;var n=e.session.sp;var s=12;var o=prf_TLS1;var u=r?"client finished":"server finished";t=o(n.master_secret,u,t.getBytes(),s);var l=a.util.createBuffer();l.putByte(i.HandshakeType.finished);l.putInt24(t.length());l.putBuffer(t);return l};i.createHeartbeat=function(e,t,r){if(typeof r==="undefined"){r=t.length}var i=a.util.createBuffer();i.putByte(e);i.putInt16(r);i.putBytes(t);var n=i.length();var s=Math.max(16,n-r-3);i.putBytes(a.random.getBytes(s));return i};i.queue=function(e,t){if(!t){return}if(t.fragment.length()===0){if(t.type===i.ContentType.handshake||t.type===i.ContentType.alert||t.type===i.ContentType.change_cipher_spec){return}}if(t.type===i.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r);e.session.sha1.update(r);r=null}var n;if(t.fragment.length()<=i.MaxFragment){n=[t]}else{n=[];var s=t.fragment.bytes();while(s.length>i.MaxFragment){n.push(i.createRecord(e,{type:t.type,data:a.util.createBuffer(s.slice(0,i.MaxFragment))}));s=s.slice(i.MaxFragment)}if(s.length>0){n.push(i.createRecord(e,{type:t.type,data:a.util.createBuffer(s)}))}}for(var o=0;o<n.length&&!e.fail;++o){var u=n[o];var l=e.state.current.write;if(l.update(e,u)){e.records.push(u)}}};i.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type);e.tlsData.putByte(r.version.major);e.tlsData.putByte(r.version.minor);e.tlsData.putInt16(r.fragment.length());e.tlsData.putBuffer(e.records[t].fragment)}e.records=[];return e.tlsDataReady(e)};var _certErrorToAlertDesc=function(e){switch(e){case true:return true;case a.pki.certificateError.bad_certificate:return i.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return i.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return i.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return i.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return i.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return i.Alert.Description.unknown_ca;default:return i.Alert.Description.bad_certificate}};var _alertDescToCertError=function(e){switch(e){case true:return true;case i.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case i.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case i.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case i.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case i.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case i.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};i.verifyCertificateChain=function(e,t){try{var r={};for(var n in e.verifyOptions){r[n]=e.verifyOptions[n]}r.verify=function(t,r,n){var s=_certErrorToAlertDesc(t);var o=e.verify(e,t,r,n);if(o!==true){if(typeof o==="object"&&!a.util.isArray(o)){var u=new Error("The application rejected the certificate.");u.send=true;u.alert={level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate};if(o.message){u.message=o.message}if(o.alert){u.alert.description=o.alert}throw u}if(o!==t){o=_alertDescToCertError(o)}}return o};a.pki.verifyCertificateChain(e.caStore,t,r)}catch(t){var s=t;if(typeof s!=="object"||a.util.isArray(s)){s={send:true,alert:{level:i.Alert.Level.fatal,description:_certErrorToAlertDesc(t)}}}if(!("send"in s)){s.send=true}if(!("alert"in s)){s.alert={level:i.Alert.Level.fatal,description:_certErrorToAlertDesc(s.error)}}e.error(e,s)}return!e.fail};i.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order){r=e}else{r={};r.cache=e||{};r.capacity=Math.max(t||100,1);r.order=[];for(var i in e){if(r.order.length<=t){r.order.push(i)}else{delete e[i]}}r.getSession=function(e){var t=null;var i=null;if(e){i=a.util.bytesToHex(e)}else if(r.order.length>0){i=r.order[0]}if(i!==null&&i in r.cache){t=r.cache[i];delete r.cache[i];for(var n in r.order){if(r.order[n]===i){r.order.splice(n,1);break}}}return t};r.setSession=function(e,t){if(r.order.length===r.capacity){var i=r.order.shift();delete r.cache[i]}var i=a.util.bytesToHex(e);r.order.push(i);r.cache[i]=t}}return r};i.createConnection=function(e){var t=null;if(e.caStore){if(a.util.isArray(e.caStore)){t=a.pki.createCaStore(e.caStore)}else{t=e.caStore}}else{t=a.pki.createCaStore()}var r=e.cipherSuites||null;if(r===null){r=[];for(var s in i.CipherSuites){r.push(i.CipherSuites[s])}}var o=e.server||false?i.ConnectionEnd.server:i.ConnectionEnd.client;var u=e.sessionCache?i.createSessionCache(e.sessionCache):null;var l={version:{major:i.Version.major,minor:i.Version.minor},entity:o,sessionId:e.sessionId,caStore:t,sessionCache:u,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||false,verify:e.verify||function(e,t,r,a){return t},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===i.ConnectionEnd.client?"client":"server");if(r.send){i.queue(t,i.createAlert(t,r.alert));i.flush(t)}var a=r.fatal!==false;if(a){t.fail=true}e.error(t,r);if(a){t.close(false)}},deflate:e.deflate||null,inflate:e.inflate||null};l.reset=function(e){l.version={major:i.Version.major,minor:i.Version.minor};l.record=null;l.session=null;l.peerCertificate=null;l.state={pending:null,current:null};l.expect=l.entity===i.ConnectionEnd.client?n:g;l.fragmented=null;l.records=[];l.open=false;l.handshakes=0;l.handshaking=false;l.isConnected=false;l.fail=!(e||typeof e==="undefined");l.input.clear();l.tlsData.clear();l.data.clear();l.state.current=i.createConnectionState(l)};l.reset();var _update=function(e,t){var r=t.type-i.ContentType.change_cipher_spec;var a=k[e.entity][e.expect];if(r in a){a[r](e,t)}else{i.handleUnexpected(e,t)}};var _readRecordHeader=function(e){var t=0;var r=e.input;var n=r.length();if(n<5){t=5-n}else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:a.util.createBuffer(),ready:false};var s=e.record.version.major===e.version.major;if(s&&e.session&&e.session.version){s=e.record.version.minor===e.version.minor}if(!s){e.error(e,{message:"Incompatible TLS version.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}})}}return t};var _readRecord=function(e){var t=0;var r=e.input;var a=r.length();if(a<e.record.length){t=e.record.length-a}else{e.record.fragment.putBytes(r.getBytes(e.record.length));r.compact();var n=e.state.current.read;if(n.update(e,e.record)){if(e.fragmented!==null){if(e.fragmented.type===e.record.type){e.fragmented.fragment.putBuffer(e.record.fragment);e.record=e.fragmented}else{e.error(e,{message:"Invalid fragmented record.",send:true,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})}}e.record.ready=true}}return t};l.handshake=function(e){if(l.entity!==i.ConnectionEnd.client){l.error(l,{message:"Cannot initiate handshake as a server.",fatal:false})}else if(l.handshaking){l.error(l,{message:"Handshake already in progress.",fatal:false})}else{if(l.fail&&!l.open&&l.handshakes===0){l.fail=false}l.handshaking=true;e=e||"";var t=null;if(e.length>0){if(l.sessionCache){t=l.sessionCache.getSession(e)}if(t===null){e=""}}if(e.length===0&&l.sessionCache){t=l.sessionCache.getSession();if(t!==null){e=t.id}}l.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()};if(t){l.version=t.version;l.session.sp=t.sp}l.session.sp.client_random=i.createRandom().getBytes();l.open=true;i.queue(l,i.createRecord(l,{type:i.ContentType.handshake,data:i.createClientHello(l)}));i.flush(l)}};l.process=function(e){var t=0;if(e){l.input.putBytes(e)}if(!l.fail){if(l.record!==null&&l.record.ready&&l.record.fragment.isEmpty()){l.record=null}if(l.record===null){t=_readRecordHeader(l)}if(!l.fail&&l.record!==null&&!l.record.ready){t=_readRecord(l)}if(!l.fail&&l.record!==null&&l.record.ready){_update(l,l.record)}}return t};l.prepare=function(e){i.queue(l,i.createRecord(l,{type:i.ContentType.application_data,data:a.util.createBuffer(e)}));return i.flush(l)};l.prepareHeartbeatRequest=function(e,t){if(e instanceof a.util.ByteBuffer){e=e.bytes()}if(typeof t==="undefined"){t=e.length}l.expectedHeartbeatPayload=e;i.queue(l,i.createRecord(l,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_request,e,t)}));return i.flush(l)};l.close=function(e){if(!l.fail&&l.sessionCache&&l.session){var t={id:l.session.id,version:l.session.version,sp:l.session.sp};t.sp.keys=null;l.sessionCache.setSession(t.id,t)}if(l.open){l.open=false;l.input.clear();if(l.isConnected||l.handshaking){l.isConnected=l.handshaking=false;i.queue(l,i.createAlert(l,{level:i.Alert.Level.warning,description:i.Alert.Description.close_notify}));i.flush(l)}l.closed(l)}l.reset(e)};return l};e.exports=a.tls=a.tls||{};for(var G in i){if(typeof i[G]!=="function"){a.tls[G]=i[G]}}a.tls.prf_tls1=prf_TLS1;a.tls.hmac_sha1=hmac_sha1;a.tls.createSessionCache=i.createSessionCache;a.tls.createConnection=i.createConnection},362:function(e,t,r){var a=r(809);var i=r(592);var n=e.exports=a.util=a.util||{};(function(){if(typeof process!=="undefined"&&process.nextTick&&!process.browser){n.nextTick=process.nextTick;if(typeof setImmediate==="function"){n.setImmediate=setImmediate}else{n.setImmediate=n.nextTick}return}if(typeof setImmediate==="function"){n.setImmediate=function(){return setImmediate.apply(undefined,arguments)};n.nextTick=function(e){return setImmediate(e)};return}n.setImmediate=function(e){setTimeout(e,0)};if(typeof window!=="undefined"&&typeof window.postMessage==="function"){var e="forge.setImmediate";var t=[];n.setImmediate=function(r){t.push(r);if(t.length===1){window.postMessage(e,"*")}};function handler(r){if(r.source===window&&r.data===e){r.stopPropagation();var a=t.slice();t.length=0;a.forEach((function(e){e()}))}}window.addEventListener("message",handler,true)}if(typeof MutationObserver!=="undefined"){var r=Date.now();var a=true;var i=document.createElement("div");var t=[];new MutationObserver((function(){var e=t.slice();t.length=0;e.forEach((function(e){e()}))})).observe(i,{attributes:true});var s=n.setImmediate;n.setImmediate=function(e){if(Date.now()-r>15){r=Date.now();s(e)}else{t.push(e);if(t.length===1){i.setAttribute("a",a=!a)}}}}n.nextTick=n.setImmediate})();n.isNodejs=typeof process!=="undefined"&&process.versions&&process.versions.node;n.globalScope=function(){if(n.isNodejs){return global}return typeof self==="undefined"?window:self}();n.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};n.isArrayBuffer=function(e){return typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer};n.isArrayBufferView=function(e){return e&&n.isArrayBuffer(e.buffer)&&e.byteLength!==undefined};function _checkBitsParam(e){if(!(e===8||e===16||e===24||e===32)){throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}}n.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(e){this.data="";this.read=0;if(typeof e==="string"){this.data=e}else if(n.isArrayBuffer(e)||n.isArrayBufferView(e)){if(typeof Buffer!=="undefined"&&e instanceof Buffer){this.data=e.toString("binary")}else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r){this.putByte(t[r])}}}}else if(e instanceof ByteStringBuffer||typeof e==="object"&&typeof e.data==="string"&&typeof e.read==="number"){this.data=e.data;this.read=e.read}this._constructedStringLength=0}n.ByteStringBuffer=ByteStringBuffer;var s=4096;n.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e;if(this._constructedStringLength>s){this.data.substr(0,1);this._constructedStringLength=0}};n.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};n.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};n.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};n.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);var r=this.data;while(t>0){if(t&1){r+=e}t>>>=1;if(t>0){e+=e}}this.data=r;this._optimizeConstructedString(t);return this};n.ByteStringBuffer.prototype.putBytes=function(e){this.data+=e;this._optimizeConstructedString(e.length);return this};n.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(n.encodeUtf8(e))};n.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};n.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};n.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};n.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};n.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};n.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};n.ByteStringBuffer.prototype.putInt=function(e,t){_checkBitsParam(t);var r="";do{t-=8;r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)};n.ByteStringBuffer.prototype.putSignedInt=function(e,t){if(e<0){e+=2<<t-1}return this.putInt(e,t)};n.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};n.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};n.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);this.read+=2;return e};n.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);this.read+=3;return e};n.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);this.read+=4;return e};n.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;this.read+=2;return e};n.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;this.read+=3;return e};n.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;this.read+=4;return e};n.ByteStringBuffer.prototype.getInt=function(e){_checkBitsParam(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++);e-=8}while(e>0);return t};n.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e);var r=2<<e-2;if(t>=r){t-=r<<1}return t};n.ByteStringBuffer.prototype.getBytes=function(e){var t;if(e){e=Math.min(this.length(),e);t=this.data.slice(this.read,this.read+e);this.read+=e}else if(e===0){t=""}else{t=this.read===0?this.data:this.data.slice(this.read);this.clear()}return t};n.ByteStringBuffer.prototype.bytes=function(e){return typeof e==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};n.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};n.ByteStringBuffer.prototype.setAt=function(e,t){this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1);return this};n.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};n.ByteStringBuffer.prototype.copy=function(){var e=n.createBuffer(this.data);e.read=this.read;return e};n.ByteStringBuffer.prototype.compact=function(){if(this.read>0){this.data=this.data.slice(this.read);this.read=0}return this};n.ByteStringBuffer.prototype.clear=function(){this.data="";this.read=0;return this};n.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);this.data=this.data.substr(this.read,t);this.read=0;return this};n.ByteStringBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);if(r<16){e+="0"}e+=r.toString(16)}return e};n.ByteStringBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())};function DataBuffer(e,t){t=t||{};this.read=t.readOffset||0;this.growSize=t.growSize||1024;var r=n.isArrayBuffer(e);var a=n.isArrayBufferView(e);if(r||a){if(r){this.data=new DataView(e)}else{this.data=new DataView(e.buffer,e.byteOffset,e.byteLength)}this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0));this.write=0;if(e!==null&&e!==undefined){this.putBytes(e)}if("writeOffset"in t){this.write=t.writeOffset}}n.DataBuffer=DataBuffer;n.DataBuffer.prototype.length=function(){return this.write-this.read};n.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};n.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e){return this}t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);var a=new Uint8Array(this.length()+t);a.set(r);this.data=new DataView(a.buffer);return this};n.DataBuffer.prototype.putByte=function(e){this.accommodate(1);this.data.setUint8(this.write++,e);return this};n.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r){this.data.setUint8(e)}return this};n.DataBuffer.prototype.putBytes=function(e,t){if(n.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);var a=r.byteLength-r.byteOffset;this.accommodate(a);var i=new Uint8Array(this.data.buffer,this.write);i.set(r);this.write+=a;return this}if(n.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);i.set(r,this.write);this.write+=r.byteLength;return this}if(e instanceof n.DataBuffer||typeof e==="object"&&typeof e.read==="number"&&typeof e.write==="number"&&n.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);i.set(r);this.write+=r.byteLength;return this}if(e instanceof n.ByteStringBuffer){e=e.data;t="binary"}t=t||"binary";if(typeof e==="string"){var s;if(t==="hex"){this.accommodate(Math.ceil(e.length/2));s=new Uint8Array(this.data.buffer,this.write);this.write+=n.binary.hex.decode(e,s,this.write);return this}if(t==="base64"){this.accommodate(Math.ceil(e.length/4)*3);s=new Uint8Array(this.data.buffer,this.write);this.write+=n.binary.base64.decode(e,s,this.write);return this}if(t==="utf8"){e=n.encodeUtf8(e);t="binary"}if(t==="binary"||t==="raw"){this.accommodate(e.length);s=new Uint8Array(this.data.buffer,this.write);this.write+=n.binary.raw.decode(s);return this}if(t==="utf16"){this.accommodate(e.length*2);s=new Uint16Array(this.data.buffer,this.write);this.write+=n.text.utf16.encode(s);return this}throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};n.DataBuffer.prototype.putBuffer=function(e){this.putBytes(e);e.clear();return this};n.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};n.DataBuffer.prototype.putInt16=function(e){this.accommodate(2);this.data.setInt16(this.write,e);this.write+=2;return this};n.DataBuffer.prototype.putInt24=function(e){this.accommodate(3);this.data.setInt16(this.write,e>>8&65535);this.data.setInt8(this.write,e>>16&255);this.write+=3;return this};n.DataBuffer.prototype.putInt32=function(e){this.accommodate(4);this.data.setInt32(this.write,e);this.write+=4;return this};n.DataBuffer.prototype.putInt16Le=function(e){this.accommodate(2);this.data.setInt16(this.write,e,true);this.write+=2;return this};n.DataBuffer.prototype.putInt24Le=function(e){this.accommodate(3);this.data.setInt8(this.write,e>>16&255);this.data.setInt16(this.write,e>>8&65535,true);this.write+=3;return this};n.DataBuffer.prototype.putInt32Le=function(e){this.accommodate(4);this.data.setInt32(this.write,e,true);this.write+=4;return this};n.DataBuffer.prototype.putInt=function(e,t){_checkBitsParam(t);this.accommodate(t/8);do{t-=8;this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this};n.DataBuffer.prototype.putSignedInt=function(e,t){_checkBitsParam(t);this.accommodate(t/8);if(e<0){e+=2<<t-1}return this.putInt(e,t)};n.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};n.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);this.read+=2;return e};n.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);this.read+=3;return e};n.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);this.read+=4;return e};n.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,true);this.read+=2;return e};n.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,true)<<8;this.read+=3;return e};n.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,true);this.read+=4;return e};n.DataBuffer.prototype.getInt=function(e){_checkBitsParam(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++);e-=8}while(e>0);return t};n.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e);var r=2<<e-2;if(t>=r){t-=r<<1}return t};n.DataBuffer.prototype.getBytes=function(e){var t;if(e){e=Math.min(this.length(),e);t=this.data.slice(this.read,this.read+e);this.read+=e}else if(e===0){t=""}else{t=this.read===0?this.data:this.data.slice(this.read);this.clear()}return t};n.DataBuffer.prototype.bytes=function(e){return typeof e==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};n.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};n.DataBuffer.prototype.setAt=function(e,t){this.data.setUint8(e,t);return this};n.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};n.DataBuffer.prototype.copy=function(){return new n.DataBuffer(this)};n.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read);var t=new Uint8Array(e.byteLength);t.set(e);this.data=new DataView(t);this.write-=this.read;this.read=0}return this};n.DataBuffer.prototype.clear=function(){this.data=new DataView(new ArrayBuffer(0));this.read=this.write=0;return this};n.DataBuffer.prototype.truncate=function(e){this.write=Math.max(0,this.length()-e);this.read=Math.min(this.read,this.write);return this};n.DataBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);if(r<16){e+="0"}e+=r.toString(16)}return e};n.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());e=e||"utf8";if(e==="binary"||e==="raw"){return n.binary.raw.encode(t)}if(e==="hex"){return n.binary.hex.encode(t)}if(e==="base64"){return n.binary.base64.encode(t)}if(e==="utf8"){return n.text.utf8.decode(t)}if(e==="utf16"){return n.text.utf16.decode(t)}throw new Error("Invalid encoding: "+e)};n.createBuffer=function(e,t){t=t||"raw";if(e!==undefined&&t==="utf8"){e=n.encodeUtf8(e)}return new n.ByteBuffer(e)};n.fillString=function(e,t){var r="";while(t>0){if(t&1){r+=e}t>>>=1;if(t>0){e+=e}}return r};n.xorBytes=function(e,t,r){var a="";var i="";var n="";var s=0;var o=0;for(;r>0;--r,++s){i=e.charCodeAt(s)^t.charCodeAt(s);if(o>=10){a+=n;n="";o=0}n+=String.fromCharCode(i);++o}a+=n;return a};n.hexToBytes=function(e){var t="";var r=0;if(e.length&1==1){r=1;t+=String.fromCharCode(parseInt(e[0],16))}for(;r<e.length;r+=2){t+=String.fromCharCode(parseInt(e.substr(r,2),16))}return t};n.bytesToHex=function(e){return n.createBuffer(e).toHex()};n.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];var l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";n.encode64=function(e,t){var r="";var a="";var i,n,s;var u=0;while(u<e.length){i=e.charCodeAt(u++);n=e.charCodeAt(u++);s=e.charCodeAt(u++);r+=o.charAt(i>>2);r+=o.charAt((i&3)<<4|n>>4);if(isNaN(n)){r+="=="}else{r+=o.charAt((n&15)<<2|s>>6);r+=isNaN(s)?"=":o.charAt(s&63)}if(t&&r.length>t){a+=r.substr(0,t)+"\r\n";r=r.substr(t)}}a+=r;return a};n.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var t="";var r,a,i,n;var s=0;while(s<e.length){r=u[e.charCodeAt(s++)-43];a=u[e.charCodeAt(s++)-43];i=u[e.charCodeAt(s++)-43];n=u[e.charCodeAt(s++)-43];t+=String.fromCharCode(r<<2|a>>4);if(i!==64){t+=String.fromCharCode((a&15)<<4|i>>2);if(n!==64){t+=String.fromCharCode((i&3)<<6|n)}}}return t};n.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};n.decodeUtf8=function(e){return decodeURIComponent(escape(e))};n.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:i.encode,decode:i.decode}};n.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};n.binary.raw.decode=function(e,t,r){var a=t;if(!a){a=new Uint8Array(e.length)}r=r||0;var i=r;for(var n=0;n<e.length;++n){a[i++]=e.charCodeAt(n)}return t?i-r:a};n.binary.hex.encode=n.bytesToHex;n.binary.hex.decode=function(e,t,r){var a=t;if(!a){a=new Uint8Array(Math.ceil(e.length/2))}r=r||0;var i=0,n=r;if(e.length&1){i=1;a[n++]=parseInt(e[0],16)}for(;i<e.length;i+=2){a[n++]=parseInt(e.substr(i,2),16)}return t?n-r:a};n.binary.base64.encode=function(e,t){var r="";var a="";var i,n,s;var u=0;while(u<e.byteLength){i=e[u++];n=e[u++];s=e[u++];r+=o.charAt(i>>2);r+=o.charAt((i&3)<<4|n>>4);if(isNaN(n)){r+="=="}else{r+=o.charAt((n&15)<<2|s>>6);r+=isNaN(s)?"=":o.charAt(s&63)}if(t&&r.length>t){a+=r.substr(0,t)+"\r\n";r=r.substr(t)}}a+=r;return a};n.binary.base64.decode=function(e,t,r){var a=t;if(!a){a=new Uint8Array(Math.ceil(e.length/4)*3)}e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r=r||0;var i,n,s,o;var l=0,c=r;while(l<e.length){i=u[e.charCodeAt(l++)-43];n=u[e.charCodeAt(l++)-43];s=u[e.charCodeAt(l++)-43];o=u[e.charCodeAt(l++)-43];a[c++]=i<<2|n>>4;if(s!==64){a[c++]=(n&15)<<4|s>>2;if(o!==64){a[c++]=(s&3)<<6|o}}}return t?c-r:a.subarray(0,c)};n.binary.base58.encode=function(e,t){return n.binary.baseN.encode(e,l,t)};n.binary.base58.decode=function(e,t){return n.binary.baseN.decode(e,l,t)};n.text={utf8:{},utf16:{}};n.text.utf8.encode=function(e,t,r){e=n.encodeUtf8(e);var a=t;if(!a){a=new Uint8Array(e.length)}r=r||0;var i=r;for(var s=0;s<e.length;++s){a[i++]=e.charCodeAt(s)}return t?i-r:a};n.text.utf8.decode=function(e){return n.decodeUtf8(String.fromCharCode.apply(null,e))};n.text.utf16.encode=function(e,t,r){var a=t;if(!a){a=new Uint8Array(e.length*2)}var i=new Uint16Array(a.buffer);r=r||0;var n=r;var s=r;for(var o=0;o<e.length;++o){i[s++]=e.charCodeAt(o);n+=2}return t?n-r:a};n.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};n.deflate=function(e,t,r){t=n.decode64(e.deflate(n.encode64(t)).rval);if(r){var a=2;var i=t.charCodeAt(1);if(i&32){a=6}t=t.substring(a,t.length-4)}return t};n.inflate=function(e,t,r){var a=e.inflate(n.encode64(t)).rval;return a===null?null:n.decode64(a)};var _setStorageObject=function(e,t,r){if(!e){throw new Error("WebStorage not available.")}var a;if(r===null){a=e.removeItem(t)}else{r=n.encode64(JSON.stringify(r));a=e.setItem(t,r)}if(typeof a!=="undefined"&&a.rval!==true){var i=new Error(a.error.message);i.id=a.error.id;i.name=a.error.name;throw i}};var _getStorageObject=function(e,t){if(!e){throw new Error("WebStorage not available.")}var r=e.getItem(t);if(e.init){if(r.rval===null){if(r.error){var a=new Error(r.error.message);a.id=r.error.id;a.name=r.error.name;throw a}r=null}else{r=r.rval}}if(r!==null){r=JSON.parse(n.decode64(r))}return r};var _setItem=function(e,t,r,a){var i=_getStorageObject(e,t);if(i===null){i={}}i[r]=a;_setStorageObject(e,t,i)};var _getItem=function(e,t,r){var a=_getStorageObject(e,t);if(a!==null){a=r in a?a[r]:null}return a};var _removeItem=function(e,t,r){var a=_getStorageObject(e,t);if(a!==null&&r in a){delete a[r];var i=true;for(var n in a){i=false;break}if(i){a=null}_setStorageObject(e,t,a)}};var _clearItems=function(e,t){_setStorageObject(e,t,null)};var _callStorageFunction=function(e,t,r){var a=null;if(typeof r==="undefined"){r=["web","flash"]}var i;var n=false;var s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null){throw new Error("Flash local storage not available.")}a=e.apply(this,t);n=i==="flash"}if(i==="web"||i==="both"){t[0]=localStorage;a=e.apply(this,t);n=true}}catch(e){s=e}if(n){break}}if(!n){throw s}return a};n.setItem=function(e,t,r,a,i){_callStorageFunction(_setItem,arguments,i)};n.getItem=function(e,t,r,a){return _callStorageFunction(_getItem,arguments,a)};n.removeItem=function(e,t,r,a){_callStorageFunction(_removeItem,arguments,a)};n.clearItems=function(e,t,r){_callStorageFunction(_clearItems,arguments,r)};n.isEmpty=function(e){for(var t in e){if(e.hasOwnProperty(t)){return false}}return true};n.format=function(e){var t=/%./g;var r;var a;var i=0;var n=[];var s=0;while(r=t.exec(e)){a=e.substring(s,t.lastIndex-2);if(a.length>0){n.push(a)}s=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":if(i<arguments.length){n.push(arguments[i+++1])}else{n.push("<?>")}break;case"%":n.push("%");break;default:n.push("<%"+o+"?>")}}n.push(e.substring(s));return n.join("")};n.formatNumber=function(e,t,r,a){var i=e,n=isNaN(t=Math.abs(t))?2:t;var s=r===undefined?",":r;var o=a===undefined?".":a,u=i<0?"-":"";var l=parseInt(i=Math.abs(+i||0).toFixed(n),10)+"";var c=l.length>3?l.length%3:0;return u+(c?l.substr(0,c)+o:"")+l.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(n?s+Math.abs(i-l).toFixed(n).slice(2):"")};n.formatSize=function(e){if(e>=1073741824){e=n.formatNumber(e/1073741824,2,".","")+" GiB"}else if(e>=1048576){e=n.formatNumber(e/1048576,2,".","")+" MiB"}else if(e>=1024){e=n.formatNumber(e/1024,0)+" KiB"}else{e=n.formatNumber(e,0)+" bytes"}return e};n.bytesFromIP=function(e){if(e.indexOf(".")!==-1){return n.bytesFromIPv4(e)}if(e.indexOf(":")!==-1){return n.bytesFromIPv6(e)}return null};n.bytesFromIPv4=function(e){e=e.split(".");if(e.length!==4){return null}var t=n.createBuffer();for(var r=0;r<e.length;++r){var a=parseInt(e[r],10);if(isNaN(a)){return null}t.putByte(a)}return t.getBytes()};n.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter((function(e){if(e.length===0)++t;return true}));var r=(8-e.length+t)*2;var a=n.createBuffer();for(var i=0;i<8;++i){if(!e[i]||e[i].length===0){a.fillWithByte(0,r);r=0;continue}var s=n.hexToBytes(e[i]);if(s.length<2){a.putByte(0)}a.putBytes(s)}return a.getBytes()};n.bytesToIP=function(e){if(e.length===4){return n.bytesToIPv4(e)}if(e.length===16){return n.bytesToIPv6(e)}return null};n.bytesToIPv4=function(e){if(e.length!==4){return null}var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r))}return t.join(".")};n.bytesToIPv6=function(e){if(e.length!==16){return null}var t=[];var r=[];var a=0;for(var i=0;i<e.length;i+=2){var s=n.bytesToHex(e[i]+e[i+1]);while(s[0]==="0"&&s!=="0"){s=s.substr(1)}if(s==="0"){var o=r[r.length-1];var u=t.length;if(!o||u!==o.end+1){r.push({start:u,end:u})}else{o.end=u;if(o.end-o.start>r[a].end-r[a].start){a=r.length-1}}}t.push(s)}if(r.length>0){var l=r[a];if(l.end-l.start>0){t.splice(l.start,l.end-l.start+1,"");if(l.start===0){t.unshift("")}if(l.end===7){t.push("")}}}return t.join(":")};n.estimateCores=function(e,t){if(typeof e==="function"){t=e;e={}}e=e||{};if("cores"in n&&!e.update){return t(null,n.cores)}if(typeof navigator!=="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0){n.cores=navigator.hardwareConcurrency;return t(null,n.cores)}if(typeof Worker==="undefined"){n.cores=1;return t(null,n.cores)}if(typeof Blob==="undefined"){n.cores=2;return t(null,n.cores)}var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){var t=Date.now();var r=t+4;while(Date.now()<r);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));sample([],5,16);function sample(e,a,i){if(a===0){var s=Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length);n.cores=Math.max(1,s);URL.revokeObjectURL(r);return t(null,n.cores)}map(i,(function(t,r){e.push(reduce(i,r));sample(e,a-1,i)}))}function map(e,t){var a=[];var i=[];for(var n=0;n<e;++n){var s=new Worker(r);s.addEventListener("message",(function(r){i.push(r.data);if(i.length===e){for(var n=0;n<e;++n){a[n].terminate()}t(null,i)}}));a.push(s)}for(var n=0;n<e;++n){a[n].postMessage(n)}}function reduce(e,t){var r=[];for(var a=0;a<e;++a){var i=t[a];var n=r[a]=[];for(var s=0;s<e;++s){if(a===s){continue}var o=t[s];if(i.st>o.st&&i.st<o.et||o.st>i.st&&o.st<i.et){n.push(s)}}}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}}},715:function(e,t,r){var a=r(809);r(801);r(446);r(599);r(5);r(964);r(957);r(227);r(533);r(28);r(362);var i=a.asn1;var n=e.exports=a.pki=a.pki||{};var s=n.oids;var o={};o["CN"]=s["commonName"];o["commonName"]="CN";o["C"]=s["countryName"];o["countryName"]="C";o["L"]=s["localityName"];o["localityName"]="L";o["ST"]=s["stateOrProvinceName"];o["stateOrProvinceName"]="ST";o["O"]=s["organizationName"];o["organizationName"]="O";o["OU"]=s["organizationalUnitName"];o["organizationalUnitName"]="OU";o["E"]=s["emailAddress"];o["emailAddress"]="E";var u=a.pki.rsa.publicKeyValidator;var l={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:true,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:false,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:false,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:true,captureAsn1:"certExtensions",optional:true}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:true,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:false,captureBitStringValue:"certSignature"}]};var c={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:true,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:false,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:true,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:false,capture:"trailer"}]}]};var p={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:false,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:true}]}]}]};var h={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,captureAsn1:"csr",value:[p,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:false,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:true,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:false,captureBitStringValue:"csrSignature"}]};n.RDNAttributesAsArray=function(e,t){var r=[];var a,n,u;for(var l=0;l<e.value.length;++l){a=e.value[l];for(var c=0;c<a.value.length;++c){u={};n=a.value[c];u.type=i.derToOid(n.value[0].value);u.value=n.value[1].value;u.valueTagClass=n.value[1].type;if(u.type in s){u.name=s[u.type];if(u.name in o){u.shortName=o[u.name]}}if(t){t.update(u.type);t.update(u.value)}r.push(u)}}return r};n.CRIAttributesAsArray=function(e){var t=[];for(var r=0;r<e.length;++r){var a=e[r];var u=i.derToOid(a.value[0].value);var l=a.value[1].value;for(var c=0;c<l.length;++c){var p={};p.type=u;p.value=l[c].value;p.valueTagClass=l[c].type;if(p.type in s){p.name=s[p.type];if(p.name in o){p.shortName=o[p.name]}}if(p.type===s.extensionRequest){p.extensions=[];for(var h=0;h<p.value.length;++h){p.extensions.push(n.certificateExtensionFromAsn1(p.value[h]))}}t.push(p)}}return t};function _getAttribute(e,t){if(typeof t==="string"){t={shortName:t}}var r=null;var a;for(var i=0;r===null&&i<e.attributes.length;++i){a=e.attributes[i];if(t.type&&t.type===a.type){r=a}else if(t.name&&t.name===a.name){r=a}else if(t.shortName&&t.shortName===a.shortName){r=a}}return r}var _readSignatureParameters=function(e,t,r){var a={};if(e!==s["RSASSA-PSS"]){return a}if(r){a={hash:{algorithmOid:s["sha1"]},mgf:{algorithmOid:s["mgf1"],hash:{algorithmOid:s["sha1"]}},saltLength:20}}var n={};var o=[];if(!i.validate(t,c,n,o)){var u=new Error("Cannot read RSASSA-PSS parameter block.");u.errors=o;throw u}if(n.hashOid!==undefined){a.hash=a.hash||{};a.hash.algorithmOid=i.derToOid(n.hashOid)}if(n.maskGenOid!==undefined){a.mgf=a.mgf||{};a.mgf.algorithmOid=i.derToOid(n.maskGenOid);a.mgf.hash=a.mgf.hash||{};a.mgf.hash.algorithmOid=i.derToOid(n.maskGenHashOid)}if(n.saltLength!==undefined){a.saltLength=n.saltLength.charCodeAt(0)}return a};var _createSignatureDigest=function(e){switch(s[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return a.md.sha1.create();case"md5WithRSAEncryption":return a.md.md5.create();case"sha256WithRSAEncryption":return a.md.sha256.create();case"sha384WithRSAEncryption":return a.md.sha384.create();case"sha512WithRSAEncryption":return a.md.sha512.create();case"RSASSA-PSS":return a.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. "+"Unknown signature OID.");t.signatureOid=e.signatureOid;throw t}};var _verifySignature=function(e){var t=e.certificate;var r;switch(t.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var i,n;i=s[t.signatureParameters.mgf.hash.algorithmOid];if(i===undefined||a.md[i]===undefined){var o=new Error("Unsupported MGF hash function.");o.oid=t.signatureParameters.mgf.hash.algorithmOid;o.name=i;throw o}n=s[t.signatureParameters.mgf.algorithmOid];if(n===undefined||a.mgf[n]===undefined){var o=new Error("Unsupported MGF function.");o.oid=t.signatureParameters.mgf.algorithmOid;o.name=n;throw o}n=a.mgf[n].create(a.md[i].create());i=s[t.signatureParameters.hash.algorithmOid];if(i===undefined||a.md[i]===undefined){var o=new Error("Unsupported RSASSA-PSS hash function.");o.oid=t.signatureParameters.hash.algorithmOid;o.name=i;throw o}r=a.pss.create(a.md[i].create(),n,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,r)};n.certificateFromPem=function(e,t,r){var s=a.pem.decode(e)[0];if(s.type!=="CERTIFICATE"&&s.type!=="X509 CERTIFICATE"&&s.type!=="TRUSTED CERTIFICATE"){var o=new Error("Could not convert certificate from PEM; PEM header type "+'is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');o.headerType=s.type;throw o}if(s.procType&&s.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.")}var u=i.fromDer(s.body,r);return n.certificateFromAsn1(u,t)};n.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(n.certificateToAsn1(e)).getBytes()};return a.pem.encode(r,{maxline:t})};n.publicKeyFromPem=function(e){var t=a.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var r=new Error("Could not convert public key from PEM; PEM header "+'type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert public key from PEM; PEM is encrypted.")}var s=i.fromDer(t.body);return n.publicKeyFromAsn1(s)};n.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(n.publicKeyToAsn1(e)).getBytes()};return a.pem.encode(r,{maxline:t})};n.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(n.publicKeyToRSAPublicKey(e)).getBytes()};return a.pem.encode(r,{maxline:t})};n.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||a.md.sha1.create();var s=t.type||"RSAPublicKey";var o;switch(s){case"RSAPublicKey":o=i.toDer(n.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":o=i.toDer(n.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}r.start();r.update(o);var u=r.digest();if(t.encoding==="hex"){var l=u.toHex();if(t.delimiter){return l.match(/.{2}/g).join(t.delimiter)}return l}else if(t.encoding==="binary"){return u.getBytes()}else if(t.encoding){throw new Error('Unknown encoding "'+t.encoding+'".')}return u};n.certificationRequestFromPem=function(e,t,r){var s=a.pem.decode(e)[0];if(s.type!=="CERTIFICATE REQUEST"){var o=new Error("Could not convert certification request from PEM; "+'PEM header type is not "CERTIFICATE REQUEST".');o.headerType=s.type;throw o}if(s.procType&&s.procType.type==="ENCRYPTED"){throw new Error("Could not convert certification request from PEM; "+"PEM is encrypted.")}var u=i.fromDer(s.body,r);return n.certificationRequestFromAsn1(u,t)};n.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(n.certificationRequestToAsn1(e)).getBytes()};return a.pem.encode(r,{maxline:t})};n.createCertificate=function(){var e={};e.version=2;e.serialNumber="00";e.signatureOid=null;e.signature=null;e.siginfo={};e.siginfo.algorithmOid=null;e.validity={};e.validity.notBefore=new Date;e.validity.notAfter=new Date;e.issuer={};e.issuer.getField=function(t){return _getAttribute(e.issuer,t)};e.issuer.addField=function(t){_fillMissingFields([t]);e.issuer.attributes.push(t)};e.issuer.attributes=[];e.issuer.hash=null;e.subject={};e.subject.getField=function(t){return _getAttribute(e.subject,t)};e.subject.addField=function(t){_fillMissingFields([t]);e.subject.attributes.push(t)};e.subject.attributes=[];e.subject.hash=null;e.extensions=[];e.publicKey=null;e.md=null;e.setSubject=function(t,r){_fillMissingFields(t);e.subject.attributes=t;delete e.subject.uniqueId;if(r){e.subject.uniqueId=r}e.subject.hash=null};e.setIssuer=function(t,r){_fillMissingFields(t);e.issuer.attributes=t;delete e.issuer.uniqueId;if(r){e.issuer.uniqueId=r}e.issuer.hash=null};e.setExtensions=function(t){for(var r=0;r<t.length;++r){_fillMissingExtensionFields(t[r],{cert:e})}e.extensions=t};e.getExtension=function(t){if(typeof t==="string"){t={name:t}}var r=null;var a;for(var i=0;r===null&&i<e.extensions.length;++i){a=e.extensions[i];if(t.id&&a.id===t.id){r=a}else if(t.name&&a.name===t.name){r=a}}return r};e.sign=function(t,r){e.md=r||a.md.sha1.create();var o=s[e.md.algorithm+"WithRSAEncryption"];if(!o){var u=new Error("Could not compute certificate digest. "+"Unknown message digest algorithm OID.");u.algorithm=e.md.algorithm;throw u}e.signatureOid=e.siginfo.algorithmOid=o;e.tbsCertificate=n.getTBSCertificate(e);var l=i.toDer(e.tbsCertificate);e.md.update(l.getBytes());e.signature=t.sign(e.md)};e.verify=function(t){var r=false;if(!e.issued(t)){var a=t.issuer;var s=e.subject;var o=new Error("The parent certificate did not issue the given child "+"certificate; the child certificate's issuer does not match the "+"parent's subject.");o.expectedIssuer=s.attributes;o.actualIssuer=a.attributes;throw o}var u=t.md;if(u===null){u=_createSignatureDigest({signatureOid:t.signatureOid,type:"certificate"});var l=t.tbsCertificate||n.getTBSCertificate(t);var c=i.toDer(l);u.update(c.getBytes())}if(u!==null){r=_verifySignature({certificate:e,md:u,signature:t.signature})}return r};e.isIssuer=function(t){var r=false;var a=e.issuer;var i=t.subject;if(a.hash&&i.hash){r=a.hash===i.hash}else if(a.attributes.length===i.attributes.length){r=true;var n,s;for(var o=0;r&&o<a.attributes.length;++o){n=a.attributes[o];s=i.attributes[o];if(n.type!==s.type||n.value!==s.value){r=false}}}return r};e.issued=function(t){return t.isIssuer(e)};e.generateSubjectKeyIdentifier=function(){return n.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})};e.verifySubjectKeyIdentifier=function(){var t=s["subjectKeyIdentifier"];for(var r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var n=e.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(i.subjectKeyIdentifier)===n}}return false};return e};n.certificateFromAsn1=function(e,t){var r={};var s=[];if(!i.validate(e,l,r,s)){var o=new Error("Cannot read X.509 certificate. "+"ASN.1 object is not an X509v3 Certificate.");o.errors=s;throw o}var u=i.derToOid(r.publicKeyOid);if(u!==n.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var c=n.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var p=a.util.createBuffer(r.certSerialNumber);c.serialNumber=p.toHex();c.signatureOid=a.asn1.derToOid(r.certSignatureOid);c.signatureParameters=_readSignatureParameters(c.signatureOid,r.certSignatureParams,true);c.siginfo.algorithmOid=a.asn1.derToOid(r.certinfoSignatureOid);c.siginfo.parameters=_readSignatureParameters(c.siginfo.algorithmOid,r.certinfoSignatureParams,false);c.signature=r.certSignature;var h=[];if(r.certValidity1UTCTime!==undefined){h.push(i.utcTimeToDate(r.certValidity1UTCTime))}if(r.certValidity2GeneralizedTime!==undefined){h.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime))}if(r.certValidity3UTCTime!==undefined){h.push(i.utcTimeToDate(r.certValidity3UTCTime))}if(r.certValidity4GeneralizedTime!==undefined){h.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime))}if(h.length>2){throw new Error("Cannot read notBefore/notAfter validity times; more "+"than two times were provided in the certificate.")}if(h.length<2){throw new Error("Cannot read notBefore/notAfter validity times; they "+"were not provided as either UTCTime or GeneralizedTime.")}c.validity.notBefore=h[0];c.validity.notAfter=h[1];c.tbsCertificate=r.tbsCertificate;if(t){c.md=_createSignatureDigest({signatureOid:c.signatureOid,type:"certificate"});var d=i.toDer(c.tbsCertificate);c.md.update(d.getBytes())}var g=a.md.sha1.create();var y=i.toDer(r.certIssuer);g.update(y.getBytes());c.issuer.getField=function(e){return _getAttribute(c.issuer,e)};c.issuer.addField=function(e){_fillMissingFields([e]);c.issuer.attributes.push(e)};c.issuer.attributes=n.RDNAttributesAsArray(r.certIssuer);if(r.certIssuerUniqueId){c.issuer.uniqueId=r.certIssuerUniqueId}c.issuer.hash=g.digest().toHex();var v=a.md.sha1.create();var m=i.toDer(r.certSubject);v.update(m.getBytes());c.subject.getField=function(e){return _getAttribute(c.subject,e)};c.subject.addField=function(e){_fillMissingFields([e]);c.subject.attributes.push(e)};c.subject.attributes=n.RDNAttributesAsArray(r.certSubject);if(r.certSubjectUniqueId){c.subject.uniqueId=r.certSubjectUniqueId}c.subject.hash=v.digest().toHex();if(r.certExtensions){c.extensions=n.certificateExtensionsFromAsn1(r.certExtensions)}else{c.extensions=[]}c.publicKey=n.publicKeyFromAsn1(r.subjectPublicKeyInfo);return c};n.certificateExtensionsFromAsn1=function(e){var t=[];for(var r=0;r<e.value.length;++r){var a=e.value[r];for(var i=0;i<a.value.length;++i){t.push(n.certificateExtensionFromAsn1(a.value[i]))}}return t};n.certificateExtensionFromAsn1=function(e){var t={};t.id=i.derToOid(e.value[0].value);t.critical=false;if(e.value[1].type===i.Type.BOOLEAN){t.critical=e.value[1].value.charCodeAt(0)!==0;t.value=e.value[2].value}else{t.value=e.value[1].value}if(t.id in s){t.name=s[t.id];if(t.name==="keyUsage"){var r=i.fromDer(t.value);var n=0;var o=0;if(r.value.length>1){n=r.value.charCodeAt(1);o=r.value.length>2?r.value.charCodeAt(2):0}t.digitalSignature=(n&128)===128;t.nonRepudiation=(n&64)===64;t.keyEncipherment=(n&32)===32;t.dataEncipherment=(n&16)===16;t.keyAgreement=(n&8)===8;t.keyCertSign=(n&4)===4;t.cRLSign=(n&2)===2;t.encipherOnly=(n&1)===1;t.decipherOnly=(o&128)===128}else if(t.name==="basicConstraints"){var r=i.fromDer(t.value);if(r.value.length>0&&r.value[0].type===i.Type.BOOLEAN){t.cA=r.value[0].value.charCodeAt(0)!==0}else{t.cA=false}var u=null;if(r.value.length>0&&r.value[0].type===i.Type.INTEGER){u=r.value[0].value}else if(r.value.length>1){u=r.value[1].value}if(u!==null){t.pathLenConstraint=i.derToInteger(u)}}else if(t.name==="extKeyUsage"){var r=i.fromDer(t.value);for(var l=0;l<r.value.length;++l){var c=i.derToOid(r.value[l].value);if(c in s){t[s[c]]=true}else{t[c]=true}}}else if(t.name==="nsCertType"){var r=i.fromDer(t.value);var n=0;if(r.value.length>1){n=r.value.charCodeAt(1)}t.client=(n&128)===128;t.server=(n&64)===64;t.email=(n&32)===32;t.objsign=(n&16)===16;t.reserved=(n&8)===8;t.sslCA=(n&4)===4;t.emailCA=(n&2)===2;t.objCA=(n&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];var p;var r=i.fromDer(t.value);for(var h=0;h<r.value.length;++h){p=r.value[h];var d={type:p.type,value:p.value};t.altNames.push(d);switch(p.type){case 1:case 2:case 6:break;case 7:d.ip=a.util.bytesToIP(p.value);break;case 8:d.oid=i.derToOid(p.value);break;default:}}}else if(t.name==="subjectKeyIdentifier"){var r=i.fromDer(t.value);t.subjectKeyIdentifier=a.util.bytesToHex(r.value)}}return t};n.certificationRequestFromAsn1=function(e,t){var r={};var s=[];if(!i.validate(e,h,r,s)){var o=new Error("Cannot read PKCS#10 certificate request. "+"ASN.1 object is not a PKCS#10 CertificationRequest.");o.errors=s;throw o}var u=i.derToOid(r.publicKeyOid);if(u!==n.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var l=n.createCertificationRequest();l.version=r.csrVersion?r.csrVersion.charCodeAt(0):0;l.signatureOid=a.asn1.derToOid(r.csrSignatureOid);l.signatureParameters=_readSignatureParameters(l.signatureOid,r.csrSignatureParams,true);l.siginfo.algorithmOid=a.asn1.derToOid(r.csrSignatureOid);l.siginfo.parameters=_readSignatureParameters(l.siginfo.algorithmOid,r.csrSignatureParams,false);l.signature=r.csrSignature;l.certificationRequestInfo=r.certificationRequestInfo;if(t){l.md=_createSignatureDigest({signatureOid:l.signatureOid,type:"certification request"});var c=i.toDer(l.certificationRequestInfo);l.md.update(c.getBytes())}var p=a.md.sha1.create();l.subject.getField=function(e){return _getAttribute(l.subject,e)};l.subject.addField=function(e){_fillMissingFields([e]);l.subject.attributes.push(e)};l.subject.attributes=n.RDNAttributesAsArray(r.certificationRequestInfoSubject,p);l.subject.hash=p.digest().toHex();l.publicKey=n.publicKeyFromAsn1(r.subjectPublicKeyInfo);l.getAttribute=function(e){return _getAttribute(l,e)};l.addAttribute=function(e){_fillMissingFields([e]);l.attributes.push(e)};l.attributes=n.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]);return l};n.createCertificationRequest=function(){var e={};e.version=0;e.signatureOid=null;e.signature=null;e.siginfo={};e.siginfo.algorithmOid=null;e.subject={};e.subject.getField=function(t){return _getAttribute(e.subject,t)};e.subject.addField=function(t){_fillMissingFields([t]);e.subject.attributes.push(t)};e.subject.attributes=[];e.subject.hash=null;e.publicKey=null;e.attributes=[];e.getAttribute=function(t){return _getAttribute(e,t)};e.addAttribute=function(t){_fillMissingFields([t]);e.attributes.push(t)};e.md=null;e.setSubject=function(t){_fillMissingFields(t);e.subject.attributes=t;e.subject.hash=null};e.setAttributes=function(t){_fillMissingFields(t);e.attributes=t};e.sign=function(t,r){e.md=r||a.md.sha1.create();var o=s[e.md.algorithm+"WithRSAEncryption"];if(!o){var u=new Error("Could not compute certification request digest. "+"Unknown message digest algorithm OID.");u.algorithm=e.md.algorithm;throw u}e.signatureOid=e.siginfo.algorithmOid=o;e.certificationRequestInfo=n.getCertificationRequestInfo(e);var l=i.toDer(e.certificationRequestInfo);e.md.update(l.getBytes());e.signature=t.sign(e.md)};e.verify=function(){var t=false;var r=e.md;if(r===null){r=_createSignatureDigest({signatureOid:e.signatureOid,type:"certification request"});var a=e.certificationRequestInfo||n.getCertificationRequestInfo(e);var s=i.toDer(a);r.update(s.getBytes())}if(r!==null){t=_verifySignature({certificate:e,md:r,signature:e.signature})}return t};return e};function _dnToAsn1(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var r,n;var s=e.attributes;for(var o=0;o<s.length;++o){r=s[o];var u=r.value;var l=i.Type.PRINTABLESTRING;if("valueTagClass"in r){l=r.valueTagClass;if(l===i.Type.UTF8){u=a.util.encodeUtf8(u)}}n=i.create(i.Class.UNIVERSAL,i.Type.SET,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(r.type).getBytes()),i.create(i.Class.UNIVERSAL,l,false,u)])]);t.value.push(n)}return t}function _getAttributesAsJson(e){var t={};for(var r=0;r<e.length;++r){var n=e[r];if(n.shortName&&(n.valueTagClass===i.Type.UTF8||n.valueTagClass===i.Type.PRINTABLESTRING||n.valueTagClass===i.Type.IA5STRING)){var s=n.value;if(n.valueTagClass===i.Type.UTF8){s=a.util.encodeUtf8(n.value)}if(!(n.shortName in t)){t[n.shortName]=s}else if(a.util.isArray(t[n.shortName])){t[n.shortName].push(s)}else{t[n.shortName]=[t[n.shortName],s]}}}return t}function _fillMissingFields(e){var t;for(var r=0;r<e.length;++r){t=e[r];if(typeof t.name==="undefined"){if(t.type&&t.type in n.oids){t.name=n.oids[t.type]}else if(t.shortName&&t.shortName in o){t.name=n.oids[o[t.shortName]]}}if(typeof t.type==="undefined"){if(t.name&&t.name in n.oids){t.type=n.oids[t.name]}else{var a=new Error("Attribute type not specified.");a.attribute=t;throw a}}if(typeof t.shortName==="undefined"){if(t.name&&t.name in o){t.shortName=o[t.name]}}if(t.type===s.extensionRequest){t.valueConstructed=true;t.valueTagClass=i.Type.SEQUENCE;if(!t.value&&t.extensions){t.value=[];for(var u=0;u<t.extensions.length;++u){t.value.push(n.certificateExtensionToAsn1(_fillMissingExtensionFields(t.extensions[u])))}}}if(typeof t.value==="undefined"){var a=new Error("Attribute value not specified.");a.attribute=t;throw a}}}function _fillMissingExtensionFields(e,t){t=t||{};if(typeof e.name==="undefined"){if(e.id&&e.id in n.oids){e.name=n.oids[e.id]}}if(typeof e.id==="undefined"){if(e.name&&e.name in n.oids){e.id=n.oids[e.name]}else{var r=new Error("Extension ID not specified.");r.extension=e;throw r}}if(typeof e.value!=="undefined"){return e}if(e.name==="keyUsage"){var o=0;var u=0;var l=0;if(e.digitalSignature){u|=128;o=7}if(e.nonRepudiation){u|=64;o=6}if(e.keyEncipherment){u|=32;o=5}if(e.dataEncipherment){u|=16;o=4}if(e.keyAgreement){u|=8;o=3}if(e.keyCertSign){u|=4;o=2}if(e.cRLSign){u|=2;o=1}if(e.encipherOnly){u|=1;o=0}if(e.decipherOnly){l|=128;o=7}var c=String.fromCharCode(o);if(l!==0){c+=String.fromCharCode(u)+String.fromCharCode(l)}else if(u!==0){c+=String.fromCharCode(u)}e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,c)}else if(e.name==="basicConstraints"){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);if(e.cA){e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,false,String.fromCharCode(255)))}if("pathLenConstraint"in e){e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.pathLenConstraint).getBytes()))}}else if(e.name==="extKeyUsage"){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var p=e.value.value;for(var h in e){if(e[h]!==true){continue}if(h in s){p.push(i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(s[h]).getBytes()))}else if(h.indexOf(".")!==-1){p.push(i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(h).getBytes()))}}}else if(e.name==="nsCertType"){var o=0;var u=0;if(e.client){u|=128;o=7}if(e.server){u|=64;o=6}if(e.email){u|=32;o=5}if(e.objsign){u|=16;o=4}if(e.reserved){u|=8;o=3}if(e.sslCA){u|=4;o=2}if(e.emailCA){u|=2;o=1}if(e.objCA){u|=1;o=0}var c=String.fromCharCode(o);if(u!==0){c+=String.fromCharCode(u)}e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,c)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var d;for(var g=0;g<e.altNames.length;++g){d=e.altNames[g];var c=d.value;if(d.type===7&&d.ip){c=a.util.bytesFromIP(d.ip);if(c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');r.extension=e;throw r}}else if(d.type===8){if(d.oid){c=i.oidToDer(i.oidToDer(d.oid))}else{c=i.oidToDer(c)}}e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,d.type,false,c))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128){throw new Error('Invalid "nsComment" content.')}e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,false,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var y=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=y.toHex();e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,y.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var p=e.value.value;if(e.keyIdentifier){var v=e.keyIdentifier===true?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;p.push(i.create(i.Class.CONTEXT_SPECIFIC,0,false,v))}if(e.authorityCertIssuer){var m=[i.create(i.Class.CONTEXT_SPECIFIC,4,true,[_dnToAsn1(e.authorityCertIssuer===true?t.cert.issuer:e.authorityCertIssuer)])];p.push(i.create(i.Class.CONTEXT_SPECIFIC,1,true,m))}if(e.serialNumber){var C=a.util.hexToBytes(e.serialNumber===true?t.cert.serialNumber:e.serialNumber);p.push(i.create(i.Class.CONTEXT_SPECIFIC,2,false,C))}}else if(e.name==="cRLDistributionPoints"){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var p=e.value.value;var E=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);var I=i.create(i.Class.CONTEXT_SPECIFIC,0,true,[]);var d;for(var g=0;g<e.altNames.length;++g){d=e.altNames[g];var c=d.value;if(d.type===7&&d.ip){c=a.util.bytesFromIP(d.ip);if(c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');r.extension=e;throw r}}else if(d.type===8){if(d.oid){c=i.oidToDer(i.oidToDer(d.oid))}else{c=i.oidToDer(c)}}I.value.push(i.create(i.Class.CONTEXT_SPECIFIC,d.type,false,c))}E.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,true,[I]));p.push(E)}if(typeof e.value==="undefined"){var r=new Error("Extension value not specified.");r.extension=e;throw r}return e}function _signatureParametersToAsn1(e,t){switch(e){case s["RSASSA-PSS"]:var r=[];if(t.hash.algorithmOid!==undefined){r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")])]))}if(t.mgf.algorithmOid!==undefined){r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,true,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")])])]))}if(t.saltLength!==undefined){r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(t.saltLength).getBytes())]))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,r);default:return i.create(i.Class.UNIVERSAL,i.Type.NULL,false,"")}}function _CRIAttributesToAsn1(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,true,[]);if(e.attributes.length===0){return t}var r=e.attributes;for(var n=0;n<r.length;++n){var s=r[n];var o=s.value;var u=i.Type.UTF8;if("valueTagClass"in s){u=s.valueTagClass}if(u===i.Type.UTF8){o=a.util.encodeUtf8(o)}var l=false;if("valueConstructed"in s){l=s.valueConstructed}var c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(s.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,true,[i.create(i.Class.UNIVERSAL,u,l,o)])]);t.value.push(c)}return t}var d=new Date("1950-01-01T00:00:00Z");var g=new Date("2050-01-01T00:00:00Z");function _dateToAsn1(e){if(e>=d&&e<g){return i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,false,i.dateToUtcTime(e))}else{return i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,false,i.dateToGeneralizedTime(e))}}n.getTBSCertificate=function(e){var t=_dateToAsn1(e.validity.notBefore);var r=_dateToAsn1(e.validity.notAfter);var s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.CONTEXT_SPECIFIC,0,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,a.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.siginfo.algorithmOid).getBytes()),_signatureParametersToAsn1(e.siginfo.algorithmOid,e.siginfo.parameters)]),_dnToAsn1(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[t,r]),_dnToAsn1(e.subject),n.publicKeyToAsn1(e.publicKey)]);if(e.issuer.uniqueId){s.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,true,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,String.fromCharCode(0)+e.issuer.uniqueId)]))}if(e.subject.uniqueId){s.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,true,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,String.fromCharCode(0)+e.subject.uniqueId)]))}if(e.extensions.length>0){s.value.push(n.certificateExtensionsToAsn1(e.extensions))}return s};n.getCertificationRequestInfo=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,false,i.integerToDer(e.version).getBytes()),_dnToAsn1(e.subject),n.publicKeyToAsn1(e.publicKey),_CRIAttributesToAsn1(e)]);return t};n.distinguishedNameToAsn1=function(e){return _dnToAsn1(e)};n.certificateToAsn1=function(e){var t=e.tbsCertificate||n.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.signatureOid).getBytes()),_signatureParametersToAsn1(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,String.fromCharCode(0)+e.signature)])};n.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,true,[]);var r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);t.value.push(r);for(var a=0;a<e.length;++a){r.value.push(n.certificateExtensionToAsn1(e[a]))}return t};n.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.id).getBytes()));if(e.critical){t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,false,String.fromCharCode(255)))}var r=e.value;if(typeof e.value!=="string"){r=i.toDer(r).getBytes()}t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,false,r));return t};n.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||n.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,true,[i.create(i.Class.UNIVERSAL,i.Type.OID,false,i.oidToDer(e.signatureOid).getBytes()),_signatureParametersToAsn1(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,false,String.fromCharCode(0)+e.signature)])};n.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(e){var t=getBySubject(e.issuer);return t};t.addCertificate=function(e){if(typeof e==="string"){e=a.pki.certificateFromPem(e)}ensureSubjectHasHash(e.subject);if(!t.hasCertificate(e)){if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];if(!a.util.isArray(r)){r=[r]}r.push(e);t.certs[e.subject.hash]=r}else{t.certs[e.subject.hash]=e}}};t.hasCertificate=function(e){if(typeof e==="string"){e=a.pki.certificateFromPem(e)}var t=getBySubject(e.subject);if(!t){return false}if(!a.util.isArray(t)){t=[t]}var r=i.toDer(n.certificateToAsn1(e)).getBytes();for(var s=0;s<t.length;++s){var o=i.toDer(n.certificateToAsn1(t[s])).getBytes();if(r===o){return true}}return false};t.listAllCertificates=function(){var e=[];for(var r in t.certs){if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(!a.util.isArray(i)){e.push(i)}else{for(var n=0;n<i.length;++n){e.push(i[n])}}}}return e};t.removeCertificate=function(e){var r;if(typeof e==="string"){e=a.pki.certificateFromPem(e)}ensureSubjectHasHash(e.subject);if(!t.hasCertificate(e)){return null}var s=getBySubject(e.subject);if(!a.util.isArray(s)){r=t.certs[e.subject.hash];delete t.certs[e.subject.hash];return r}var o=i.toDer(n.certificateToAsn1(e)).getBytes();for(var u=0;u<s.length;++u){var l=i.toDer(n.certificateToAsn1(s[u])).getBytes();if(o===l){r=s[u];s.splice(u,1)}}if(s.length===0){delete t.certs[e.subject.hash]}return r};function getBySubject(e){ensureSubjectHasHash(e);return t.certs[e.hash]||null}function ensureSubjectHasHash(e){if(!e.hash){var t=a.md.sha1.create();e.attributes=n.RDNAttributesAsArray(_dnToAsn1(e),t);e.hash=t.digest().toHex()}}if(e){for(var r=0;r<e.length;++r){var s=e[r];t.addCertificate(s)}}return t};n.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};n.verifyCertificateChain=function(e,t,r){if(typeof r==="function"){r={verify:r}}r=r||{};t=t.slice(0);var i=t.slice(0);var s=r.validityCheckDate;if(typeof s==="undefined"){s=new Date}var o=true;var u=null;var l=0;do{var c=t.shift();var p=null;var h=false;if(s){if(s<c.validity.notBefore||s>c.validity.notAfter){u={message:"Certificate is not valid yet or has expired.",error:n.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:s}}}if(u===null){p=t[0]||e.getIssuer(c);if(p===null){if(c.isIssuer(c)){h=true;p=c}}if(p){var d=p;if(!a.util.isArray(d)){d=[d]}var g=false;while(!g&&d.length>0){p=d.shift();try{g=p.verify(c)}catch(e){}}if(!g){u={message:"Certificate signature is invalid.",error:n.certificateError.bad_certificate}}}if(u===null&&(!p||h)&&!e.hasCertificate(c)){u={message:"Certificate is not trusted.",error:n.certificateError.unknown_ca}}}if(u===null&&p&&!c.isIssuer(p)){u={message:"Certificate issuer is invalid.",error:n.certificateError.bad_certificate}}if(u===null){var y={keyUsage:true,basicConstraints:true};for(var v=0;u===null&&v<c.extensions.length;++v){var m=c.extensions[v];if(m.critical&&!(m.name in y)){u={message:"Certificate has an unsupported critical extension.",error:n.certificateError.unsupported_certificate}}}}if(u===null&&(!o||t.length===0&&(!p||h))){var C=c.getExtension("basicConstraints");var E=c.getExtension("keyUsage");if(E!==null){if(!E.keyCertSign||C===null){u={message:"Certificate keyUsage or basicConstraints conflict "+"or indicate that the certificate is not a CA. "+"If the certificate is the only one in the chain or "+"isn't the first then the certificate must be a "+"valid CA.",error:n.certificateError.bad_certificate}}}if(u===null&&C!==null&&!C.cA){u={message:"Certificate basicConstraints indicates the certificate "+"is not a CA.",error:n.certificateError.bad_certificate}}if(u===null&&E!==null&&"pathLenConstraint"in C){var I=l-1;if(I>C.pathLenConstraint){u={message:"Certificate basicConstraints pathLenConstraint violated.",error:n.certificateError.bad_certificate}}}}var T=u===null?true:u.error;var b=r.verify?r.verify(T,l,i):T;if(b===true){u=null}else{if(T===true){u={message:"The application rejected the certificate.",error:n.certificateError.bad_certificate}}if(b||b===0){if(typeof b==="object"&&!a.util.isArray(b)){if(b.message){u.message=b.message}if(b.error){u.error=b.error}}else if(typeof b==="string"){u.error=b}}throw u}o=false;++l}while(t.length>0);return true}},113:function(e){"use strict";e.exports=require("crypto")}};var t={};function __nccwpck_require__(r){var a=t[r];if(a!==undefined){return a.exports}var i=t[r]={exports:{}};var n=true;try{e[r](i,i.exports,__nccwpck_require__);n=false}finally{if(n)delete t[r]}return i.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r={};!function(){var e=r;var t=__nccwpck_require__(386);function toPositiveHex(e){var t=parseInt(e[0],16);if(t<8){return e}t-=8;return t.toString()+e.substring(1)}function getAlgorithm(e){switch(e){case"sha256":return t.md.sha256.create();default:return t.md.sha1.create()}}e.generate=function generate(e,r,a){if(typeof e==="function"){a=e;e=undefined}else if(typeof r==="function"){a=r;r={}}r=r||{};var generatePem=function(a){var i=t.pki.createCertificate();i.serialNumber=toPositiveHex(t.util.bytesToHex(t.random.getBytesSync(9)));i.validity.notBefore=r.notBeforeDate||new Date;var n=new Date;i.validity.notAfter=n;i.validity.notAfter.setDate(n.getDate()+(r.days||365));e=e||[{name:"commonName",value:"example.org"},{name:"countryName",value:"US"},{shortName:"ST",value:"Virginia"},{name:"localityName",value:"Blacksburg"},{name:"organizationName",value:"Test"},{shortName:"OU",value:"Test"}];i.setSubject(e);i.setIssuer(e);i.publicKey=a.publicKey;i.setExtensions(r.extensions||[{name:"basicConstraints",cA:true},{name:"keyUsage",keyCertSign:true,digitalSignature:true,nonRepudiation:true,keyEncipherment:true,dataEncipherment:true},{name:"subjectAltName",altNames:[{type:6,value:"http://example.org/webid#me"}]}]);i.sign(a.privateKey,getAlgorithm(r&&r.algorithm));const s=t.md.sha1.create().update(t.asn1.toDer(t.pki.certificateToAsn1(i)).getBytes()).digest().toHex().match(/.{2}/g).join(":");var o={private:t.pki.privateKeyToPem(a.privateKey),public:t.pki.publicKeyToPem(a.publicKey),cert:t.pki.certificateToPem(i),fingerprint:s};if(r&&r.pkcs7){var u=t.pkcs7.createSignedData();u.addCertificate(i);o.pkcs7=t.pkcs7.messageToPem(u)}if(r&&r.clientCertificate){var l=t.pki.rsa.generateKeyPair(r.clientCertificateKeySize||1024);var c=t.pki.createCertificate();c.serialNumber=toPositiveHex(t.util.bytesToHex(t.random.getBytesSync(9)));c.validity.notBefore=new Date;c.validity.notAfter=new Date;c.validity.notAfter.setFullYear(c.validity.notBefore.getFullYear()+1);var p=JSON.parse(JSON.stringify(e));for(var h=0;h<p.length;h++){if(p[h].name==="commonName"){if(r.clientCertificateCN)p[h]={name:"commonName",value:r.clientCertificateCN};else p[h]={name:"commonName",value:"John Doe jdoe123"}}}c.setSubject(p);c.setIssuer(e);c.publicKey=l.publicKey;c.sign(a.privateKey);o.clientprivate=t.pki.privateKeyToPem(l.privateKey);o.clientpublic=t.pki.publicKeyToPem(l.publicKey);o.clientcert=t.pki.certificateToPem(c);if(r.pkcs7){var d=t.pkcs7.createSignedData();d.addCertificate(c);o.clientpkcs7=t.pkcs7.messageToPem(d)}}var g=t.pki.createCaStore();g.addCertificate(i);try{t.pki.verifyCertificateChain(g,[i],(function(e,t,r){if(e!==true){throw new Error("Certificate could not be verified.")}return true}))}catch(e){throw new Error(e)}return o};var i=r.keySize||1024;if(a){return t.pki.rsa.generateKeyPair({bits:i},(function(e,t){if(e){return a(e)}try{return a(null,generatePem(t))}catch(e){return a(e)}}))}var n=r.keyPair?{privateKey:t.pki.privateKeyFromPem(r.keyPair.privateKey),publicKey:t.pki.publicKeyFromPem(r.keyPair.publicKey)}:t.pki.rsa.generateKeyPair(i);return generatePem(n)}}();module.exports=r})();